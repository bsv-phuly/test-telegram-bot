(function(he){typeof define=="function"&&define.amd?define(he):he()})(function(){"use strict";var Dh=Object.defineProperty;var Ah=(he,Ce,xe)=>Ce in he?Dh(he,Ce,{enumerable:!0,configurable:!0,writable:!0,value:xe}):he[Ce]=xe;var I=(he,Ce,xe)=>Ah(he,typeof Ce!="symbol"?Ce+"":Ce,xe);const he=new Map;function Ce(s){const e=Array.isArray(s)?s:[s],t=e.join(","),r=he.get(t)??(()=>{const a=xe(e),c=ji(a);return he.set(t,c),c})();return a=>r(a)}function xe(s){return Array.isArray(s)?s.map(e=>e.split(":")):[s.split(":")]}function ji(s){const e=s.flatMap(a=>qi(a,cr(a))),t=Hi(e),r=zi(t);return a=>!!r(a.update,a)}function cr(s){const e=Lt,t=[s].flatMap(r=>{const[a,c,l]=r;if(!(a in yr))return[r];if(!a&&!c&&!l)return[r];const d=yr[a].map(g=>[g,c,l]);return c===void 0||c in an&&(c||l)?d:d.filter(([g])=>{var v;return!!((v=e[g])!=null&&v[c])})}).flatMap(r=>{const[a,c,l]=r;if(!(c in an))return[r];if(!c&&!l)return[r];const d=an[c].map(g=>[a,g,l]);return l===void 0?d:d.filter(([,g])=>{var v,C;return!!((C=(v=e[a])==null?void 0:v[g])!=null&&C[l])})});if(t.length===0)throw new Error(`Shortcuts in '${s.join(":")}' do not expand to any valid filter query`);return t}function qi(s,e){if(e.length===0)throw new Error("Empty filter query given");const t=e.map(Gi).filter(r=>r!==!0);if(t.length===0)return e;throw t.length===1?new Error(t[0]):new Error(`Invalid filter query '${s.join(":")}'. There are ${t.length} errors after expanding the contained shortcuts: ${t.join("; ")}`)}function Gi(s){const[e,t,r,...a]=s;if(e===void 0)return"Empty filter query given";if(!(e in Lt)){const p=Object.keys(Lt);return`Invalid L1 filter '${e}' given in '${s.join(":")}'. Permitted values are: ${p.map(d=>`'${d}'`).join(", ")}.`}if(t===void 0)return!0;const c=Lt[e];if(!(t in c)){const p=Object.keys(c);return`Invalid L2 filter '${t}' given in '${s.join(":")}'. Permitted values are: ${p.map(d=>`'${d}'`).join(", ")}.`}if(r===void 0)return!0;const l=c[t];if(!(r in l)){const p=Object.keys(l);return`Invalid L3 filter '${r}' given in '${s.join(":")}'. ${p.length===0?`No further filtering is possible after '${e}:${t}'.`:`Permitted values are: ${p.map(d=>`'${d}'`).join(", ")}.`}`}return a.length===0?!0:`Cannot filter further than three levels, ':${a.join(":")}' is invalid!`}function Hi(s){const e={};for(const[t,r,a]of s){const c=e[t]??(e[t]={});if(r!==void 0){const l=c[r]??(c[r]=new Set);a!==void 0&&l.add(a)}}return e}function nn(s,e){return(t,r)=>s(t,r)||e(t,r)}function lr(s,e){return(t,r)=>{const a=s(t,r);return a&&e(a,r)}}function hr(s){return(e,t)=>s(e,t)!=null}function zi(s){const e=Object.entries(s).map(([t,r])=>{const a=l=>l[t],c=Object.entries(r).map(([l,p])=>{const d=v=>v[l],g=Array.from(p).map(v=>v==="me"?(_,N)=>{const E=N.me.id;return dr(_,k=>k.id===E)}:_=>dr(_,N=>N[v]||N.type===v));return g.length===0?hr(d):lr(d,g.reduce(nn))});return c.length===0?hr(a):lr(a,c.reduce(nn))});if(e.length===0)throw new Error("Cannot create filter function for empty query");return e.reduce(nn)}function dr(s,e){const t=r=>r!=null&&e(r);return Array.isArray(s)?s.some(t):t(s)}const fr={mention:{},hashtag:{},cashtag:{},bot_command:{},url:{},email:{},phone_number:{},bold:{},italic:{},underline:{},strikethrough:{},spoiler:{},blockquote:{},expandable_blockquote:{},code:{},pre:{},text_link:{},text_mention:{},custom_emoji:{}},rn={me:{},is_bot:{},is_premium:{},added_to_attachment_menu:{}},Yi={user:{},hidden_user:{},chat:{},channel:{}},Zi={is_video:{},is_animated:{},premium_animation:{}},sn={emoji:{},custom_emoji:{},paid:{}},mr={forward_origin:Yi,is_topic_message:{},is_automatic_forward:{},business_connection_id:{},text:{},animation:{},audio:{},document:{},paid_media:{},photo:{},sticker:Zi,story:{},video:{},video_note:{},voice:{},contact:{},dice:{},game:{},poll:{},venue:{},location:{},entities:fr,caption_entities:fr,caption:{},effect_id:{},paid_star_count:{},has_media_spoiler:{},new_chat_title:{},new_chat_photo:{},delete_chat_photo:{},message_auto_delete_timer_changed:{},pinned_message:{},invoice:{},proximity_alert_triggered:{},chat_background_set:{},giveaway_created:{},giveaway:{only_new_members:{},has_public_winners:{}},giveaway_winners:{only_new_members:{},was_refunded:{}},giveaway_completed:{},gift:{},unique_gift:{},paid_message_price_changed:{},video_chat_scheduled:{},video_chat_started:{},video_chat_ended:{},video_chat_participants_invited:{},web_app_data:{}},xt={...mr,new_chat_members:rn,left_chat_member:rn,group_chat_created:{},supergroup_chat_created:{},migrate_to_chat_id:{},migrate_from_chat_id:{},successful_payment:{},refunded_payment:{},users_shared:{},chat_shared:{},connected_website:{},write_access_allowed:{},passport_data:{},boost_added:{},forum_topic_created:{},forum_topic_edited:{name:{},icon_custom_emoji_id:{}},forum_topic_closed:{},forum_topic_reopened:{},general_forum_topic_hidden:{},general_forum_topic_unhidden:{},sender_boost_count:{}},pr={...mr,channel_chat_created:{}},Ki={can_reply:{},is_enabled:{}},Qi={old_reaction:sn,new_reaction:sn},Ji={reactions:sn},Xi={data:{},game_short_name:{}},gr={from:rn},Lt={message:xt,edited_message:xt,channel_post:pr,edited_channel_post:pr,business_connection:Ki,business_message:xt,edited_business_message:xt,deleted_business_messages:{},inline_query:{},chosen_inline_result:{},callback_query:Xi,shipping_query:{},pre_checkout_query:{},poll:{},poll_answer:{},my_chat_member:gr,chat_member:gr,chat_join_request:{},message_reaction:Qi,message_reaction_count:Ji,chat_boost:{},removed_chat_boost:{},purchased_paid_media:{}},yr={"":["message","channel_post"],msg:["message","channel_post"],edit:["edited_message","edited_channel_post"]},an={"":["entities","caption_entities"],media:["photo","video"],file:["photo","animation","audio","document","video","video_note","voice","sticker"]},pe={filterQuery(s){const e=Ce(s);return t=>e(t)},text(s){const e=pe.filterQuery([":text",":caption"]),t=Le(s);return r=>{if(!e(r))return!1;const a=r.message??r.channelPost,c=a.text??a.caption;return Pe(r,c,t)}},command(s){const e=pe.filterQuery(":entities:bot_command"),t=new Set,r=new Set;return Pt(s).forEach(a=>{if(a.startsWith("/"))throw new Error(`Do not include '/' when registering command handlers (use '${a.substring(1)}' not '${a}')`);(a.includes("@")?t:r).add(a)}),a=>{if(!e(a))return!1;const c=a.message??a.channelPost,l=c.text??c.caption;return c.entities.some(p=>{if(p.type!=="bot_command"||p.offset!==0)return!1;const d=l.substring(1,p.length);if(r.has(d)||t.has(d))return a.match=l.substring(d.length+1).trimStart(),!0;const g=d.indexOf("@");if(g===-1)return!1;const v=d.substring(g+1).toLowerCase(),C=a.me.username.toLowerCase();if(v!==C)return!1;const _=d.substring(0,g);return r.has(_)?(a.match=l.substring(d.length+1).trimStart(),!0):!1})}},reaction(s){const e=pe.filterQuery("message_reaction"),t=typeof s=="string"?[{type:"emoji",emoji:s}]:(Array.isArray(s)?s:[s]).map(l=>typeof l=="string"?{type:"emoji",emoji:l}:l),r=new Set(t.filter(l=>l.type==="emoji").map(l=>l.emoji)),a=new Set(t.filter(l=>l.type==="custom_emoji").map(l=>l.custom_emoji_id)),c=t.some(l=>l.type==="paid");return l=>{if(!e(l))return!1;const{old_reaction:p,new_reaction:d}=l.messageReaction;for(const g of d){let v=!1;if(g.type==="emoji"){for(const C of p)if(C.type==="emoji"&&C.emoji===g.emoji){v=!0;break}}else if(g.type==="custom_emoji"){for(const C of p)if(C.type==="custom_emoji"&&C.custom_emoji_id===g.custom_emoji_id){v=!0;break}}else if(g.type==="paid"){for(const C of p)if(C.type==="paid"){v=!0;break}}if(!v)if(g.type==="emoji"){if(r.has(g.emoji))return!0}else if(g.type==="custom_emoji"){if(a.has(g.custom_emoji_id))return!0}else if(g.type==="paid"){if(c)return!0}else return!0}return!1}},chatType(s){const e=new Set(Pt(s));return t=>{var r;return((r=t.chat)==null?void 0:r.type)!==void 0&&e.has(t.chat.type)}},callbackQuery(s){const e=pe.filterQuery("callback_query:data"),t=Le(s);return r=>e(r)&&Pe(r,r.callbackQuery.data,t)},gameQuery(s){const e=pe.filterQuery("callback_query:game_short_name"),t=Le(s);return r=>e(r)&&Pe(r,r.callbackQuery.game_short_name,t)},inlineQuery(s){const e=pe.filterQuery("inline_query"),t=Le(s);return r=>e(r)&&Pe(r,r.inlineQuery.query,t)},chosenInlineResult(s){const e=pe.filterQuery("chosen_inline_result"),t=Le(s);return r=>e(r)&&Pe(r,r.chosenInlineResult.result_id,t)},preCheckoutQuery(s){const e=pe.filterQuery("pre_checkout_query"),t=Le(s);return r=>e(r)&&Pe(r,r.preCheckoutQuery.invoice_payload,t)},shippingQuery(s){const e=pe.filterQuery("shipping_query"),t=Le(s);return r=>e(r)&&Pe(r,r.shippingQuery.invoice_payload,t)}},oe=class oe{constructor(e,t,r){I(this,"update");I(this,"api");I(this,"me");I(this,"match");this.update=e,this.api=t,this.me=r}get message(){return this.update.message}get editedMessage(){return this.update.edited_message}get channelPost(){return this.update.channel_post}get editedChannelPost(){return this.update.edited_channel_post}get businessConnection(){return this.update.business_connection}get businessMessage(){return this.update.business_message}get editedBusinessMessage(){return this.update.edited_business_message}get deletedBusinessMessages(){return this.update.deleted_business_messages}get messageReaction(){return this.update.message_reaction}get messageReactionCount(){return this.update.message_reaction_count}get inlineQuery(){return this.update.inline_query}get chosenInlineResult(){return this.update.chosen_inline_result}get callbackQuery(){return this.update.callback_query}get shippingQuery(){return this.update.shipping_query}get preCheckoutQuery(){return this.update.pre_checkout_query}get poll(){return this.update.poll}get pollAnswer(){return this.update.poll_answer}get myChatMember(){return this.update.my_chat_member}get chatMember(){return this.update.chat_member}get chatJoinRequest(){return this.update.chat_join_request}get chatBoost(){return this.update.chat_boost}get removedChatBoost(){return this.update.removed_chat_boost}get purchasedPaidMedia(){return this.update.purchased_paid_media}get msg(){var e;return this.message??this.editedMessage??this.channelPost??this.editedChannelPost??this.businessMessage??this.editedBusinessMessage??((e=this.callbackQuery)==null?void 0:e.message)}get chat(){var e;return(e=this.msg??this.deletedBusinessMessages??this.messageReaction??this.messageReactionCount??this.myChatMember??this.chatMember??this.chatJoinRequest??this.chatBoost??this.removedChatBoost)==null?void 0:e.chat}get senderChat(){var e;return(e=this.msg)==null?void 0:e.sender_chat}get from(){var e,t,r,a;return((r=this.businessConnection??this.messageReaction??((t=((e=this.chatBoost)==null?void 0:e.boost)??this.removedChatBoost)==null?void 0:t.source))==null?void 0:r.user)??((a=this.callbackQuery??this.msg??this.inlineQuery??this.chosenInlineResult??this.shippingQuery??this.preCheckoutQuery??this.myChatMember??this.chatMember??this.chatJoinRequest??this.purchasedPaidMedia)==null?void 0:a.from)}get msgId(){var e,t,r;return((e=this.msg)==null?void 0:e.message_id)??((t=this.messageReaction)==null?void 0:t.message_id)??((r=this.messageReactionCount)==null?void 0:r.message_id)}get chatId(){var e,t;return((e=this.chat)==null?void 0:e.id)??((t=this.businessConnection)==null?void 0:t.user_chat_id)}get inlineMessageId(){var e,t;return((e=this.callbackQuery)==null?void 0:e.inline_message_id)??((t=this.chosenInlineResult)==null?void 0:t.inline_message_id)}get businessConnectionId(){var e,t,r;return((e=this.msg)==null?void 0:e.business_connection_id)??((t=this.businessConnection)==null?void 0:t.id)??((r=this.deletedBusinessMessages)==null?void 0:r.business_connection_id)}entities(e){const t=this.msg;if(t===void 0)return[];const r=t.text??t.caption;if(r===void 0)return[];let a=t.entities??t.caption_entities;if(a===void 0)return[];if(e!==void 0){const c=new Set(Pt(e));a=a.filter(l=>c.has(l.type))}return a.map(c=>({...c,text:r.substring(c.offset,c.offset+c.length)}))}reactions(){const e=[],t=[],r=[],a=[],c=[],l=[],p=[],d=[];let g=!1,v=!1;const C=this.messageReaction;if(C!==void 0){const{old_reaction:_,new_reaction:N}=C;for(const E of N)E.type==="emoji"?e.push(E.emoji):E.type==="custom_emoji"?c.push(E.custom_emoji_id):E.type==="paid"&&(g=v=!0);for(const E of _)E.type==="emoji"?a.push(E.emoji):E.type==="custom_emoji"?d.push(E.custom_emoji_id):E.type==="paid"&&(v=!1);t.push(...e),l.push(...c);for(let E=0;E<a.length;E++){const k=t.length;if(k===0)break;const L=a[E];for(let x=0;x<k;x++)if(L===t[x]){r.push(L),a.splice(E,1),t.splice(x,1),E--;break}}for(let E=0;E<d.length;E++){const k=l.length;if(k===0)break;const L=d[E];for(let x=0;x<k;x++)if(L===l[x]){p.push(L),d.splice(E,1),l.splice(x,1),E--;break}}}return{emoji:e,emojiAdded:t,emojiKept:r,emojiRemoved:a,customEmoji:c,customEmojiAdded:l,customEmojiKept:p,customEmojiRemoved:d,paid:g,paidAdded:v}}has(e){return oe.has.filterQuery(e)(this)}hasText(e){return oe.has.text(e)(this)}hasCommand(e){return oe.has.command(e)(this)}hasReaction(e){return oe.has.reaction(e)(this)}hasChatType(e){return oe.has.chatType(e)(this)}hasCallbackQuery(e){return oe.has.callbackQuery(e)(this)}hasGameQuery(e){return oe.has.gameQuery(e)(this)}hasInlineQuery(e){return oe.has.inlineQuery(e)(this)}hasChosenInlineResult(e){return oe.has.chosenInlineResult(e)(this)}hasPreCheckoutQuery(e){return oe.has.preCheckoutQuery(e)(this)}hasShippingQuery(e){return oe.has.shippingQuery(e)(this)}reply(e,t,r){return this.api.sendMessage(w(this.chatId,"sendMessage"),e,{business_connection_id:this.businessConnectionId,...t},r)}forwardMessage(e,t,r){return this.api.forwardMessage(e,w(this.chatId,"forwardMessage"),w(this.msgId,"forwardMessage"),t,r)}forwardMessages(e,t,r,a){return this.api.forwardMessages(e,w(this.chatId,"forwardMessages"),t,r,a)}copyMessage(e,t,r){return this.api.copyMessage(e,w(this.chatId,"copyMessage"),w(this.msgId,"copyMessage"),t,r)}copyMessages(e,t,r,a){return this.api.copyMessages(e,w(this.chatId,"copyMessages"),t,r,a)}replyWithPhoto(e,t,r){return this.api.sendPhoto(w(this.chatId,"sendPhoto"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithAudio(e,t,r){return this.api.sendAudio(w(this.chatId,"sendAudio"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithDocument(e,t,r){return this.api.sendDocument(w(this.chatId,"sendDocument"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithVideo(e,t,r){return this.api.sendVideo(w(this.chatId,"sendVideo"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithAnimation(e,t,r){return this.api.sendAnimation(w(this.chatId,"sendAnimation"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithVoice(e,t,r){return this.api.sendVoice(w(this.chatId,"sendVoice"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithVideoNote(e,t,r){return this.api.sendVideoNote(w(this.chatId,"sendVideoNote"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithMediaGroup(e,t,r){return this.api.sendMediaGroup(w(this.chatId,"sendMediaGroup"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithLocation(e,t,r,a){return this.api.sendLocation(w(this.chatId,"sendLocation"),e,t,{business_connection_id:this.businessConnectionId,...r},a)}editMessageLiveLocation(e,t,r,a){const c=this.inlineMessageId;return c!==void 0?this.api.editMessageLiveLocationInline(c,e,t,{business_connection_id:this.businessConnectionId,...r},a):this.api.editMessageLiveLocation(w(this.chatId,"editMessageLiveLocation"),w(this.msgId,"editMessageLiveLocation"),e,t,{business_connection_id:this.businessConnectionId,...r},a)}stopMessageLiveLocation(e,t){const r=this.inlineMessageId;return r!==void 0?this.api.stopMessageLiveLocationInline(r,{business_connection_id:this.businessConnectionId,...e},t):this.api.stopMessageLiveLocation(w(this.chatId,"stopMessageLiveLocation"),w(this.msgId,"stopMessageLiveLocation"),{business_connection_id:this.businessConnectionId,...e},t)}sendPaidMedia(e,t,r,a){return this.api.sendPaidMedia(w(this.chatId,"sendPaidMedia"),e,t,{business_connection_id:this.businessConnectionId,...r},a)}replyWithVenue(e,t,r,a,c,l){return this.api.sendVenue(w(this.chatId,"sendVenue"),e,t,r,a,{business_connection_id:this.businessConnectionId,...c},l)}replyWithContact(e,t,r,a){return this.api.sendContact(w(this.chatId,"sendContact"),e,t,{business_connection_id:this.businessConnectionId,...r},a)}replyWithPoll(e,t,r,a){return this.api.sendPoll(w(this.chatId,"sendPoll"),e,t,{business_connection_id:this.businessConnectionId,...r},a)}replyWithDice(e,t,r){return this.api.sendDice(w(this.chatId,"sendDice"),e,{business_connection_id:this.businessConnectionId,...t},r)}replyWithChatAction(e,t,r){return this.api.sendChatAction(w(this.chatId,"sendChatAction"),e,{business_connection_id:this.businessConnectionId,...t},r)}react(e,t,r){return this.api.setMessageReaction(w(this.chatId,"setMessageReaction"),w(this.msgId,"setMessageReaction"),typeof e=="string"?[{type:"emoji",emoji:e}]:(Array.isArray(e)?e:[e]).map(a=>typeof a=="string"?{type:"emoji",emoji:a}:a),t,r)}getUserProfilePhotos(e,t){return this.api.getUserProfilePhotos(w(this.from,"getUserProfilePhotos").id,e,t)}setUserEmojiStatus(e,t){return this.api.setUserEmojiStatus(w(this.from,"setUserEmojiStatus").id,e,t)}getUserChatBoosts(e,t){return this.api.getUserChatBoosts(e,w(this.from,"getUserChatBoosts").id,t)}getBusinessConnection(e){return this.api.getBusinessConnection(w(this.businessConnectionId,"getBusinessConnection"),e)}getFile(e){const t=w(this.msg,"getFile"),r=t.photo!==void 0?t.photo[t.photo.length-1]:t.animation??t.audio??t.document??t.video??t.video_note??t.voice??t.sticker;return this.api.getFile(w(r,"getFile").file_id,e)}kickAuthor(...e){return this.banAuthor(...e)}banAuthor(e,t){return this.api.banChatMember(w(this.chatId,"banAuthor"),w(this.from,"banAuthor").id,e,t)}kickChatMember(...e){return this.banChatMember(...e)}banChatMember(e,t,r){return this.api.banChatMember(w(this.chatId,"banChatMember"),e,t,r)}unbanChatMember(e,t,r){return this.api.unbanChatMember(w(this.chatId,"unbanChatMember"),e,t,r)}restrictAuthor(e,t,r){return this.api.restrictChatMember(w(this.chatId,"restrictAuthor"),w(this.from,"restrictAuthor").id,e,t,r)}restrictChatMember(e,t,r,a){return this.api.restrictChatMember(w(this.chatId,"restrictChatMember"),e,t,r,a)}promoteAuthor(e,t){return this.api.promoteChatMember(w(this.chatId,"promoteAuthor"),w(this.from,"promoteAuthor").id,e,t)}promoteChatMember(e,t,r){return this.api.promoteChatMember(w(this.chatId,"promoteChatMember"),e,t,r)}setChatAdministratorAuthorCustomTitle(e,t){return this.api.setChatAdministratorCustomTitle(w(this.chatId,"setChatAdministratorAuthorCustomTitle"),w(this.from,"setChatAdministratorAuthorCustomTitle").id,e,t)}setChatAdministratorCustomTitle(e,t,r){return this.api.setChatAdministratorCustomTitle(w(this.chatId,"setChatAdministratorCustomTitle"),e,t,r)}banChatSenderChat(e,t){return this.api.banChatSenderChat(w(this.chatId,"banChatSenderChat"),e,t)}unbanChatSenderChat(e,t){return this.api.unbanChatSenderChat(w(this.chatId,"unbanChatSenderChat"),e,t)}setChatPermissions(e,t,r){return this.api.setChatPermissions(w(this.chatId,"setChatPermissions"),e,t,r)}exportChatInviteLink(e){return this.api.exportChatInviteLink(w(this.chatId,"exportChatInviteLink"),e)}createChatInviteLink(e,t){return this.api.createChatInviteLink(w(this.chatId,"createChatInviteLink"),e,t)}editChatInviteLink(e,t,r){return this.api.editChatInviteLink(w(this.chatId,"editChatInviteLink"),e,t,r)}createChatSubscriptionInviteLink(e,t,r,a){return this.api.createChatSubscriptionInviteLink(w(this.chatId,"createChatSubscriptionInviteLink"),e,t,r,a)}editChatSubscriptionInviteLink(e,t,r){return this.api.editChatSubscriptionInviteLink(w(this.chatId,"editChatSubscriptionInviteLink"),e,t,r)}revokeChatInviteLink(e,t){return this.api.revokeChatInviteLink(w(this.chatId,"editChatInviteLink"),e,t)}approveChatJoinRequest(e,t){return this.api.approveChatJoinRequest(w(this.chatId,"approveChatJoinRequest"),e,t)}declineChatJoinRequest(e,t){return this.api.declineChatJoinRequest(w(this.chatId,"declineChatJoinRequest"),e,t)}setChatPhoto(e,t){return this.api.setChatPhoto(w(this.chatId,"setChatPhoto"),e,t)}deleteChatPhoto(e){return this.api.deleteChatPhoto(w(this.chatId,"deleteChatPhoto"),e)}setChatTitle(e,t){return this.api.setChatTitle(w(this.chatId,"setChatTitle"),e,t)}setChatDescription(e,t){return this.api.setChatDescription(w(this.chatId,"setChatDescription"),e,t)}pinChatMessage(e,t,r){return this.api.pinChatMessage(w(this.chatId,"pinChatMessage"),e,{business_connection_id:this.businessConnectionId,...t},r)}unpinChatMessage(e,t,r){return this.api.unpinChatMessage(w(this.chatId,"unpinChatMessage"),e,{business_connection_id:this.businessConnectionId,...t},r)}unpinAllChatMessages(e){return this.api.unpinAllChatMessages(w(this.chatId,"unpinAllChatMessages"),e)}leaveChat(e){return this.api.leaveChat(w(this.chatId,"leaveChat"),e)}getChat(e){return this.api.getChat(w(this.chatId,"getChat"),e)}getChatAdministrators(e){return this.api.getChatAdministrators(w(this.chatId,"getChatAdministrators"),e)}getChatMembersCount(...e){return this.getChatMemberCount(...e)}getChatMemberCount(e){return this.api.getChatMemberCount(w(this.chatId,"getChatMemberCount"),e)}getAuthor(e){return this.api.getChatMember(w(this.chatId,"getAuthor"),w(this.from,"getAuthor").id,e)}getChatMember(e,t){return this.api.getChatMember(w(this.chatId,"getChatMember"),e,t)}setChatStickerSet(e,t){return this.api.setChatStickerSet(w(this.chatId,"setChatStickerSet"),e,t)}deleteChatStickerSet(e){return this.api.deleteChatStickerSet(w(this.chatId,"deleteChatStickerSet"),e)}createForumTopic(e,t,r){return this.api.createForumTopic(w(this.chatId,"createForumTopic"),e,t,r)}editForumTopic(e,t){const r=w(this.msg,"editForumTopic"),a=w(r.message_thread_id,"editForumTopic");return this.api.editForumTopic(r.chat.id,a,e,t)}closeForumTopic(e){const t=w(this.msg,"closeForumTopic"),r=w(t.message_thread_id,"closeForumTopic");return this.api.closeForumTopic(t.chat.id,r,e)}reopenForumTopic(e){const t=w(this.msg,"reopenForumTopic"),r=w(t.message_thread_id,"reopenForumTopic");return this.api.reopenForumTopic(t.chat.id,r,e)}deleteForumTopic(e){const t=w(this.msg,"deleteForumTopic"),r=w(t.message_thread_id,"deleteForumTopic");return this.api.deleteForumTopic(t.chat.id,r,e)}unpinAllForumTopicMessages(e){const t=w(this.msg,"unpinAllForumTopicMessages"),r=w(t.message_thread_id,"unpinAllForumTopicMessages");return this.api.unpinAllForumTopicMessages(t.chat.id,r,e)}editGeneralForumTopic(e,t){return this.api.editGeneralForumTopic(w(this.chatId,"editGeneralForumTopic"),e,t)}closeGeneralForumTopic(e){return this.api.closeGeneralForumTopic(w(this.chatId,"closeGeneralForumTopic"),e)}reopenGeneralForumTopic(e){return this.api.reopenGeneralForumTopic(w(this.chatId,"reopenGeneralForumTopic"),e)}hideGeneralForumTopic(e){return this.api.hideGeneralForumTopic(w(this.chatId,"hideGeneralForumTopic"),e)}unhideGeneralForumTopic(e){return this.api.unhideGeneralForumTopic(w(this.chatId,"unhideGeneralForumTopic"),e)}unpinAllGeneralForumTopicMessages(e){return this.api.unpinAllGeneralForumTopicMessages(w(this.chatId,"unpinAllGeneralForumTopicMessages"),e)}answerCallbackQuery(e,t){return this.api.answerCallbackQuery(w(this.callbackQuery,"answerCallbackQuery").id,typeof e=="string"?{text:e}:e,t)}setChatMenuButton(e,t){return this.api.setChatMenuButton(e,t)}getChatMenuButton(e,t){return this.api.getChatMenuButton(e,t)}setMyDefaultAdministratorRights(e,t){return this.api.setMyDefaultAdministratorRights(e,t)}getMyDefaultAdministratorRights(e,t){return this.api.getMyDefaultAdministratorRights(e,t)}editMessageText(e,t,r){var c,l,p;const a=this.inlineMessageId;return a!==void 0?this.api.editMessageTextInline(a,e,{business_connection_id:this.businessConnectionId,...t},r):this.api.editMessageText(w(this.chatId,"editMessageText"),w(((c=this.msg)==null?void 0:c.message_id)??((l=this.messageReaction)==null?void 0:l.message_id)??((p=this.messageReactionCount)==null?void 0:p.message_id),"editMessageText"),e,{business_connection_id:this.businessConnectionId,...t},r)}editMessageCaption(e,t){var a,c,l;const r=this.inlineMessageId;return r!==void 0?this.api.editMessageCaptionInline(r,{business_connection_id:this.businessConnectionId,...e},t):this.api.editMessageCaption(w(this.chatId,"editMessageCaption"),w(((a=this.msg)==null?void 0:a.message_id)??((c=this.messageReaction)==null?void 0:c.message_id)??((l=this.messageReactionCount)==null?void 0:l.message_id),"editMessageCaption"),{business_connection_id:this.businessConnectionId,...e},t)}editMessageMedia(e,t,r){var c,l,p;const a=this.inlineMessageId;return a!==void 0?this.api.editMessageMediaInline(a,e,{business_connection_id:this.businessConnectionId,...t},r):this.api.editMessageMedia(w(this.chatId,"editMessageMedia"),w(((c=this.msg)==null?void 0:c.message_id)??((l=this.messageReaction)==null?void 0:l.message_id)??((p=this.messageReactionCount)==null?void 0:p.message_id),"editMessageMedia"),e,{business_connection_id:this.businessConnectionId,...t},r)}editMessageReplyMarkup(e,t){var a,c,l;const r=this.inlineMessageId;return r!==void 0?this.api.editMessageReplyMarkupInline(r,{business_connection_id:this.businessConnectionId,...e},t):this.api.editMessageReplyMarkup(w(this.chatId,"editMessageReplyMarkup"),w(((a=this.msg)==null?void 0:a.message_id)??((c=this.messageReaction)==null?void 0:c.message_id)??((l=this.messageReactionCount)==null?void 0:l.message_id),"editMessageReplyMarkup"),{business_connection_id:this.businessConnectionId,...e},t)}stopPoll(e,t){var r,a,c;return this.api.stopPoll(w(this.chatId,"stopPoll"),w(((r=this.msg)==null?void 0:r.message_id)??((a=this.messageReaction)==null?void 0:a.message_id)??((c=this.messageReactionCount)==null?void 0:c.message_id),"stopPoll"),{business_connection_id:this.businessConnectionId,...e},t)}deleteMessage(e){var t,r,a;return this.api.deleteMessage(w(this.chatId,"deleteMessage"),w(((t=this.msg)==null?void 0:t.message_id)??((r=this.messageReaction)==null?void 0:r.message_id)??((a=this.messageReactionCount)==null?void 0:a.message_id),"deleteMessage"),e)}deleteMessages(e,t){return this.api.deleteMessages(w(this.chatId,"deleteMessages"),e,t)}deleteBusinessMessages(e,t){return this.api.deleteBusinessMessages(w(this.businessConnectionId,"deleteBusinessMessages"),e,t)}setBusinessAccountName(e,t,r){return this.api.setBusinessAccountName(w(this.businessConnectionId,"setBusinessAccountName"),e,t,r)}setBusinessAccountUsername(e,t){return this.api.setBusinessAccountUsername(w(this.businessConnectionId,"setBusinessAccountUsername"),e,t)}setBusinessAccountBio(e,t){return this.api.setBusinessAccountBio(w(this.businessConnectionId,"setBusinessAccountBio"),e,t)}setBusinessAccountProfilePhoto(e,t,r){return this.api.setBusinessAccountProfilePhoto(w(this.businessConnectionId,"setBusinessAccountProfilePhoto"),e,t,r)}removeBusinessAccountProfilePhoto(e,t){return this.api.removeBusinessAccountProfilePhoto(w(this.businessConnectionId,"removeBusinessAccountProfilePhoto"),e,t)}setBusinessAccountGiftSettings(e,t,r){return this.api.setBusinessAccountGiftSettings(w(this.businessConnectionId,"setBusinessAccountGiftSettings"),e,t,r)}getBusinessAccountStarBalance(e){return this.api.getBusinessAccountStarBalance(w(this.businessConnectionId,"getBusinessAccountStarBalance"),e)}transferBusinessAccountStars(e,t){return this.api.transferBusinessAccountStars(w(this.businessConnectionId,"transferBusinessAccountStars"),e,t)}getBusinessAccountGifts(e,t){return this.api.getBusinessAccountGifts(w(this.businessConnectionId,"getBusinessAccountGifts"),e,t)}convertGiftToStars(e,t){return this.api.convertGiftToStars(w(this.businessConnectionId,"convertGiftToStars"),e,t)}upgradeGift(e,t,r){return this.api.upgradeGift(w(this.businessConnectionId,"upgradeGift"),e,t,r)}transferGift(e,t,r,a){return this.api.transferGift(w(this.businessConnectionId,"transferGift"),e,t,r,a)}postStory(e,t,r,a){return this.api.postStory(w(this.businessConnectionId,"postStory"),e,t,r,a)}editStory(e,t,r,a){return this.api.editStory(w(this.businessConnectionId,"editStory"),e,t,r,a)}deleteStory(e,t){return this.api.deleteStory(w(this.businessConnectionId,"deleteStory"),e,t)}replyWithSticker(e,t,r){return this.api.sendSticker(w(this.chatId,"sendSticker"),e,{business_connection_id:this.businessConnectionId,...t},r)}getCustomEmojiStickers(e){var t;return this.api.getCustomEmojiStickers((((t=this.msg)==null?void 0:t.entities)??[]).filter(r=>r.type==="custom_emoji").map(r=>r.custom_emoji_id),e)}replyWithGift(e,t,r){return this.api.sendGift(w(this.from,"sendGift").id,e,t,r)}giftPremiumSubscription(e,t,r,a){return this.api.giftPremiumSubscription(w(this.from,"giftPremiumSubscription").id,e,t,r,a)}replyWithGiftToChannel(e,t,r){return this.api.sendGiftToChannel(w(this.chat,"sendGift").id,e,t,r)}answerInlineQuery(e,t,r){return this.api.answerInlineQuery(w(this.inlineQuery,"answerInlineQuery").id,e,t,r)}savePreparedInlineMessage(e,t,r){return this.api.savePreparedInlineMessage(w(this.from,"savePreparedInlineMessage").id,e,t,r)}replyWithInvoice(e,t,r,a,c,l,p){return this.api.sendInvoice(w(this.chatId,"sendInvoice"),e,t,r,a,c,l,p)}answerShippingQuery(e,t,r){return this.api.answerShippingQuery(w(this.shippingQuery,"answerShippingQuery").id,e,t,r)}answerPreCheckoutQuery(e,t,r){return this.api.answerPreCheckoutQuery(w(this.preCheckoutQuery,"answerPreCheckoutQuery").id,e,typeof t=="string"?{error_message:t}:t,r)}refundStarPayment(e){var t;return this.api.refundStarPayment(w(this.from,"refundStarPayment").id,w((t=this.msg)==null?void 0:t.successful_payment,"refundStarPayment").telegram_payment_charge_id,e)}editUserStarSubscription(e,t,r){return this.api.editUserStarSubscription(w(this.from,"editUserStarSubscription").id,e,t,r)}verifyUser(e,t){return this.api.verifyUser(w(this.from,"verifyUser").id,e,t)}verifyChat(e,t){return this.api.verifyChat(w(this.chatId,"verifyChat"),e,t)}removeUserVerification(e){return this.api.removeUserVerification(w(this.from,"removeUserVerification").id,e)}removeChatVerification(e){return this.api.removeChatVerification(w(this.chatId,"removeChatVerification"),e)}readBusinessMessage(e){return this.api.readBusinessMessage(w(this.businessConnectionId,"readBusinessMessage"),w(this.chatId,"readBusinessMessage"),w(this.msgId,"readBusinessMessage"),e)}setPassportDataErrors(e,t){return this.api.setPassportDataErrors(w(this.from,"setPassportDataErrors").id,e,t)}replyWithGame(e,t,r){return this.api.sendGame(w(this.chatId,"sendGame"),e,{business_connection_id:this.businessConnectionId,...t},r)}};I(oe,"has",pe);let ie=oe;function w(s,e){if(s===void 0)throw new Error(`Missing information for API call to ${e}`);return s}function Le(s){return Pt(s).map(e=>typeof e=="string"?t=>t===e?e:null:t=>t.match(e))}function Pe(s,e,t){for(const r of t){const a=r(e);if(a)return s.match=a,!0}return!1}function Pt(s){return Array.isArray(s)?s:[s]}class on extends Error{constructor(t,r){super(ea(t));I(this,"error");I(this,"ctx");this.error=t,this.ctx=r,this.name="BotError",t instanceof Error&&(this.stack=t.stack)}}function ea(s){let e;if(s instanceof Error)e=`${s.name} in middleware: ${s.message}`;else{const t=typeof s;switch(e=`Non-error value of type ${t} thrown in middleware`,t){case"bigint":case"boolean":case"number":case"symbol":e+=`: ${s}`;break;case"string":e+=`: ${String(s).substring(0,50)}`;break;default:e+="!";break}}return e}function pt(s){return typeof s=="function"?s:(e,t)=>s.middleware()(e,t)}function wr(s,e){return async(t,r)=>{let a=!1;await s(t,async()=>{if(a)throw new Error("`next` already called before!");a=!0,await e(t,r)})}}function un(s,e){return e()}const ta=()=>Promise.resolve();async function br(s,e){await s(e,ta)}class Ie{constructor(...e){I(this,"handler");this.handler=e.length===0?un:e.map(pt).reduce(wr)}middleware(){return this.handler}use(...e){const t=new Ie(...e);return this.handler=wr(this.handler,pt(t)),t}on(e,...t){return this.filter(ie.has.filterQuery(e),...t)}hears(e,...t){return this.filter(ie.has.text(e),...t)}command(e,...t){return this.filter(ie.has.command(e),...t)}reaction(e,...t){return this.filter(ie.has.reaction(e),...t)}chatType(e,...t){return this.filter(ie.has.chatType(e),...t)}callbackQuery(e,...t){return this.filter(ie.has.callbackQuery(e),...t)}gameQuery(e,...t){return this.filter(ie.has.gameQuery(e),...t)}inlineQuery(e,...t){return this.filter(ie.has.inlineQuery(e),...t)}chosenInlineResult(e,...t){return this.filter(ie.has.chosenInlineResult(e),...t)}preCheckoutQuery(e,...t){return this.filter(ie.has.preCheckoutQuery(e),...t)}shippingQuery(e,...t){return this.filter(ie.has.shippingQuery(e),...t)}filter(e,...t){const r=new Ie(...t);return this.branch(e,r,un),r}drop(e,...t){return this.filter(async r=>!await e(r),...t)}fork(...e){const t=new Ie(...e),r=pt(t);return this.use((a,c)=>Promise.all([c(),br(r,a)])),t}lazy(e){return this.use(async(t,r)=>{const a=await e(t),c=Array.isArray(a)?a:[a];await pt(new Ie(...c))(t,r)})}route(e,t,r=un){return this.lazy(async a=>{const c=await e(a);return(c===void 0||!t[c]?r:t[c])??[]})}branch(e,t,r){return this.lazy(async a=>await e(a)?t:r)}errorBoundary(e,...t){const r=new Ie(...t),a=pt(r);return this.use(async(c,l)=>{let p=!1;const d=()=>(p=!0,Promise.resolve());try{await a(c,d)}catch(g){p=!1,await e(new on(g,c),d)}p&&await l()}),r}}var Ze=1e3,Ke=Ze*60,Qe=Ke*60,Ve=Qe*24,na=Ve*7,ra=Ve*365.25,sa=function(s,e){e=e||{};var t=typeof s;if(t==="string"&&s.length>0)return ia(s);if(t==="number"&&isFinite(s))return e.long?oa(s):aa(s);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(s))};function ia(s){if(s=String(s),!(s.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(s);if(e){var t=parseFloat(e[1]),r=(e[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return t*ra;case"weeks":case"week":case"w":return t*na;case"days":case"day":case"d":return t*Ve;case"hours":case"hour":case"hrs":case"hr":case"h":return t*Qe;case"minutes":case"minute":case"mins":case"min":case"m":return t*Ke;case"seconds":case"second":case"secs":case"sec":case"s":return t*Ze;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function aa(s){var e=Math.abs(s);return e>=Ve?Math.round(s/Ve)+"d":e>=Qe?Math.round(s/Qe)+"h":e>=Ke?Math.round(s/Ke)+"m":e>=Ze?Math.round(s/Ze)+"s":s+"ms"}function oa(s){var e=Math.abs(s);return e>=Ve?Vt(s,e,Ve,"day"):e>=Qe?Vt(s,e,Qe,"hour"):e>=Ke?Vt(s,e,Ke,"minute"):e>=Ze?Vt(s,e,Ze,"second"):s+" ms"}function Vt(s,e,t,r){var a=e>=t*1.5;return Math.round(s/t)+" "+r+(a?"s":"")}function vr(){throw new Error("setTimeout has not been defined")}function Cr(){throw new Error("clearTimeout has not been defined")}var ke=vr,Me=Cr,Je;typeof window<"u"?Je=window:typeof self<"u"?Je=self:Je={},typeof Je.setTimeout=="function"&&(ke=setTimeout),typeof Je.clearTimeout=="function"&&(Me=clearTimeout);function Sr(s){if(ke===setTimeout)return setTimeout(s,0);if((ke===vr||!ke)&&setTimeout)return ke=setTimeout,setTimeout(s,0);try{return ke(s,0)}catch{try{return ke.call(null,s,0)}catch{return ke.call(this,s,0)}}}function ua(s){if(Me===clearTimeout)return clearTimeout(s);if((Me===Cr||!Me)&&clearTimeout)return Me=clearTimeout,clearTimeout(s);try{return Me(s)}catch{try{return Me.call(null,s)}catch{return Me.call(this,s)}}}var Se=[],Xe=!1,Be,Bt=-1;function ca(){!Xe||!Be||(Xe=!1,Be.length?Se=Be.concat(Se):Bt=-1,Se.length&&Tr())}function Tr(){if(!Xe){var s=Sr(ca);Xe=!0;for(var e=Se.length;e;){for(Be=Se,Se=[];++Bt<e;)Be&&Be[Bt].run();Bt=-1,e=Se.length}Be=null,Xe=!1,ua(s)}}function la(s){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];Se.push(new _r(s,e)),Se.length===1&&!Xe&&Sr(Tr)}function _r(s,e){this.fun=s,this.array=e}_r.prototype.run=function(){this.fun.apply(null,this.array)};var ha="browser",da="browser",fa=!0,ma=[],pa="",ga={},ya={},wa={};function Ue(){}var ba=Ue,va=Ue,Ca=Ue,Sa=Ue,Ta=Ue,_a=Ue,Ea=Ue;function Ia(s){throw new Error("process.binding is not supported")}function ka(){return"/"}function Ma(s){throw new Error("process.chdir is not supported")}function Oa(){return 0}var et=Je.performance||{},Da=et.now||et.mozNow||et.msNow||et.oNow||et.webkitNow||function(){return new Date().getTime()};function Aa(s){var e=Da.call(et)*.001,t=Math.floor(e),r=Math.floor(e%1*1e9);return s&&(t=t-s[0],r=r-s[1],r<0&&(t--,r+=1e9)),[t,r]}var Na=new Date;function Fa(){var s=new Date,e=s-Na;return e/1e3}var cn={nextTick:la,title:ha,browser:fa,env:{NODE_ENV:"production"},argv:ma,version:pa,versions:ga,on:ba,addListener:va,once:Ca,off:Sa,removeListener:Ta,removeAllListeners:_a,emit:Ea,binding:Ia,cwd:ka,chdir:Ma,umask:Oa,hrtime:Aa,platform:da,release:ya,config:wa,uptime:Fa};function Ra(s,e,t){return t={path:e,exports:{},require:function(r,a){return $a(r,a??t.path)}},s(t,t.exports),t.exports}function $a(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}function xa(s){t.debug=t,t.default=t,t.coerce=d,t.disable=c,t.enable=a,t.enabled=l,t.humanize=sa,t.destroy=g,Object.keys(s).forEach(v=>{t[v]=s[v]}),t.names=[],t.skips=[],t.formatters={};function e(v){let C=0;for(let _=0;_<v.length;_++)C=(C<<5)-C+v.charCodeAt(_),C|=0;return t.colors[Math.abs(C)%t.colors.length]}t.selectColor=e;function t(v){let C,_=null,N,E;function k(...L){if(!k.enabled)return;const x=k,J=Number(new Date),ee=J-(C||J);x.diff=ee,x.prev=C,x.curr=J,C=J,L[0]=t.coerce(L[0]),typeof L[0]!="string"&&L.unshift("%O");let F=0;L[0]=L[0].replace(/%([a-zA-Z%])/g,($,R)=>{if($==="%%")return"%";F++;const j=t.formatters[R];if(typeof j=="function"){const Y=L[F];$=j.call(x,Y),L.splice(F,1),F--}return $}),t.formatArgs.call(x,L),(x.log||t.log).apply(x,L)}return k.namespace=v,k.useColors=t.useColors(),k.color=t.selectColor(v),k.extend=r,k.destroy=t.destroy,Object.defineProperty(k,"enabled",{enumerable:!0,configurable:!1,get:()=>_!==null?_:(N!==t.namespaces&&(N=t.namespaces,E=t.enabled(v)),E),set:L=>{_=L}}),typeof t.init=="function"&&t.init(k),k}function r(v,C){const _=t(this.namespace+(typeof C>"u"?":":C)+v);return _.log=this.log,_}function a(v){t.save(v),t.namespaces=v,t.names=[],t.skips=[];let C;const _=(typeof v=="string"?v:"").split(/[\s,]+/),N=_.length;for(C=0;C<N;C++)_[C]&&(v=_[C].replace(/\*/g,".*?"),v[0]==="-"?t.skips.push(new RegExp("^"+v.slice(1)+"$")):t.names.push(new RegExp("^"+v+"$")))}function c(){const v=[...t.names.map(p),...t.skips.map(p).map(C=>"-"+C)].join(",");return t.enable(""),v}function l(v){if(v[v.length-1]==="*")return!0;let C,_;for(C=0,_=t.skips.length;C<_;C++)if(t.skips[C].test(v))return!1;for(C=0,_=t.names.length;C<_;C++)if(t.names[C].test(v))return!0;return!1}function p(v){return v.toString().substring(2,v.toString().length-2).replace(/\.\*\?$/,"*")}function d(v){return v instanceof Error?v.stack||v.message:v}function g(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}var La=xa,re=Ra(function(s,e){e.formatArgs=r,e.save=a,e.load=c,e.useColors=t,e.storage=l(),e.destroy=(()=>{let d=!1;return()=>{d||(d=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function t(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(d){if(d[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+d[0]+(this.useColors?"%c ":" ")+"+"+s.exports.humanize(this.diff),!this.useColors)return;const g="color: "+this.color;d.splice(1,0,g,"color: inherit");let v=0,C=0;d[0].replace(/%[a-zA-Z%]/g,_=>{_!=="%%"&&(v++,_==="%c"&&(C=v))}),d.splice(C,0,g)}e.log=console.debug||console.log||(()=>{});function a(d){try{d?e.storage.setItem("debug",d):e.storage.removeItem("debug")}catch{}}function c(){let d;try{d=e.storage.getItem("debug")}catch{}return!d&&typeof cn<"u"&&"env"in cn&&(d=cn.env.DEBUG),d}function l(){try{return localStorage}catch{}}s.exports=La(e);const{formatters:p}=s.exports;p.j=function(d){try{return JSON.stringify(d)}catch(g){return"[UnexpectedJSONParseError]: "+g.message}}});re.colors,re.destroy,re.formatArgs,re.load,re.log,re.save,re.storage,re.useColors;const Pa=s=>{const e=s[Symbol.asyncIterator]();return new ReadableStream({async pull(t){const r=await e.next();r.done?t.close():t.enqueue(r.value)}})},Va=s=>({}),Er=re("grammy:warn");class ln extends Error{constructor(t,r,a,c){super(`${t} (${r.error_code}: ${r.description})`);I(this,"method");I(this,"payload");I(this,"ok");I(this,"error_code");I(this,"description");I(this,"parameters");this.method=a,this.payload=c,this.ok=!1,this.name="GrammyError",this.error_code=r.error_code,this.description=r.description,this.parameters=r.parameters??{}}}function Ba(s,e,t){switch(s.error_code){case 401:Er("Error 401 means that your bot token is wrong, talk to https://t.me/BotFather to check it.");break;case 409:Er("Error 409 means that you are running your bot several times on long polling. Consider revoking the bot token if you believe that no other instance is running.");break}return new ln(`Call to '${e}' failed!`,s,e,t)}class Ir extends Error{constructor(t,r){super(t);I(this,"error");this.error=r,this.name="HttpError"}}function Ua(s){return typeof s=="object"&&s!==null&&"status"in s&&"statusText"in s}function Wa(s,e){return t=>{let r=`Network request for '${s}' failed!`;throw Ua(t)&&(r+=` (${t.status}: ${t.statusText})`),e&&t instanceof Error&&(r+=` ${t.message}`),new Ir(r,t)}}const ja=(()=>{var t,r,a;const{Deno:s}=globalThis;if(typeof((t=s==null?void 0:s.build)==null?void 0:t.os)=="string")return s.build.os;const{navigator:e}=globalThis;return(a=(r=e==null?void 0:e.appVersion)==null?void 0:r.includes)!=null&&a.call(r,"Win")?"windows":"linux"})()==="windows";function qa(s){if(typeof s!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(s)}`)}function kr(s,e){if(e.length>=s.length)return s;const t=s.length-e.length;for(let r=e.length-1;r>=0;--r)if(s.charCodeAt(t+r)!==e.charCodeAt(r))return s;return s.slice(0,-e.length)}function Mr(s,e,t=0){let r=!1,a=s.length;for(let c=s.length-1;c>=t;--c)if(e(s.charCodeAt(c))){if(r){t=c+1;break}}else r||(r=!0,a=c+1);return s.slice(t,a)}function Or(s,e){if(qa(s),s.length===0)return s;if(typeof e!="string")throw new TypeError(`Suffix must be a string. Received ${JSON.stringify(e)}`)}function Dr(s,e){if(s.length<=1)return s;let t=s.length;for(let r=s.length-1;r>0&&e(s.charCodeAt(r));r--)t=r;return s.slice(0,t)}function Ar(s){return s===47}function Ga(s,e=""){Or(s,e);const t=Mr(s,Ar),r=Dr(t,Ar);return e?kr(r,e):r}function Nr(s){return s===47||s===92}function Ha(s){return s>=97&&s<=122||s>=65&&s<=90}function za(s,e=""){Or(s,e);let t=0;if(s.length>=2){const c=s.charCodeAt(0);Ha(c)&&s.charCodeAt(1)===58&&(t=2)}const r=Mr(s,Nr,t),a=Dr(r,Nr);return e?kr(a,e):a}function Ut(s,e=""){return ja?za(s,e):Ga(s,e)}class hn{constructor(e,t){I(this,"consumed",!1);I(this,"fileData");I(this,"filename");this.fileData=e,t??(t=this.guessFilename(e)),this.filename=t}guessFilename(e){if(typeof e=="string")return Ut(e);if(typeof e=="object"){if("url"in e)return Ut(e.url);if(e instanceof URL)return Ut(e.pathname)||Ut(e.hostname)}}toRaw(){if(this.consumed)throw new Error("Cannot reuse InputFile data source!");const e=this.fileData;return e instanceof Blob?e.stream():e instanceof URL?Fr(e):"url"in e?Fr(e.url):(e instanceof Uint8Array||(this.consumed=!0),e)}}async function*Fr(s){const{body:e}=await fetch(s);if(e===null)throw new Error(`Download failed, no response body from '${s}'`);yield*e}function dn(s){return s instanceof hn||typeof s=="object"&&s!==null&&Object.values(s).some(e=>Array.isArray(e)?e.some(dn):e instanceof hn||dn(e))}function Rr(s){return JSON.stringify(s,(e,t)=>t??void 0)}function $r(s){return{method:"POST",headers:{"content-type":"application/json",connection:"keep-alive"},body:Rr(s)}}async function*Ya(s,e){try{yield*s}catch(t){e(t)}}function Za(s,e){const t=Ka(),r=Qa(s,t),a=Ya(r,e),c=Pa(a);return{method:"POST",headers:{"content-type":`multipart/form-data; boundary=${t}`,connection:"keep-alive"},body:c}}function Ka(){return"----------"+xr(32)}function xr(s=16){return Array.from(Array(s)).map(()=>Math.random().toString(36)[2]||0).join("")}const gt=new TextEncoder;async function*Qa(s,e){const t=fn(s);yield gt.encode(`--${e}\r
`);const r=gt.encode(`\r
--${e}\r
`);let a=!0;for(const[c,l]of Object.entries(s))l!=null&&(a||(yield r),yield Ja(c,typeof l=="object"?Rr(l):l),a=!1);for(const{id:c,origin:l,file:p}of t)a||(yield r),yield*Xa(c,l,p),a=!1;yield gt.encode(`\r
--${e}--\r
`)}function fn(s){return typeof s!="object"||s===null?[]:Object.entries(s).flatMap(([e,t])=>{if(Array.isArray(t))return t.flatMap(r=>fn(r));if(t instanceof hn){const r=xr();Object.assign(s,{[e]:`attach://${r}`});const a=e==="media"&&"type"in s&&typeof s.type=="string"?s.type:e;return{id:r,origin:a,file:t}}else return fn(t)})}function Ja(s,e){return gt.encode(`content-disposition:form-data;name="${s}"\r
\r
${e}`)}async function*Xa(s,e,t){const r=t.filename||`${e}.${eo(e)}`;if(r.includes("\r")||r.includes(`
`))throw new Error(`File paths cannot contain carriage-return (\\r) or newline (\\n) characters! Filename for property '${e}' was:
"""
${r}
"""`);yield gt.encode(`content-disposition:form-data;name="${s}";filename=${r}\r
content-type:application/octet-stream\r
\r
`);const a=await t.toRaw();a instanceof Uint8Array?yield a:yield*a}function eo(s){switch(s){case"certificate":return"pem";case"photo":case"thumbnail":return"jpg";case"voice":return"ogg";case"audio":return"mp3";case"animation":case"video":case"video_note":return"mp4";case"sticker":return"webp";default:return"dat"}}const to=re("grammy:core");function no(s,e){return(t,r,a)=>e(s,t,r,a)}class ro{constructor(e,t={},r={}){I(this,"token");I(this,"webhookReplyEnvelope");I(this,"options");I(this,"fetch");I(this,"hasUsedWebhookReply");I(this,"installedTransformers");I(this,"call");this.token=e,this.webhookReplyEnvelope=r,this.hasUsedWebhookReply=!1,this.installedTransformers=[],this.call=async(d,g,v)=>{const C=g??{};to(`Calling ${d}`),v!==void 0&&lo(d,C,v);const _=this.options,N=dn(C);if(this.webhookReplyEnvelope.send!==void 0&&!this.hasUsedWebhookReply&&!N&&_.canUseWebhookReply(d)){this.hasUsedWebhookReply=!0;const R=$r({...C,method:d});return await this.webhookReplyEnvelope.send(R.body),{ok:!0,result:!0}}const E=co(v),k=oo(E,_.timeoutSeconds,d),L=uo(E),x=_.buildUrl(_.apiRoot,this.token,d,_.environment),J=N?Za(C,R=>L.catch(R)):$r(C),ee=E.signal,F={..._.baseFetchConfig,signal:ee,...J},$=[this.fetch(x instanceof URL?x.href:x,F).catch(Wa(d,_.sensitiveLogs)),L.promise,k.promise];try{return await(await Promise.race($)).json()}finally{k.handle!==void 0&&clearTimeout(k.handle)}};const a=t.apiRoot??"https://api.telegram.org",c=t.environment??"prod",{fetch:l}=t,p=l??fetch;if(this.options={apiRoot:a,environment:c,buildUrl:t.buildUrl??io,timeoutSeconds:t.timeoutSeconds??500,baseFetchConfig:{...Va(),...t.baseFetchConfig},canUseWebhookReply:t.canUseWebhookReply??(()=>!1),sensitiveLogs:t.sensitiveLogs??!1,fetch:(...d)=>p(...d)},this.fetch=this.options.fetch,this.options.apiRoot.endsWith("/"))throw new Error(`Remove the trailing '/' from the 'apiRoot' option (use '${this.options.apiRoot.substring(0,this.options.apiRoot.length-1)}' instead of '${this.options.apiRoot}')`)}use(...e){return this.call=e.reduce(no,this.call),this.installedTransformers.push(...e),this}async callApi(e,t,r){const a=await this.call(e,t,r);if(a.ok)return a.result;throw Ba(a,e,t)}}function so(s,e,t){const r=new ro(s,e,t),a={get(d,g){return g==="toJSON"?"__internal":g==="getMe"||g==="getWebhookInfo"||g==="getForumTopicIconStickers"||g==="getAvailableGifts"||g==="logOut"||g==="close"?r.callApi.bind(r,g,{}):r.callApi.bind(r,g)},...ao},c=new Proxy({},a),l=r.installedTransformers,p={raw:c,installedTransformers:l,use:(...d)=>(r.use(...d),p)};return p}const io=(s,e,t,r)=>`${s}/bot${e}/${r==="test"?"test/":""}${t}`,ao={set(){return!1},defineProperty(){return!1},deleteProperty(){return!1},ownKeys(){return[]}};function oo(s,e,t){let r;return{promise:new Promise((c,l)=>{r=setTimeout(()=>{const p=`Request to '${t}' timed out after ${e} seconds`;l(new Error(p)),s.abort()},1e3*e)}),handle:r}}function uo(s){let e=r=>{throw r};return{promise:new Promise((r,a)=>{e=c=>{a(c),s.abort()}}),catch:e}}function co(s){const e=new AbortController;if(s===void 0)return e;const t=s;function r(){e.abort(),t.removeEventListener("abort",r)}return t.aborted?r():t.addEventListener("abort",r),{abort:r,signal:e.signal}}function lo(s,e,t){if(typeof(t==null?void 0:t.addEventListener)=="function")return;let r=JSON.stringify(e);r.length>20&&(r=r.substring(0,16)+" ...");let a=JSON.stringify(t);throw a.length>20&&(a=a.substring(0,16)+" ..."),new Error(`Incorrect abort signal instance found! You passed two payloads to '${s}' but you should merge the second one containing '${a}' into the first one containing '${r}'! If you are using context shortcuts, you may want to use a method on 'ctx.api' instead.

If you want to prevent such mistakes in the future, consider using TypeScript. https://www.typescriptlang.org/`)}class Lr{constructor(e,t,r){I(this,"token");I(this,"options");I(this,"raw");I(this,"config");this.token=e,this.options=t;const{raw:a,use:c,installedTransformers:l}=so(e,t,r);this.raw=a,this.config={use:c,installedTransformers:()=>l.slice()}}getUpdates(e,t){return this.raw.getUpdates({...e},t)}setWebhook(e,t,r){return this.raw.setWebhook({url:e,...t},r)}deleteWebhook(e,t){return this.raw.deleteWebhook({...e},t)}getWebhookInfo(e){return this.raw.getWebhookInfo(e)}getMe(e){return this.raw.getMe(e)}logOut(e){return this.raw.logOut(e)}close(e){return this.raw.close(e)}sendMessage(e,t,r,a){return this.raw.sendMessage({chat_id:e,text:t,...r},a)}forwardMessage(e,t,r,a,c){return this.raw.forwardMessage({chat_id:e,from_chat_id:t,message_id:r,...a},c)}forwardMessages(e,t,r,a,c){return this.raw.forwardMessages({chat_id:e,from_chat_id:t,message_ids:r,...a},c)}copyMessage(e,t,r,a,c){return this.raw.copyMessage({chat_id:e,from_chat_id:t,message_id:r,...a},c)}copyMessages(e,t,r,a,c){return this.raw.copyMessages({chat_id:e,from_chat_id:t,message_ids:r,...a},c)}sendPhoto(e,t,r,a){return this.raw.sendPhoto({chat_id:e,photo:t,...r},a)}sendAudio(e,t,r,a){return this.raw.sendAudio({chat_id:e,audio:t,...r},a)}sendDocument(e,t,r,a){return this.raw.sendDocument({chat_id:e,document:t,...r},a)}sendVideo(e,t,r,a){return this.raw.sendVideo({chat_id:e,video:t,...r},a)}sendAnimation(e,t,r,a){return this.raw.sendAnimation({chat_id:e,animation:t,...r},a)}sendVoice(e,t,r,a){return this.raw.sendVoice({chat_id:e,voice:t,...r},a)}sendVideoNote(e,t,r,a){return this.raw.sendVideoNote({chat_id:e,video_note:t,...r},a)}sendMediaGroup(e,t,r,a){return this.raw.sendMediaGroup({chat_id:e,media:t,...r},a)}sendLocation(e,t,r,a,c){return this.raw.sendLocation({chat_id:e,latitude:t,longitude:r,...a},c)}editMessageLiveLocation(e,t,r,a,c,l){return this.raw.editMessageLiveLocation({chat_id:e,message_id:t,latitude:r,longitude:a,...c},l)}editMessageLiveLocationInline(e,t,r,a,c){return this.raw.editMessageLiveLocation({inline_message_id:e,latitude:t,longitude:r,...a},c)}stopMessageLiveLocation(e,t,r,a){return this.raw.stopMessageLiveLocation({chat_id:e,message_id:t,...r},a)}stopMessageLiveLocationInline(e,t,r){return this.raw.stopMessageLiveLocation({inline_message_id:e,...t},r)}sendPaidMedia(e,t,r,a,c){return this.raw.sendPaidMedia({chat_id:e,star_count:t,media:r,...a},c)}sendVenue(e,t,r,a,c,l,p){return this.raw.sendVenue({chat_id:e,latitude:t,longitude:r,title:a,address:c,...l},p)}sendContact(e,t,r,a,c){return this.raw.sendContact({chat_id:e,phone_number:t,first_name:r,...a},c)}sendPoll(e,t,r,a,c){return this.raw.sendPoll({chat_id:e,question:t,options:r,...a},c)}sendDice(e,t,r,a){return this.raw.sendDice({chat_id:e,emoji:t,...r},a)}setMessageReaction(e,t,r,a,c){return this.raw.setMessageReaction({chat_id:e,message_id:t,reaction:r,...a},c)}sendChatAction(e,t,r,a){return this.raw.sendChatAction({chat_id:e,action:t,...r},a)}getUserProfilePhotos(e,t,r){return this.raw.getUserProfilePhotos({user_id:e,...t},r)}setUserEmojiStatus(e,t,r){return this.raw.setUserEmojiStatus({user_id:e,...t},r)}getUserChatBoosts(e,t,r){return this.raw.getUserChatBoosts({chat_id:e,user_id:t},r)}getBusinessConnection(e,t){return this.raw.getBusinessConnection({business_connection_id:e},t)}getFile(e,t){return this.raw.getFile({file_id:e},t)}kickChatMember(...e){return this.banChatMember(...e)}banChatMember(e,t,r,a){return this.raw.banChatMember({chat_id:e,user_id:t,...r},a)}unbanChatMember(e,t,r,a){return this.raw.unbanChatMember({chat_id:e,user_id:t,...r},a)}restrictChatMember(e,t,r,a,c){return this.raw.restrictChatMember({chat_id:e,user_id:t,permissions:r,...a},c)}promoteChatMember(e,t,r,a){return this.raw.promoteChatMember({chat_id:e,user_id:t,...r},a)}setChatAdministratorCustomTitle(e,t,r,a){return this.raw.setChatAdministratorCustomTitle({chat_id:e,user_id:t,custom_title:r},a)}banChatSenderChat(e,t,r){return this.raw.banChatSenderChat({chat_id:e,sender_chat_id:t},r)}unbanChatSenderChat(e,t,r){return this.raw.unbanChatSenderChat({chat_id:e,sender_chat_id:t},r)}setChatPermissions(e,t,r,a){return this.raw.setChatPermissions({chat_id:e,permissions:t,...r},a)}exportChatInviteLink(e,t){return this.raw.exportChatInviteLink({chat_id:e},t)}createChatInviteLink(e,t,r){return this.raw.createChatInviteLink({chat_id:e,...t},r)}editChatInviteLink(e,t,r,a){return this.raw.editChatInviteLink({chat_id:e,invite_link:t,...r},a)}createChatSubscriptionInviteLink(e,t,r,a,c){return this.raw.createChatSubscriptionInviteLink({chat_id:e,subscription_period:t,subscription_price:r,...a},c)}editChatSubscriptionInviteLink(e,t,r,a){return this.raw.editChatSubscriptionInviteLink({chat_id:e,invite_link:t,...r},a)}revokeChatInviteLink(e,t,r){return this.raw.revokeChatInviteLink({chat_id:e,invite_link:t},r)}approveChatJoinRequest(e,t,r){return this.raw.approveChatJoinRequest({chat_id:e,user_id:t},r)}declineChatJoinRequest(e,t,r){return this.raw.declineChatJoinRequest({chat_id:e,user_id:t},r)}setChatPhoto(e,t,r){return this.raw.setChatPhoto({chat_id:e,photo:t},r)}deleteChatPhoto(e,t){return this.raw.deleteChatPhoto({chat_id:e},t)}setChatTitle(e,t,r){return this.raw.setChatTitle({chat_id:e,title:t},r)}setChatDescription(e,t,r){return this.raw.setChatDescription({chat_id:e,description:t},r)}pinChatMessage(e,t,r,a){return this.raw.pinChatMessage({chat_id:e,message_id:t,...r},a)}unpinChatMessage(e,t,r,a){return this.raw.unpinChatMessage({chat_id:e,message_id:t,...r},a)}unpinAllChatMessages(e,t){return this.raw.unpinAllChatMessages({chat_id:e},t)}leaveChat(e,t){return this.raw.leaveChat({chat_id:e},t)}getChat(e,t){return this.raw.getChat({chat_id:e},t)}getChatAdministrators(e,t){return this.raw.getChatAdministrators({chat_id:e},t)}getChatMembersCount(...e){return this.getChatMemberCount(...e)}getChatMemberCount(e,t){return this.raw.getChatMemberCount({chat_id:e},t)}getChatMember(e,t,r){return this.raw.getChatMember({chat_id:e,user_id:t},r)}setChatStickerSet(e,t,r){return this.raw.setChatStickerSet({chat_id:e,sticker_set_name:t},r)}deleteChatStickerSet(e,t){return this.raw.deleteChatStickerSet({chat_id:e},t)}getForumTopicIconStickers(e){return this.raw.getForumTopicIconStickers(e)}createForumTopic(e,t,r,a){return this.raw.createForumTopic({chat_id:e,name:t,...r},a)}editForumTopic(e,t,r,a){return this.raw.editForumTopic({chat_id:e,message_thread_id:t,...r},a)}closeForumTopic(e,t,r){return this.raw.closeForumTopic({chat_id:e,message_thread_id:t},r)}reopenForumTopic(e,t,r){return this.raw.reopenForumTopic({chat_id:e,message_thread_id:t},r)}deleteForumTopic(e,t,r){return this.raw.deleteForumTopic({chat_id:e,message_thread_id:t},r)}unpinAllForumTopicMessages(e,t,r){return this.raw.unpinAllForumTopicMessages({chat_id:e,message_thread_id:t},r)}editGeneralForumTopic(e,t,r){return this.raw.editGeneralForumTopic({chat_id:e,name:t},r)}closeGeneralForumTopic(e,t){return this.raw.closeGeneralForumTopic({chat_id:e},t)}reopenGeneralForumTopic(e,t){return this.raw.reopenGeneralForumTopic({chat_id:e},t)}hideGeneralForumTopic(e,t){return this.raw.hideGeneralForumTopic({chat_id:e},t)}unhideGeneralForumTopic(e,t){return this.raw.unhideGeneralForumTopic({chat_id:e},t)}unpinAllGeneralForumTopicMessages(e,t){return this.raw.unpinAllGeneralForumTopicMessages({chat_id:e},t)}answerCallbackQuery(e,t,r){return this.raw.answerCallbackQuery({callback_query_id:e,...t},r)}setMyName(e,t,r){return this.raw.setMyName({name:e,...t},r)}getMyName(e,t){return this.raw.getMyName(e??{},t)}setMyCommands(e,t,r){return this.raw.setMyCommands({commands:e,...t},r)}deleteMyCommands(e,t){return this.raw.deleteMyCommands({...e},t)}getMyCommands(e,t){return this.raw.getMyCommands({...e},t)}setMyDescription(e,t,r){return this.raw.setMyDescription({description:e,...t},r)}getMyDescription(e,t){return this.raw.getMyDescription({...e},t)}setMyShortDescription(e,t,r){return this.raw.setMyShortDescription({short_description:e,...t},r)}getMyShortDescription(e,t){return this.raw.getMyShortDescription({...e},t)}setChatMenuButton(e,t){return this.raw.setChatMenuButton({...e},t)}getChatMenuButton(e,t){return this.raw.getChatMenuButton({...e},t)}setMyDefaultAdministratorRights(e,t){return this.raw.setMyDefaultAdministratorRights({...e},t)}getMyDefaultAdministratorRights(e,t){return this.raw.getMyDefaultAdministratorRights({...e},t)}editMessageText(e,t,r,a,c){return this.raw.editMessageText({chat_id:e,message_id:t,text:r,...a},c)}editMessageTextInline(e,t,r,a){return this.raw.editMessageText({inline_message_id:e,text:t,...r},a)}editMessageCaption(e,t,r,a){return this.raw.editMessageCaption({chat_id:e,message_id:t,...r},a)}editMessageCaptionInline(e,t,r){return this.raw.editMessageCaption({inline_message_id:e,...t},r)}editMessageMedia(e,t,r,a,c){return this.raw.editMessageMedia({chat_id:e,message_id:t,media:r,...a},c)}editMessageMediaInline(e,t,r,a){return this.raw.editMessageMedia({inline_message_id:e,media:t,...r},a)}editMessageReplyMarkup(e,t,r,a){return this.raw.editMessageReplyMarkup({chat_id:e,message_id:t,...r},a)}editMessageReplyMarkupInline(e,t,r){return this.raw.editMessageReplyMarkup({inline_message_id:e,...t},r)}stopPoll(e,t,r,a){return this.raw.stopPoll({chat_id:e,message_id:t,...r},a)}deleteMessage(e,t,r){return this.raw.deleteMessage({chat_id:e,message_id:t},r)}deleteMessages(e,t,r){return this.raw.deleteMessages({chat_id:e,message_ids:t},r)}deleteBusinessMessages(e,t,r){return this.raw.deleteBusinessMessages({business_connection_id:e,message_ids:t},r)}setBusinessAccountName(e,t,r,a){return this.raw.setBusinessAccountName({business_connection_id:e,first_name:t,...r},a)}setBusinessAccountUsername(e,t,r){return this.raw.setBusinessAccountUsername({business_connection_id:e,username:t},r)}setBusinessAccountBio(e,t,r){return this.raw.setBusinessAccountBio({business_connection_id:e,bio:t},r)}setBusinessAccountProfilePhoto(e,t,r,a){return this.raw.setBusinessAccountProfilePhoto({business_connection_id:e,photo:t,...r},a)}removeBusinessAccountProfilePhoto(e,t,r){return this.raw.removeBusinessAccountProfilePhoto({business_connection_id:e,...t},r)}setBusinessAccountGiftSettings(e,t,r,a){return this.raw.setBusinessAccountGiftSettings({business_connection_id:e,show_gift_button:t,accepted_gift_types:r},a)}getBusinessAccountStarBalance(e,t){return this.raw.getBusinessAccountStarBalance({business_connection_id:e},t)}transferBusinessAccountStars(e,t,r){return this.raw.transferBusinessAccountStars({business_connection_id:e,star_count:t},r)}getBusinessAccountGifts(e,t,r){return this.raw.getBusinessAccountGifts({business_connection_id:e,...t},r)}convertGiftToStars(e,t,r){return this.raw.convertGiftToStars({business_connection_id:e,owned_gift_id:t},r)}upgradeGift(e,t,r,a){return this.raw.upgradeGift({business_connection_id:e,owned_gift_id:t,...r},a)}transferGift(e,t,r,a,c){return this.raw.transferGift({business_connection_id:e,owned_gift_id:t,new_owner_chat_id:r,star_count:a},c)}postStory(e,t,r,a,c){return this.raw.postStory({business_connection_id:e,content:t,active_period:r,...a},c)}editStory(e,t,r,a,c){return this.raw.editStory({business_connection_id:e,story_id:t,content:r,...a},c)}deleteStory(e,t,r){return this.raw.deleteStory({business_connection_id:e,story_id:t},r)}sendSticker(e,t,r,a){return this.raw.sendSticker({chat_id:e,sticker:t,...r},a)}getStickerSet(e,t){return this.raw.getStickerSet({name:e},t)}getCustomEmojiStickers(e,t){return this.raw.getCustomEmojiStickers({custom_emoji_ids:e},t)}uploadStickerFile(e,t,r,a){return this.raw.uploadStickerFile({user_id:e,sticker_format:t,sticker:r},a)}createNewStickerSet(e,t,r,a,c,l){return this.raw.createNewStickerSet({user_id:e,name:t,title:r,stickers:a,...c},l)}addStickerToSet(e,t,r,a){return this.raw.addStickerToSet({user_id:e,name:t,sticker:r},a)}setStickerPositionInSet(e,t,r){return this.raw.setStickerPositionInSet({sticker:e,position:t},r)}deleteStickerFromSet(e,t){return this.raw.deleteStickerFromSet({sticker:e},t)}replaceStickerInSet(e,t,r,a,c){return this.raw.replaceStickerInSet({user_id:e,name:t,old_sticker:r,sticker:a},c)}setStickerEmojiList(e,t,r){return this.raw.setStickerEmojiList({sticker:e,emoji_list:t},r)}setStickerKeywords(e,t,r){return this.raw.setStickerKeywords({sticker:e,keywords:t},r)}setStickerMaskPosition(e,t,r){return this.raw.setStickerMaskPosition({sticker:e,mask_position:t},r)}setStickerSetTitle(e,t,r){return this.raw.setStickerSetTitle({name:e,title:t},r)}deleteStickerSet(e,t){return this.raw.deleteStickerSet({name:e},t)}setStickerSetThumbnail(e,t,r,a,c){return this.raw.setStickerSetThumbnail({name:e,user_id:t,thumbnail:r,format:a},c)}setCustomEmojiStickerSetThumbnail(e,t,r){return this.raw.setCustomEmojiStickerSetThumbnail({name:e,custom_emoji_id:t},r)}getAvailableGifts(e){return this.raw.getAvailableGifts(e)}sendGift(e,t,r,a){return this.raw.sendGift({user_id:e,gift_id:t,...r},a)}giftPremiumSubscription(e,t,r,a,c){return this.raw.giftPremiumSubscription({user_id:e,month_count:t,star_count:r,...a},c)}sendGiftToChannel(e,t,r,a){return this.raw.sendGift({chat_id:e,gift_id:t,...r},a)}answerInlineQuery(e,t,r,a){return this.raw.answerInlineQuery({inline_query_id:e,results:t,...r},a)}answerWebAppQuery(e,t,r){return this.raw.answerWebAppQuery({web_app_query_id:e,result:t},r)}savePreparedInlineMessage(e,t,r,a){return this.raw.savePreparedInlineMessage({user_id:e,result:t,...r},a)}sendInvoice(e,t,r,a,c,l,p,d){return this.raw.sendInvoice({chat_id:e,title:t,description:r,payload:a,currency:c,prices:l,...p},d)}createInvoiceLink(e,t,r,a,c,l,p,d){return this.raw.createInvoiceLink({title:e,description:t,payload:r,provider_token:a,currency:c,prices:l,...p},d)}answerShippingQuery(e,t,r,a){return this.raw.answerShippingQuery({shipping_query_id:e,ok:t,...r},a)}answerPreCheckoutQuery(e,t,r,a){return this.raw.answerPreCheckoutQuery({pre_checkout_query_id:e,ok:t,...r},a)}getStarTransactions(e,t){return this.raw.getStarTransactions({...e},t)}refundStarPayment(e,t,r){return this.raw.refundStarPayment({user_id:e,telegram_payment_charge_id:t},r)}editUserStarSubscription(e,t,r,a){return this.raw.editUserStarSubscription({user_id:e,telegram_payment_charge_id:t,is_canceled:r},a)}verifyUser(e,t,r){return this.raw.verifyUser({user_id:e,...t},r)}verifyChat(e,t,r){return this.raw.verifyChat({chat_id:e,...t},r)}removeUserVerification(e,t){return this.raw.removeUserVerification({user_id:e},t)}removeChatVerification(e,t){return this.raw.removeChatVerification({chat_id:e},t)}readBusinessMessage(e,t,r,a){return this.raw.readBusinessMessage({business_connection_id:e,chat_id:t,message_id:r},a)}setPassportDataErrors(e,t,r){return this.raw.setPassportDataErrors({user_id:e,errors:t},r)}sendGame(e,t,r,a){return this.raw.sendGame({chat_id:e,game_short_name:t,...r},a)}setGameScore(e,t,r,a,c,l){return this.raw.setGameScore({chat_id:e,message_id:t,user_id:r,score:a,...c},l)}setGameScoreInline(e,t,r,a,c){return this.raw.setGameScore({inline_message_id:e,user_id:t,score:r,...a},c)}getGameHighScores(e,t,r,a){return this.raw.getGameHighScores({chat_id:e,message_id:t,user_id:r},a)}getGameHighScoresInline(e,t,r){return this.raw.getGameHighScores({inline_message_id:e,user_id:t},r)}}const ge=re("grammy:bot"),ho=re("grammy:warn"),tt=re("grammy:error"),Pr=["message","edited_message","channel_post","edited_channel_post","business_connection","business_message","edited_business_message","deleted_business_messages","inline_query","chosen_inline_result","callback_query","shipping_query","pre_checkout_query","poll","poll_answer","my_chat_member","chat_join_request","chat_boost","removed_chat_boost"];class fo extends Ie{constructor(t,r){super();I(this,"token");I(this,"pollingRunning");I(this,"pollingAbortController");I(this,"lastTriedUpdateId");I(this,"api");I(this,"me");I(this,"mePromise");I(this,"clientConfig");I(this,"ContextConstructor");I(this,"observedUpdateTypes");I(this,"errorHandler");if(this.token=t,this.pollingRunning=!1,this.lastTriedUpdateId=0,this.observedUpdateTypes=new Set,this.errorHandler=async a=>{var c,l;throw console.error("Error in middleware while handling update",(l=(c=a.ctx)==null?void 0:c.update)==null?void 0:l.update_id,a.error),console.error("No error handler was set!"),console.error("Set your own error handler with `bot.catch = ...`"),this.pollingRunning&&(console.error("Stopping bot"),await this.stop()),a},!t)throw new Error("Empty token!");this.me=r==null?void 0:r.botInfo,this.clientConfig=r==null?void 0:r.client,this.ContextConstructor=(r==null?void 0:r.ContextConstructor)??ie,this.api=new Lr(t,this.clientConfig)}set botInfo(t){this.me=t}get botInfo(){if(this.me===void 0)throw new Error("Bot information unavailable! Make sure to call `await bot.init()` before accessing `bot.botInfo`!");return this.me}on(t,...r){for(const[a]of xe(t).flatMap(cr))this.observedUpdateTypes.add(a);return super.on(t,...r)}reaction(t,...r){return this.observedUpdateTypes.add("message_reaction"),super.reaction(t,...r)}isInited(){return this.me!==void 0}async init(t){if(!this.isInited()){ge("Initializing bot"),this.mePromise??(this.mePromise=Vr(()=>this.api.getMe(t),t));let r;try{r=await this.mePromise}finally{this.mePromise=void 0}this.me===void 0?this.me=r:ge("Bot info was set by now, will not overwrite")}ge(`I am ${this.me.username}!`)}async handleUpdates(t){for(const r of t){this.lastTriedUpdateId=r.update_id;try{await this.handleUpdate(r)}catch(a){if(a instanceof on)await this.errorHandler(a);else throw console.error("FATAL: grammY unable to handle:",a),a}}}async handleUpdate(t,r){if(this.me===void 0)throw new Error("Bot not initialized! Either call `await bot.init()`, or directly set the `botInfo` option in the `Bot` constructor to specify a known bot info object.");ge(`Processing update ${t.update_id}`);const a=new Lr(this.token,this.clientConfig,r),c=this.api.config.installedTransformers();c.length>0&&a.config.use(...c);const l=new this.ContextConstructor(t,a,this.me);try{await br(this.middleware(),l)}catch(p){throw tt(`Error in middleware for update ${t.update_id}`),new on(p,l)}}async start(t){var a,c,l;const r=[];if(this.isInited()||r.push(this.init((a=this.pollingAbortController)==null?void 0:a.signal)),this.pollingRunning){await Promise.all(r),ge("Simple long polling already running!");return}this.pollingRunning=!0,this.pollingAbortController=new AbortController;try{r.push(Vr(async()=>{var p;await this.api.deleteWebhook({drop_pending_updates:t==null?void 0:t.drop_pending_updates},(p=this.pollingAbortController)==null?void 0:p.signal)},(c=this.pollingAbortController)==null?void 0:c.signal)),await Promise.all(r),await((l=t==null?void 0:t.onStart)==null?void 0:l.call(t,this.botInfo))}catch(p){throw this.pollingRunning=!1,this.pollingAbortController=void 0,p}this.pollingRunning&&(mo(this.observedUpdateTypes,t==null?void 0:t.allowed_updates),this.use=po,ge("Starting simple long polling"),await this.loop(t),ge("Middleware is done running"))}async stop(){var t;if(this.pollingRunning){ge("Stopping bot, saving update offset"),this.pollingRunning=!1,(t=this.pollingAbortController)==null||t.abort();const r=this.lastTriedUpdateId+1;await this.api.getUpdates({offset:r,limit:1}).finally(()=>this.pollingAbortController=void 0)}else ge("Bot is not running!")}isRunning(){return this.pollingRunning}catch(t){this.errorHandler=t}async loop(t){const r=t==null?void 0:t.limit,a=(t==null?void 0:t.timeout)??30;let c=(t==null?void 0:t.allowed_updates)??[];try{for(;this.pollingRunning;){const l=await this.fetchUpdates({limit:r,timeout:a,allowed_updates:c});if(l===void 0)break;await this.handleUpdates(l),c=void 0}}finally{this.pollingRunning=!1}}async fetchUpdates({limit:t,timeout:r,allowed_updates:a}){var p;const c=this.lastTriedUpdateId+1;let l;do try{l=await this.api.getUpdates({offset:c,limit:t,timeout:r,allowed_updates:a},(p=this.pollingAbortController)==null?void 0:p.signal)}catch(d){await this.handlePollingError(d)}while(l===void 0&&this.pollingRunning);return l}async handlePollingError(t){if(!this.pollingRunning){ge("Pending getUpdates request cancelled");return}let r=3;if(t instanceof ln){if(tt(t.message),t.error_code===401||t.error_code===409)throw t;t.error_code===429&&(tt("Bot API server is closing."),r=t.parameters.retry_after??r)}else tt(t);tt(`Call to getUpdates failed, retrying in ${r} seconds ...`),await mn(r)}}async function Vr(s,e){let r=50;async function a(l){let p=!1,d="rethrow";if(l instanceof Ir)p=!0,d="retry";else if(l instanceof ln){if(l.error_code>=500)p=!0,d="retry";else if(l.error_code===429){const g=l.parameters.retry_after;typeof g=="number"?(await mn(g,e),r=50):p=!0,d="retry"}}if(p){r!==50&&await mn(r,e);const g=20*60*1e3;r=Math.min(g,2*r)}return d}let c={ok:!1};for(;!c.ok;)try{c={ok:!0,value:await s()}}catch(l){switch(tt(l),await a(l)){case"retry":continue;case"rethrow":throw l}}return c.value}async function mn(s,e){let t,r;function a(){r==null||r(new Error("Aborted delay")),t!==void 0&&clearTimeout(t)}try{await new Promise((c,l)=>{if(r=l,e!=null&&e.aborted){a();return}e==null||e.addEventListener("abort",a),t=setTimeout(c,1e3*s)})}finally{e==null||e.removeEventListener("abort",a)}}function mo(s,e=Pr){const t=Array.from(s).filter(r=>!e.includes(r));t.length>0&&ho(`You registered listeners for the following update types, but you did not specify them in \`allowed_updates\` so they may not be received: ${t.map(r=>`'${r}'`).join(", ")}`)}function po(){throw new Error(`It looks like you are registering more listeners on your bot from within other listeners! This means that every time your bot handles a message like this one, new listeners will be added. This list grows until your machine crashes, so grammY throws this error to tell you that you should probably do things a bit differently. If you're unsure how to resolve this problem, you can ask in the group chat: https://telegram.me/grammyjs

On the other hand, if you actually know what you're doing and you do need to install further middleware while your bot is running, consider installing a composer instance on your bot, and in turn augment the composer after the fact. This way, you can circumvent this protection against memory leaks.`)}[...Pr];const go=re("grammy:session");function yo(s={}){return s.type==="multi"?bo(s):wo(s)}function wo(s){const{initial:e,storage:t,getSessionKey:r,custom:a}=Ur(s);return async(c,l)=>{const p=new Br(t,c,"session",e),d=await r(c);await p.init(d,{custom:a,lazy:!1}),await l(),await p.finish()}}function bo(s){const e=Object.keys(s).filter(r=>r!=="type"),t=Object.fromEntries(e.map(r=>[r,Ur(s[r])]));return async(r,a)=>{r.session={};const c=await Promise.all(e.map(async l=>{const{initial:p,storage:d,getSessionKey:g,custom:v}=t[l],C=new Br(d,r.session,l,p),_=await g(r);return await C.init(_,{custom:v,lazy:!1}),C}));await a(),r.session==null&&c.forEach(l=>l.delete()),await Promise.all(c.map(l=>l.finish()))}}class Br{constructor(e,t,r,a){I(this,"storage");I(this,"obj");I(this,"prop");I(this,"initial");I(this,"key");I(this,"value");I(this,"promise");I(this,"fetching");I(this,"read");I(this,"wrote");this.storage=e,this.obj=t,this.prop=r,this.initial=a,this.fetching=!1,this.read=!1,this.wrote=!1}load(){if(this.key!==void 0&&!this.wrote)return this.promise===void 0&&(this.fetching=!0,this.promise=Promise.resolve(this.storage.read(this.key)).then(e=>{var t;return this.fetching=!1,this.wrote?this.value:e!==void 0?(this.value=e,e):(e=(t=this.initial)==null?void 0:t.call(this),e!==void 0&&(this.wrote=!0,this.value=e),e)})),this.promise}async init(e,t){this.key=e,t.lazy||await this.load(),Object.defineProperty(this.obj,this.prop,{enumerable:!0,get:()=>{if(e===void 0){const r=jr("access",t);throw new Error(r)}return this.read=!0,!t.lazy||this.wrote?this.value:(this.load(),this.fetching?this.promise:this.value)},set:r=>{if(e===void 0){const a=jr("assign",t);throw new Error(a)}this.wrote=!0,this.fetching=!1,this.value=r}})}delete(){Object.assign(this.obj,{[this.prop]:void 0})}async finish(){if(this.key!==void 0&&(this.read&&await this.load(),this.read||this.wrote)){const e=await this.value;e==null?await this.storage.delete(this.key):await this.storage.write(this.key,e)}}}function Ur(s={}){let{prefix:e="",getSessionKey:t=Wr,initial:r,storage:a}=s;return a==null&&(go("Storing session data in memory, all data will be lost when the bot restarts."),a=new vo),{initial:r,storage:a,getSessionKey:async l=>{const p=await t(l);return p===void 0?void 0:e+p},custom:t!==Wr}}function Wr(s){var e;return(e=s.chatId)==null?void 0:e.toString()}function jr(s,e){const{lazy:t=!1,custom:r}=e;return`Cannot ${s} ${t?"lazy ":""}session data because ${r?"the custom `getSessionKey` function returned undefined for this update":"this update does not belong to a chat, so the session key is undefined"}!`}class vo{constructor(e){I(this,"timeToLive");I(this,"storage");this.timeToLive=e,this.storage=new Map}read(e){const t=this.storage.get(e);if(t!==void 0){if(t.expires!==void 0&&t.expires<Date.now()){this.delete(e);return}return t.session}}readAll(){return this.readAllValues()}readAllKeys(){return Array.from(this.storage.keys())}readAllValues(){return Array.from(this.storage.keys()).map(e=>this.read(e)).filter(e=>e!==void 0)}readAllEntries(){return Array.from(this.storage.keys()).map(e=>[e,this.read(e)]).filter(e=>e[1]!==void 0)}has(e){return this.storage.has(e)}write(e,t){this.storage.set(e,Co(t,this.timeToLive))}delete(e){this.storage.delete(e)}}function Co(s,e){if(e!==void 0&&e<1/0){const t=Date.now();return{session:s,expires:t+e}}else return{session:s}}re("grammy:error");function So(s){if(Object.prototype.hasOwnProperty.call(s,"__esModule"))return s;var e=s.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(s).forEach(function(r){var a=Object.getOwnPropertyDescriptor(s,r);Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:function(){return s[r]}})}),t}var qr={},ye={exports:{}};const yt=So(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"}))),To={version:"16.5.0"};var Gr;function _o(){if(Gr)return ye.exports;Gr=1;const s=yt,e=yt,t=yt,r=yt,c=To.version,l=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/mg;function p(T){const $={};let R=T.toString();R=R.replace(/\r\n?/mg,`
`);let j;for(;(j=l.exec(R))!=null;){const Y=j[1];let P=j[2]||"";P=P.trim();const q=P[0];P=P.replace(/^(['"`])([\s\S]*)\1$/mg,"$2"),q==='"'&&(P=P.replace(/\\n/g,`
`),P=P.replace(/\\r/g,"\r")),$[Y]=P}return $}function d(T){const $=N(T),R=F.configDotenv({path:$});if(!R.parsed){const q=new Error(`MISSING_DATA: Cannot parse ${$} for an unknown reason`);throw q.code="MISSING_DATA",q}const j=C(T).split(","),Y=j.length;let P;for(let q=0;q<Y;q++)try{const Z=j[q].trim(),se=_(R,Z);P=F.decrypt(se.ciphertext,se.key);break}catch(Z){if(q+1>=Y)throw Z}return F.parse(P)}function g(T){console.log(`[dotenv@${c}][WARN] ${T}`)}function v(T){console.log(`[dotenv@${c}][DEBUG] ${T}`)}function C(T){return T&&T.DOTENV_KEY&&T.DOTENV_KEY.length>0?T.DOTENV_KEY:process.env.DOTENV_KEY&&process.env.DOTENV_KEY.length>0?process.env.DOTENV_KEY:""}function _(T,$){let R;try{R=new URL($)}catch(Z){if(Z.code==="ERR_INVALID_URL"){const se=new Error("INVALID_DOTENV_KEY: Wrong format. Must be in valid uri format like dotenv://:key_1234@dotenvx.com/vault/.env.vault?environment=development");throw se.code="INVALID_DOTENV_KEY",se}throw Z}const j=R.password;if(!j){const Z=new Error("INVALID_DOTENV_KEY: Missing key part");throw Z.code="INVALID_DOTENV_KEY",Z}const Y=R.searchParams.get("environment");if(!Y){const Z=new Error("INVALID_DOTENV_KEY: Missing environment part");throw Z.code="INVALID_DOTENV_KEY",Z}const P=`DOTENV_VAULT_${Y.toUpperCase()}`,q=T.parsed[P];if(!q){const Z=new Error(`NOT_FOUND_DOTENV_ENVIRONMENT: Cannot locate environment ${P} in your .env.vault file.`);throw Z.code="NOT_FOUND_DOTENV_ENVIRONMENT",Z}return{ciphertext:q,key:j}}function N(T){let $=null;if(T&&T.path&&T.path.length>0)if(Array.isArray(T.path))for(const R of T.path)s.existsSync(R)&&($=R.endsWith(".vault")?R:`${R}.vault`);else $=T.path.endsWith(".vault")?T.path:`${T.path}.vault`;else $=e.resolve(process.cwd(),".env.vault");return s.existsSync($)?$:null}function E(T){return T[0]==="~"?e.join(t.homedir(),T.slice(1)):T}function k(T){!!(T&&T.debug)&&v("Loading env from encrypted .env.vault");const R=F._parseVault(T);let j=process.env;return T&&T.processEnv!=null&&(j=T.processEnv),F.populate(j,R,T),{parsed:R}}function L(T){const $=e.resolve(process.cwd(),".env");let R="utf8";const j=!!(T&&T.debug);T&&T.encoding?R=T.encoding:j&&v("No encoding is specified. UTF-8 is used by default");let Y=[$];if(T&&T.path)if(!Array.isArray(T.path))Y=[E(T.path)];else{Y=[];for(const se of T.path)Y.push(E(se))}let P;const q={};for(const se of Y)try{const Ee=F.parse(s.readFileSync(se,{encoding:R}));F.populate(q,Ee,T)}catch(Ee){j&&v(`Failed to load ${se} ${Ee.message}`),P=Ee}let Z=process.env;return T&&T.processEnv!=null&&(Z=T.processEnv),F.populate(Z,q,T),P?{parsed:q,error:P}:{parsed:q}}function x(T){if(C(T).length===0)return F.configDotenv(T);const $=N(T);return $?F._configVault(T):(g(`You set DOTENV_KEY but you are missing a .env.vault file at ${$}. Did you forget to build it?`),F.configDotenv(T))}function J(T,$){const R=Buffer.from($.slice(-64),"hex");let j=Buffer.from(T,"base64");const Y=j.subarray(0,12),P=j.subarray(-16);j=j.subarray(12,-16);try{const q=r.createDecipheriv("aes-256-gcm",R,Y);return q.setAuthTag(P),`${q.update(j)}${q.final()}`}catch(q){const Z=q instanceof RangeError,se=q.message==="Invalid key length",Ee=q.message==="Unsupported state or unable to authenticate data";if(Z||se){const Ae=new Error("INVALID_DOTENV_KEY: It must be 64 characters long (or more)");throw Ae.code="INVALID_DOTENV_KEY",Ae}else if(Ee){const Ae=new Error("DECRYPTION_FAILED: Please check your DOTENV_KEY");throw Ae.code="DECRYPTION_FAILED",Ae}else throw q}}function ee(T,$,R={}){const j=!!(R&&R.debug),Y=!!(R&&R.override);if(typeof $!="object"){const P=new Error("OBJECT_REQUIRED: Please check the processEnv argument being passed to populate");throw P.code="OBJECT_REQUIRED",P}for(const P of Object.keys($))Object.prototype.hasOwnProperty.call(T,P)?(Y===!0&&(T[P]=$[P]),j&&v(Y===!0?`"${P}" is already defined and WAS overwritten`:`"${P}" is already defined and was NOT overwritten`)):T[P]=$[P]}const F={configDotenv:L,_configVault:k,_parseVault:d,config:x,decrypt:J,parse:p,populate:ee};return ye.exports.configDotenv=F.configDotenv,ye.exports._configVault=F._configVault,ye.exports._parseVault=F._parseVault,ye.exports.config=F.config,ye.exports.decrypt=F.decrypt,ye.exports.parse=F.parse,ye.exports.populate=F.populate,ye.exports=F,ye.exports}var pn,Hr;function Eo(){if(Hr)return pn;Hr=1;const s={};return process.env.DOTENV_CONFIG_ENCODING!=null&&(s.encoding=process.env.DOTENV_CONFIG_ENCODING),process.env.DOTENV_CONFIG_PATH!=null&&(s.path=process.env.DOTENV_CONFIG_PATH),process.env.DOTENV_CONFIG_DEBUG!=null&&(s.debug=process.env.DOTENV_CONFIG_DEBUG),process.env.DOTENV_CONFIG_OVERRIDE!=null&&(s.override=process.env.DOTENV_CONFIG_OVERRIDE),process.env.DOTENV_CONFIG_DOTENV_KEY!=null&&(s.DOTENV_KEY=process.env.DOTENV_CONFIG_DOTENV_KEY),pn=s,pn}var gn,zr;function Io(){if(zr)return gn;zr=1;const s=/^dotenv_config_(encoding|path|debug|override|DOTENV_KEY)=(.+)$/;return gn=function(t){return t.reduce(function(r,a){const c=a.match(s);return c&&(r[c[1]]=c[2]),r},{})},gn}var Yr;function ko(){return Yr||(Yr=1,function(){_o().config(Object.assign({},Eo(),Io()(process.argv)))}()),qr}ko();async function Zr(s){let e=new FormData;if(s.document instanceof Buffer){const t=new Blob([s.document],{type:s.contentType});e.append("document",t,s.documentName)}else if(s.document instanceof File)e.append("document",s.document,s.documentName);else if(s.document instanceof FormData)e=s.document;else if(s.document instanceof ReadableStream){const t=[],r=s.document.getReader();for(;;){const{done:c,value:l}=await r.read();if(c)break;t.push(l)}const a=new Blob(t,{type:s.contentType});e.append("document",a,s.documentName)}return e.append("documentName",s.documentName),e}var Mo=["/v1/pipes/run","/beta/chat","/beta/generate","/v1/agent/run"],we=class or extends Error{constructor(e,t,r,a){super(or.makeMessage(e,t,r)),this.status=e,this.headers=a,this.request_id=a==null?void 0:a["lb-request-id"];const c=t;this.error=c,this.code=c==null?void 0:c.code,this.status=c==null?void 0:c.status}static makeMessage(e,t,r){const a=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&a?`${e} ${a}`:e?`${e} status code (no body)`:a||"(no status code or body)"}static generate(e,t,r,a){if(!e)return new Kr({cause:t instanceof Error?t:void 0});const c=t==null?void 0:t.error;switch(e){case 400:return new Oo(e,c,r,a);case 401:return new Do(e,c,r,a);case 403:return new Ao(e,c,r,a);case 404:return new No(e,c,r,a);case 409:return new Fo(e,c,r,a);case 422:return new Ro(e,c,r,a);case 429:return new $o(e,c,r,a);default:return e>=500?new xo(e,c,r,a):new or(e,c,r,a)}}},Kr=class extends we{constructor({message:s,cause:e}){super(void 0,void 0,s||"Connection error.",void 0),this.status=void 0,e&&(this.cause=e)}},Oo=class extends we{constructor(){super(...arguments),this.status=400}},Do=class extends we{constructor(){super(...arguments),this.status=401}},Ao=class extends we{constructor(){super(...arguments),this.status=403}},No=class extends we{constructor(){super(...arguments),this.status=404}},Fo=class extends we{constructor(){super(...arguments),this.status=409}},Ro=class extends we{constructor(){super(...arguments),this.status=422}},$o=class extends we{constructor(){super(...arguments),this.status=429}},xo=class extends we{},Qr=class $t{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let r=!1;async function*a(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let c=!1;try{for await(const l of Lo(e,t))if(!c){if(l.data.startsWith("[DONE]")){c=!0;continue}if(l.event===null){let p;try{p=JSON.parse(l.data)}catch(d){throw console.error("Could not parse message into JSON:",l.data),console.error("From chunk:",l.raw),d}if(p&&p.error)throw new Error(p.error);yield p}else{let p;try{p=JSON.parse(l.data)}catch(d){throw console.error("Could not parse message into JSON:",l.data),console.error("From chunk:",l.raw),d}if(l.event=="error")throw new Error(p.message);yield{event:l.event,data:p}}}c=!0}catch(l){if(l instanceof Error&&l.name==="AbortError")return;throw l}finally{c||t.abort()}}return new $t(a,t)}static fromReadableStream(e,t){let r=!1;async function*a(){const l=new Jr,p=Xr(e);for await(const d of p)for(const g of l.decode(d))yield g;for(const d of l.flush())yield d}async function*c(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let l=!1;try{for await(const p of a())l||p&&(yield JSON.parse(p));l=!0}catch(p){if(p instanceof Error&&p.name==="AbortError")return;throw p}finally{l||t.abort()}}return new $t(c,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],r=this.iterator(),a=c=>({next:()=>{if(c.length===0){const l=r.next();e.push(l),t.push(l)}return c.shift()}});return[new $t(()=>a(e),this.controller),new $t(()=>a(t),this.controller)]}toReadableStream(){const e=this;let t;const r=new TextEncoder;return new ReadableStream({async start(){t=e[Symbol.asyncIterator]()},async pull(a){try{const{value:c,done:l}=await t.next();if(l)return a.close();const p=r.encode(JSON.stringify(c)+`
`);a.enqueue(p)}catch(c){a.error(c)}},async cancel(){var a;await((a=t.return)==null?void 0:a.call(t))}})}};async function*Lo(s,e){if(!s.body)throw e.abort(),new Error("Attempted to iterate over a response with no body");const t=new Bo,r=new Jr,a=Xr(s.body);for await(const c of Po(a))for(const l of r.decode(c)){const p=t.decode(l);p&&(yield p)}for(const c of r.flush()){const l=t.decode(c);l&&(yield l)}}async function*Po(s){let e=new Uint8Array;for await(const t of s){if(t==null)continue;const r=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let a=new Uint8Array(e.length+r.length);a.set(e),a.set(r,e.length),e=a;let c;for(;(c=Vo(e))!==-1;)yield e.slice(0,c),e=e.slice(c)}e.length>0&&(yield e)}function Vo(s){for(let r=0;r<s.length-2;r++){if(s[r]===10&&s[r+1]===10||s[r]===13&&s[r+1]===13)return r+2;if(s[r]===13&&s[r+1]===10&&r+3<s.length&&s[r+2]===13&&s[r+3]===10)return r+4}return-1}var Bo=class{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(s){if(s.endsWith("\r")&&(s=s.substring(0,s.length-1)),!s){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(s),s.startsWith(":"))return null;let[e,t,r]=Uo(s,":");return r.startsWith(" ")&&(r=r.substring(1)),e==="event"?this.event=r:e==="data"&&this.data.push(r),null}},yn=class ur{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];const r=ur.NEWLINE_CHARS.has(t[t.length-1]||"");let a=t.split(ur.NEWLINE_REGEXP);return r&&a.pop(),a.length===1&&!r?(this.buffer.push(a[0]),[]):(this.buffer.length>0&&(a=[this.buffer.join("")+a[0],...a.slice(1)],this.buffer=[]),r||(this.buffer=[a.pop()||""]),a)}decodeText(e){var t;if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new Error(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return(t=this.textDecoder)!=null||(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new Error(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new Error("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}};yn.NEWLINE_CHARS=new Set([`
`,"\r"]),yn.NEWLINE_REGEXP=/\r\n|[\n\r]/g;var Jr=yn;function Uo(s,e){const t=s.indexOf(e);return t!==-1?[s.substring(0,t),e,s.substring(t+e.length)]:[s,"",""]}function Xr(s){if(s[Symbol.asyncIterator])return s;const e=s.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}var es=class{constructor(s){this.config=s}async send({endpoint:s,...e}){var t,r,a,c,l;const p=this.buildUrl({endpoint:s}),d=this.buildHeaders({headers:e.headers});let g;try{g=await this.makeRequest({url:p,options:e,headers:d})}catch(C){throw new Kr({cause:C instanceof Error?C:void 0})}if(g.ok||await this.handleErrorResponse({response:g}),Mo.includes(s)){const C=g.headers.get("lb-thread-id");return e.body?(a=e.body)!=null&&a.stream&&p.includes("run")?this.handleRunResponseStream({response:g,rawResponse:e.body.rawResponse}):e.body.stream?this.handleStreamResponse({response:g}):this.handleRunResponse({response:g,threadId:C,rawResponse:(l=(c=e.body)==null?void 0:c.rawResponse)!=null?l:!1,endpoint:s}):this.handleRunResponse({response:g,threadId:null,rawResponse:(r=(t=e.body)==null?void 0:t.rawResponse)!=null?r:!1,endpoint:s})}else return g.json()}buildUrl({endpoint:s}){return`${this.config.baseUrl}${s}`}buildHeaders({headers:s}){return{"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`,...s}}async makeRequest({url:s,options:e,headers:t}){return fetch(s,{method:e.method,headers:t,body:JSON.stringify(e.body)})}async handleErrorResponse({response:s}){let e;try{e=await s.json()}catch{e=await s.text()}throw we.generate(s.status,e,s.statusText,s.headers)}handleStreamResponse({response:s}){const e=new AbortController;return{stream:Qr.fromSSEResponse(s,e),threadId:s.headers.get("lb-thread-id")}}handleRunResponseStream({response:s,rawResponse:e}){const t=new AbortController,c={stream:Qr.fromSSEResponse(s,t).toReadableStream(),threadId:s.headers.get("lb-thread-id")};return e&&(c.rawResponse={headers:Object.fromEntries(s.headers.entries())}),c}async handleRunResponse({response:s,threadId:e,rawResponse:t,endpoint:r}){let a=!1;r==="/v1/agent/run"&&(a=!0);const c=await s.json(),p={...c.raw?a?{output:c.output,...c.raw}:{completion:c.completion,...c.raw}:c};return e&&(p.threadId=e),t&&(p.rawResponse={headers:Object.fromEntries(s.headers.entries())}),p}async post(s){return this.send({...s,method:"POST"})}async get(s){return this.send({...s,method:"GET"})}async put(s){return this.send({...s,method:"PUT"})}async delete(s){return this.send({...s,method:"DELETE"})}},Wo=class{constructor(s){var e,t;this.baseUrl=(e=s==null?void 0:s.baseUrl)!=null?e:"https://api.langbase.com",this.apiKey=(t=s==null?void 0:s.apiKey)!=null?t:"",this.request=new es({apiKey:this.apiKey,baseUrl:this.baseUrl}),this.pipe={list:this.listPipe.bind(this),create:this.createPipe.bind(this),update:this.updatePipe.bind(this),run:this.runPipe.bind(this)},this.pipes={list:this.listPipe.bind(this),create:this.createPipe.bind(this),update:this.updatePipe.bind(this),run:this.runPipe.bind(this)},this.memory={create:this.createMemory.bind(this),delete:this.deleteMemory.bind(this),retrieve:this.retrieveMemory.bind(this),list:this.listMemory.bind(this),documents:{list:this.listDocs.bind(this),delete:this.deleteDoc.bind(this),upload:this.uploadDocs.bind(this),embedding:{retry:this.retryDocEmbed.bind(this)}}},this.memories={create:this.createMemory.bind(this),delete:this.deleteMemory.bind(this),retrieve:this.retrieveMemory.bind(this),list:this.listMemory.bind(this),documents:{list:this.listDocs.bind(this),delete:this.deleteDoc.bind(this),upload:this.uploadDocs.bind(this),embeddings:{retry:this.retryDocEmbed.bind(this)}}},this.tools={crawl:this.webCrawl.bind(this),webSearch:this.webSearch.bind(this)},this.tool={crawl:this.webCrawl.bind(this),webSearch:this.webSearch.bind(this)},this.embed=this.generateEmbeddings.bind(this),this.chunk=this.chunkDocument.bind(this),this.parse=this.parseDocument.bind(this),this.threads={create:this.createThread.bind(this),update:this.updateThread.bind(this),get:this.getThread.bind(this),delete:this.deleteThread.bind(this),append:this.appendThreadMessages.bind(this),messages:{list:this.listThreadMessages.bind(this)}},this.agent={run:this.runAgent.bind(this)}}async runPipe(s){var e;if(!((e=s.name)!=null&&e.trim())&&!s.apiKey)throw new Error("Pipe name or Pipe API key is required to run the pipe.");return typeof s.stream>"u"&&delete s.stream,s.apiKey&&(this.request=new es({apiKey:s.apiKey,baseUrl:this.baseUrl})),this.request.post({endpoint:"/v1/pipes/run",body:s,headers:{...s.llmKey&&{"LB-LLM-KEY":s.llmKey}}})}async createPipe(s){return this.request.post({endpoint:"/v1/pipes",body:s})}async updatePipe(s){return this.request.post({endpoint:`/v1/pipes/${s.name}`,body:s})}async listPipe(){return this.request.get({endpoint:"/v1/pipes"})}async createMemory(s){return this.request.post({endpoint:"/v1/memory",body:s})}async listMemory(){return this.request.get({endpoint:"/v1/memory"})}async deleteMemory(s){return this.request.delete({endpoint:`/v1/memory/${s.name}`})}async retrieveMemory(s){return this.request.post({endpoint:"/v1/memory/retrieve",body:s})}async listDocs(s){return this.request.get({endpoint:`/v1/memory/${s.memoryName}/documents`})}async deleteDoc(s){return this.request.delete({endpoint:`/v1/memory/${s.memoryName}/documents/${s.documentName}`})}async uploadDocs(s){try{const t=(await this.request.post({endpoint:"/v1/memory/documents",body:{memoryName:s.memoryName,fileName:s.documentName,meta:s.meta}})).signedUrl;return await fetch(t,{method:"PUT",headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":s.contentType},body:s.document})}catch(e){throw e}}async retryDocEmbed(s){return this.request.get({endpoint:`/v1/memory/${s.memoryName}/documents/${s.documentName}/embeddings/retry`})}async webSearch(s){const e=s.apiKey?s.apiKey:null;return e&&delete s.apiKey,this.request.post({endpoint:"/v1/tools/web-search",body:s,headers:{...e&&{"LB-WEB-SEARCH-KEY":e}}})}async webCrawl(s){const e=s.apiKey?s.apiKey:null;return e&&delete s.apiKey,this.request.post({endpoint:"/v1/tools/crawl",body:s,headers:{...e&&{"LB-CRAWL-KEY":e}}})}async generateEmbeddings(s){return this.request.post({endpoint:"/v1/embed",body:s})}async chunkDocument(s){const e=await Zr({document:s.document,documentName:s.documentName,contentType:s.contentType});return s.chunkMaxLength&&e.append("chunkMaxLength",s.chunkMaxLength),s.chunkOverlap&&e.append("chunkOverlap",s.chunkOverlap),(await fetch(`${this.baseUrl}/v1/chunk`,{method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`},body:e})).json()}async parseDocument(s){const e=await Zr({document:s.document,documentName:s.documentName,contentType:s.contentType});return(await fetch(`${this.baseUrl}/v1/parse`,{method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`},body:e})).json()}async createThread(s){return this.request.post({endpoint:"/v1/threads",body:s})}async updateThread(s){return this.request.post({endpoint:`/v1/threads/${s.threadId}`,body:s})}async getThread(s){return this.request.get({endpoint:`/v1/threads/${s.threadId}`})}async deleteThread(s){return this.request.delete({endpoint:`/v1/threads/${s.threadId}`})}async appendThreadMessages(s){return this.request.post({endpoint:`/v1/threads/${s.threadId}/messages`,body:s.messages})}async listThreadMessages(s){return this.request.get({endpoint:`/v1/threads/${s.threadId}/messages`})}async runAgent(s){if(!s.apiKey)throw new Error("LLM API key is required to run this LLM.");return typeof s.stream>"u"&&delete s.stream,this.request.post({endpoint:"/v1/agent/run",body:s,headers:{...s.apiKey&&{"LB-LLM-Key":s.apiKey}}})}};const ts=new Wo({apiKey:process.env.LANGBASE_API_KEY});async function jo({chunks:s,query:e}){const t=await qo(s),{completion:r}=await ts.pipes.run({stream:!1,name:"ai-support-agent",messages:[{role:"system",content:t},{role:"user",content:e}]});return r}async function qo(s){let e="";for(const r of s)e+=r.text+`
`;return`
    You're a helpful AI assistant.
    You will assist users with their queries.

    Always ensure that you provide accurate and to the point information.
    Below is some CONTEXT for you to answer the questions. ONLY answer from the CONTEXT. CONTEXT consists of multiple information chunks. Each chunk has a source mentioned at the end.

For each piece of response you provide, cite the source in brackets like so: [1].

At the end of the answer, always list each source with its corresponding number and provide the document name. like so [1] Filename.doc. If there is a URL, make it hyperlink on the name.

 If you don't know the answer, say so. Ask for more context if needed.
    ${e}`}async function Go(s){return await ts.memories.retrieve({query:s,topK:4,memory:[{name:"knowledge-base"}]})}var wn={},wt={},ae={},ns;function Ho(){if(ns)return ae;ns=1,Object.defineProperty(ae,"__esModule",{value:!0});class s extends Error{}class e extends s{constructor(n){super(`Invalid DateTime: ${n.toMessage()}`)}}class t extends s{constructor(n){super(`Invalid Interval: ${n.toMessage()}`)}}class r extends s{constructor(n){super(`Invalid Duration: ${n.toMessage()}`)}}class a extends s{}class c extends s{constructor(n){super(`Invalid unit ${n}`)}}class l extends s{}class p extends s{constructor(){super("Zone is an abstract class")}}const d="numeric",g="short",v="long",C={year:d,month:d,day:d},_={year:d,month:g,day:d},N={year:d,month:g,day:d,weekday:g},E={year:d,month:v,day:d},k={year:d,month:v,day:d,weekday:v},L={hour:d,minute:d},x={hour:d,minute:d,second:d},J={hour:d,minute:d,second:d,timeZoneName:g},ee={hour:d,minute:d,second:d,timeZoneName:v},F={hour:d,minute:d,hourCycle:"h23"},T={hour:d,minute:d,second:d,hourCycle:"h23"},$={hour:d,minute:d,second:d,hourCycle:"h23",timeZoneName:g},R={hour:d,minute:d,second:d,hourCycle:"h23",timeZoneName:v},j={year:d,month:d,day:d,hour:d,minute:d},Y={year:d,month:d,day:d,hour:d,minute:d,second:d},P={year:d,month:g,day:d,hour:d,minute:d},q={year:d,month:g,day:d,hour:d,minute:d,second:d},Z={year:d,month:g,day:d,weekday:g,hour:d,minute:d},se={year:d,month:v,day:d,hour:d,minute:d,timeZoneName:g},Ee={year:d,month:v,day:d,hour:d,minute:d,second:d,timeZoneName:g},Ae={year:d,month:v,day:d,weekday:v,hour:d,minute:d,timeZoneName:v},Os={year:d,month:v,day:d,weekday:v,hour:d,minute:d,second:d,timeZoneName:v};class nt{get type(){throw new p}get name(){throw new p}get ianaName(){return this.name}get isUniversal(){throw new p}offsetName(n,i){throw new p}formatOffset(n,i){throw new p}offset(n){throw new p}equals(n){throw new p}get isValid(){throw new p}}let Fn=null;class Ct extends nt{static get instance(){return Fn===null&&(Fn=new Ct),Fn}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(n,{format:i,locale:u}){return ni(n,i,u)}formatOffset(n,i){return Et(this.offset(n),i)}offset(n){return-new Date(n).getTimezoneOffset()}equals(n){return n.type==="system"}get isValid(){return!0}}const Rn=new Map;function Dc(o){let n=Rn.get(o);return n===void 0&&(n=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:o,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"}),Rn.set(o,n)),n}const Ac={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function Nc(o,n){const i=o.format(n).replace(/\u200E/g,""),u=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(i),[,h,f,m,y,b,S,M]=u;return[m,h,f,y,b,S,M]}function Fc(o,n){const i=o.formatToParts(n),u=[];for(let h=0;h<i.length;h++){const{type:f,value:m}=i[h],y=Ac[f];f==="era"?u[y]=m:O(y)||(u[y]=parseInt(m,10))}return u}const $n=new Map;class be extends nt{static create(n){let i=$n.get(n);return i===void 0&&$n.set(n,i=new be(n)),i}static resetCache(){$n.clear(),Rn.clear()}static isValidSpecifier(n){return this.isValidZone(n)}static isValidZone(n){if(!n)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:n}).format(),!0}catch{return!1}}constructor(n){super(),this.zoneName=n,this.valid=be.isValidZone(n)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(n,{format:i,locale:u}){return ni(n,i,u,this.name)}formatOffset(n,i){return Et(this.offset(n),i)}offset(n){if(!this.valid)return NaN;const i=new Date(n);if(isNaN(i))return NaN;const u=Dc(this.name);let[h,f,m,y,b,S,M]=u.formatToParts?Fc(u,i):Nc(u,i);y==="BC"&&(h=-Math.abs(h)+1);const K=Yt({year:h,month:f,day:m,hour:b===24?0:b,minute:S,second:M,millisecond:0});let A=+i;const X=A%1e3;return A-=X>=0?X:1e3+X,(K-A)/(60*1e3)}equals(n){return n.type==="iana"&&n.name===this.name}get isValid(){return this.valid}}let Ds={};function Rc(o,n={}){const i=JSON.stringify([o,n]);let u=Ds[i];return u||(u=new Intl.ListFormat(o,n),Ds[i]=u),u}const xn=new Map;function Ln(o,n={}){const i=JSON.stringify([o,n]);let u=xn.get(i);return u===void 0&&(u=new Intl.DateTimeFormat(o,n),xn.set(i,u)),u}const Pn=new Map;function $c(o,n={}){const i=JSON.stringify([o,n]);let u=Pn.get(i);return u===void 0&&(u=new Intl.NumberFormat(o,n),Pn.set(i,u)),u}const Vn=new Map;function xc(o,n={}){const{base:i,...u}=n,h=JSON.stringify([o,u]);let f=Vn.get(h);return f===void 0&&(f=new Intl.RelativeTimeFormat(o,n),Vn.set(h,f)),f}let St=null;function Lc(){return St||(St=new Intl.DateTimeFormat().resolvedOptions().locale,St)}const Bn=new Map;function As(o){let n=Bn.get(o);return n===void 0&&(n=new Intl.DateTimeFormat(o).resolvedOptions(),Bn.set(o,n)),n}const Un=new Map;function Pc(o){let n=Un.get(o);if(!n){const i=new Intl.Locale(o);n="getWeekInfo"in i?i.getWeekInfo():i.weekInfo,"minimalDays"in n||(n={...Ns,...n}),Un.set(o,n)}return n}function Vc(o){const n=o.indexOf("-x-");n!==-1&&(o=o.substring(0,n));const i=o.indexOf("-u-");if(i===-1)return[o];{let u,h;try{u=Ln(o).resolvedOptions(),h=o}catch{const b=o.substring(0,i);u=Ln(b).resolvedOptions(),h=b}const{numberingSystem:f,calendar:m}=u;return[h,f,m]}}function Bc(o,n,i){return(i||n)&&(o.includes("-u-")||(o+="-u"),i&&(o+=`-ca-${i}`),n&&(o+=`-nu-${n}`)),o}function Uc(o){const n=[];for(let i=1;i<=12;i++){const u=D.utc(2009,i,1);n.push(o(u))}return n}function Wc(o){const n=[];for(let i=1;i<=7;i++){const u=D.utc(2016,11,13+i);n.push(o(u))}return n}function qt(o,n,i,u){const h=o.listingMode();return h==="error"?null:h==="en"?i(n):u(n)}function jc(o){return o.numberingSystem&&o.numberingSystem!=="latn"?!1:o.numberingSystem==="latn"||!o.locale||o.locale.startsWith("en")||As(o.locale).numberingSystem==="latn"}class qc{constructor(n,i,u){this.padTo=u.padTo||0,this.floor=u.floor||!1;const{padTo:h,floor:f,...m}=u;if(!i||Object.keys(m).length>0){const y={useGrouping:!1,...u};u.padTo>0&&(y.minimumIntegerDigits=u.padTo),this.inf=$c(n,y)}}format(n){if(this.inf){const i=this.floor?Math.floor(n):n;return this.inf.format(i)}else{const i=this.floor?Math.floor(n):Kn(n,3);return Q(i,this.padTo)}}}class Gc{constructor(n,i,u){this.opts=u,this.originalZone=void 0;let h;if(this.opts.timeZone)this.dt=n;else if(n.zone.type==="fixed"){const m=-1*(n.offset/60),y=m>=0?`Etc/GMT+${m}`:`Etc/GMT${m}`;n.offset!==0&&be.create(y).valid?(h=y,this.dt=n):(h="UTC",this.dt=n.offset===0?n:n.setZone("UTC").plus({minutes:n.offset}),this.originalZone=n.zone)}else n.zone.type==="system"?this.dt=n:n.zone.type==="iana"?(this.dt=n,h=n.zone.name):(h="UTC",this.dt=n.setZone("UTC").plus({minutes:n.offset}),this.originalZone=n.zone);const f={...this.opts};f.timeZone=f.timeZone||h,this.dtf=Ln(i,f)}format(){return this.originalZone?this.formatToParts().map(({value:n})=>n).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const n=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?n.map(i=>{if(i.type==="timeZoneName"){const u=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...i,value:u}}else return i}):n}resolvedOptions(){return this.dtf.resolvedOptions()}}class Hc{constructor(n,i,u){this.opts={style:"long",...u},!i&&Js()&&(this.rtf=xc(n,u))}format(n,i){return this.rtf?this.rtf.format(n,i):fl(i,n,this.opts.numeric,this.opts.style!=="long")}formatToParts(n,i){return this.rtf?this.rtf.formatToParts(n,i):[]}}const Ns={firstDay:1,minimalDays:4,weekend:[6,7]};class W{static fromOpts(n){return W.create(n.locale,n.numberingSystem,n.outputCalendar,n.weekSettings,n.defaultToEN)}static create(n,i,u,h,f=!1){const m=n||H.defaultLocale,y=m||(f?"en-US":Lc()),b=i||H.defaultNumberingSystem,S=u||H.defaultOutputCalendar,M=Yn(h)||H.defaultWeekSettings;return new W(y,b,S,M,m)}static resetCache(){St=null,xn.clear(),Pn.clear(),Vn.clear(),Bn.clear(),Un.clear()}static fromObject({locale:n,numberingSystem:i,outputCalendar:u,weekSettings:h}={}){return W.create(n,i,u,h)}constructor(n,i,u,h,f){const[m,y,b]=Vc(n);this.locale=m,this.numberingSystem=i||y||null,this.outputCalendar=u||b||null,this.weekSettings=h,this.intl=Bc(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=f,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=jc(this)),this.fastNumbersCached}listingMode(){const n=this.isEnglish(),i=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return n&&i?"en":"intl"}clone(n){return!n||Object.getOwnPropertyNames(n).length===0?this:W.create(n.locale||this.specifiedLocale,n.numberingSystem||this.numberingSystem,n.outputCalendar||this.outputCalendar,Yn(n.weekSettings)||this.weekSettings,n.defaultToEN||!1)}redefaultToEN(n={}){return this.clone({...n,defaultToEN:!0})}redefaultToSystem(n={}){return this.clone({...n,defaultToEN:!1})}months(n,i=!1){return qt(this,n,ii,()=>{const u=i?{month:n,day:"numeric"}:{month:n},h=i?"format":"standalone";return this.monthsCache[h][n]||(this.monthsCache[h][n]=Uc(f=>this.extract(f,u,"month"))),this.monthsCache[h][n]})}weekdays(n,i=!1){return qt(this,n,ui,()=>{const u=i?{weekday:n,year:"numeric",month:"long",day:"numeric"}:{weekday:n},h=i?"format":"standalone";return this.weekdaysCache[h][n]||(this.weekdaysCache[h][n]=Wc(f=>this.extract(f,u,"weekday"))),this.weekdaysCache[h][n]})}meridiems(){return qt(this,void 0,()=>ci,()=>{if(!this.meridiemCache){const n={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[D.utc(2016,11,13,9),D.utc(2016,11,13,19)].map(i=>this.extract(i,n,"dayperiod"))}return this.meridiemCache})}eras(n){return qt(this,n,li,()=>{const i={era:n};return this.eraCache[n]||(this.eraCache[n]=[D.utc(-40,1,1),D.utc(2017,1,1)].map(u=>this.extract(u,i,"era"))),this.eraCache[n]})}extract(n,i,u){const h=this.dtFormatter(n,i),f=h.formatToParts(),m=f.find(y=>y.type.toLowerCase()===u);return m?m.value:null}numberFormatter(n={}){return new qc(this.intl,n.forceSimple||this.fastNumbers,n)}dtFormatter(n,i={}){return new Gc(n,this.intl,i)}relFormatter(n={}){return new Hc(this.intl,this.isEnglish(),n)}listFormatter(n={}){return Rc(this.intl,n)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||As(this.intl).locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:Xs()?Pc(this.locale):Ns}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(n){return this.locale===n.locale&&this.numberingSystem===n.numberingSystem&&this.outputCalendar===n.outputCalendar}toString(){return`Locale(${this.locale}, ${this.numberingSystem}, ${this.outputCalendar})`}}let Wn=null;class te extends nt{static get utcInstance(){return Wn===null&&(Wn=new te(0)),Wn}static instance(n){return n===0?te.utcInstance:new te(n)}static parseSpecifier(n){if(n){const i=n.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(i)return new te(Zt(i[1],i[2]))}return null}constructor(n){super(),this.fixed=n}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${Et(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${Et(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(n,i){return Et(this.fixed,i)}get isUniversal(){return!0}offset(){return this.fixed}equals(n){return n.type==="fixed"&&n.fixed===this.fixed}get isValid(){return!0}}class Fs extends nt{constructor(n){super(),this.zoneName=n}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function Ne(o,n){if(O(o)||o===null)return n;if(o instanceof nt)return o;if(Jc(o)){const i=o.toLowerCase();return i==="default"?n:i==="local"||i==="system"?Ct.instance:i==="utc"||i==="gmt"?te.utcInstance:te.parseSpecifier(i)||be.create(o)}else return Fe(o)?te.instance(o):typeof o=="object"&&"offset"in o&&typeof o.offset=="function"?o:new Fs(o)}const jn={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"},Rs={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},zc=jn.hanidec.replace(/[\[|\]]/g,"").split("");function Yc(o){let n=parseInt(o,10);if(isNaN(n)){n="";for(let i=0;i<o.length;i++){const u=o.charCodeAt(i);if(o[i].search(jn.hanidec)!==-1)n+=zc.indexOf(o[i]);else for(const h in Rs){const[f,m]=Rs[h];u>=f&&u<=m&&(n+=u-f)}}return parseInt(n,10)}else return n}const qn=new Map;function Zc(){qn.clear()}function de({numberingSystem:o},n=""){const i=o||"latn";let u=qn.get(i);u===void 0&&(u=new Map,qn.set(i,u));let h=u.get(n);return h===void 0&&(h=new RegExp(`${jn[i]}${n}`),u.set(n,h)),h}let $s=()=>Date.now(),xs="system",Ls=null,Ps=null,Vs=null,Bs=60,Us,Ws=null;class H{static get now(){return $s}static set now(n){$s=n}static set defaultZone(n){xs=n}static get defaultZone(){return Ne(xs,Ct.instance)}static get defaultLocale(){return Ls}static set defaultLocale(n){Ls=n}static get defaultNumberingSystem(){return Ps}static set defaultNumberingSystem(n){Ps=n}static get defaultOutputCalendar(){return Vs}static set defaultOutputCalendar(n){Vs=n}static get defaultWeekSettings(){return Ws}static set defaultWeekSettings(n){Ws=Yn(n)}static get twoDigitCutoffYear(){return Bs}static set twoDigitCutoffYear(n){Bs=n%100}static get throwOnInvalid(){return Us}static set throwOnInvalid(n){Us=n}static resetCaches(){W.resetCache(),be.resetCache(),D.resetCache(),Zc()}}class fe{constructor(n,i){this.reason=n,this.explanation=i}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const js=[0,31,59,90,120,151,181,212,243,273,304,334],qs=[0,31,60,91,121,152,182,213,244,274,305,335];function ue(o,n){return new fe("unit out of range",`you specified ${n} (of type ${typeof n}) as a ${o}, which is invalid`)}function Gn(o,n,i){const u=new Date(Date.UTC(o,n-1,i));o<100&&o>=0&&u.setUTCFullYear(u.getUTCFullYear()-1900);const h=u.getUTCDay();return h===0?7:h}function Gs(o,n,i){return i+(Tt(o)?qs:js)[n-1]}function Hs(o,n){const i=Tt(o)?qs:js,u=i.findIndex(f=>f<n),h=n-i[u];return{month:u+1,day:h}}function Hn(o,n){return(o-n+7)%7+1}function Gt(o,n=4,i=1){const{year:u,month:h,day:f}=o,m=Gs(u,h,f),y=Hn(Gn(u,h,f),i);let b=Math.floor((m-y+14-n)/7),S;return b<1?(S=u-1,b=_t(S,n,i)):b>_t(u,n,i)?(S=u+1,b=1):S=u,{weekYear:S,weekNumber:b,weekday:y,...Qt(o)}}function zs(o,n=4,i=1){const{weekYear:u,weekNumber:h,weekday:f}=o,m=Hn(Gn(u,1,n),i),y=st(u);let b=h*7+f-m-7+n,S;b<1?(S=u-1,b+=st(S)):b>y?(S=u+1,b-=st(u)):S=u;const{month:M,day:V}=Hs(S,b);return{year:S,month:M,day:V,...Qt(o)}}function zn(o){const{year:n,month:i,day:u}=o,h=Gs(n,i,u);return{year:n,ordinal:h,...Qt(o)}}function Ys(o){const{year:n,ordinal:i}=o,{month:u,day:h}=Hs(n,i);return{year:n,month:u,day:h,...Qt(o)}}function Zs(o,n){if(!O(o.localWeekday)||!O(o.localWeekNumber)||!O(o.localWeekYear)){if(!O(o.weekday)||!O(o.weekNumber)||!O(o.weekYear))throw new a("Cannot mix locale-based week fields with ISO-based week fields");return O(o.localWeekday)||(o.weekday=o.localWeekday),O(o.localWeekNumber)||(o.weekNumber=o.localWeekNumber),O(o.localWeekYear)||(o.weekYear=o.localWeekYear),delete o.localWeekday,delete o.localWeekNumber,delete o.localWeekYear,{minDaysInFirstWeek:n.getMinDaysInFirstWeek(),startOfWeek:n.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function Kc(o,n=4,i=1){const u=Ht(o.weekYear),h=ce(o.weekNumber,1,_t(o.weekYear,n,i)),f=ce(o.weekday,1,7);return u?h?f?!1:ue("weekday",o.weekday):ue("week",o.weekNumber):ue("weekYear",o.weekYear)}function Qc(o){const n=Ht(o.year),i=ce(o.ordinal,1,st(o.year));return n?i?!1:ue("ordinal",o.ordinal):ue("year",o.year)}function Ks(o){const n=Ht(o.year),i=ce(o.month,1,12),u=ce(o.day,1,zt(o.year,o.month));return n?i?u?!1:ue("day",o.day):ue("month",o.month):ue("year",o.year)}function Qs(o){const{hour:n,minute:i,second:u,millisecond:h}=o,f=ce(n,0,23)||n===24&&i===0&&u===0&&h===0,m=ce(i,0,59),y=ce(u,0,59),b=ce(h,0,999);return f?m?y?b?!1:ue("millisecond",h):ue("second",u):ue("minute",i):ue("hour",n)}function O(o){return typeof o>"u"}function Fe(o){return typeof o=="number"}function Ht(o){return typeof o=="number"&&o%1===0}function Jc(o){return typeof o=="string"}function Xc(o){return Object.prototype.toString.call(o)==="[object Date]"}function Js(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function Xs(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function el(o){return Array.isArray(o)?o:[o]}function ei(o,n,i){if(o.length!==0)return o.reduce((u,h)=>{const f=[n(h),h];return u&&i(u[0],f[0])===u[0]?u:f},null)[1]}function tl(o,n){return n.reduce((i,u)=>(i[u]=o[u],i),{})}function rt(o,n){return Object.prototype.hasOwnProperty.call(o,n)}function Yn(o){if(o==null)return null;if(typeof o!="object")throw new l("Week settings must be an object");if(!ce(o.firstDay,1,7)||!ce(o.minimalDays,1,7)||!Array.isArray(o.weekend)||o.weekend.some(n=>!ce(n,1,7)))throw new l("Invalid week settings");return{firstDay:o.firstDay,minimalDays:o.minimalDays,weekend:Array.from(o.weekend)}}function ce(o,n,i){return Ht(o)&&o>=n&&o<=i}function nl(o,n){return o-n*Math.floor(o/n)}function Q(o,n=2){const i=o<0;let u;return i?u="-"+(""+-o).padStart(n,"0"):u=(""+o).padStart(n,"0"),u}function Re(o){if(!(O(o)||o===null||o===""))return parseInt(o,10)}function He(o){if(!(O(o)||o===null||o===""))return parseFloat(o)}function Zn(o){if(!(O(o)||o===null||o==="")){const n=parseFloat("0."+o)*1e3;return Math.floor(n)}}function Kn(o,n,i=!1){const u=10**n;return(i?Math.trunc:Math.round)(o*u)/u}function Tt(o){return o%4===0&&(o%100!==0||o%400===0)}function st(o){return Tt(o)?366:365}function zt(o,n){const i=nl(n-1,12)+1,u=o+(n-i)/12;return i===2?Tt(u)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][i-1]}function Yt(o){let n=Date.UTC(o.year,o.month-1,o.day,o.hour,o.minute,o.second,o.millisecond);return o.year<100&&o.year>=0&&(n=new Date(n),n.setUTCFullYear(o.year,o.month-1,o.day)),+n}function ti(o,n,i){return-Hn(Gn(o,1,n),i)+n-1}function _t(o,n=4,i=1){const u=ti(o,n,i),h=ti(o+1,n,i);return(st(o)-u+h)/7}function Qn(o){return o>99?o:o>H.twoDigitCutoffYear?1900+o:2e3+o}function ni(o,n,i,u=null){const h=new Date(o),f={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};u&&(f.timeZone=u);const m={timeZoneName:n,...f},y=new Intl.DateTimeFormat(i,m).formatToParts(h).find(b=>b.type.toLowerCase()==="timezonename");return y?y.value:null}function Zt(o,n){let i=parseInt(o,10);Number.isNaN(i)&&(i=0);const u=parseInt(n,10)||0,h=i<0||Object.is(i,-0)?-u:u;return i*60+h}function ri(o){const n=Number(o);if(typeof o=="boolean"||o===""||Number.isNaN(n))throw new l(`Invalid unit value ${o}`);return n}function Kt(o,n){const i={};for(const u in o)if(rt(o,u)){const h=o[u];if(h==null)continue;i[n(u)]=ri(h)}return i}function Et(o,n){const i=Math.trunc(Math.abs(o/60)),u=Math.trunc(Math.abs(o%60)),h=o>=0?"+":"-";switch(n){case"short":return`${h}${Q(i,2)}:${Q(u,2)}`;case"narrow":return`${h}${i}${u>0?`:${u}`:""}`;case"techie":return`${h}${Q(i,2)}${Q(u,2)}`;default:throw new RangeError(`Value format ${n} is out of range for property format`)}}function Qt(o){return tl(o,["hour","minute","second","millisecond"])}const rl=["January","February","March","April","May","June","July","August","September","October","November","December"],si=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],sl=["J","F","M","A","M","J","J","A","S","O","N","D"];function ii(o){switch(o){case"narrow":return[...sl];case"short":return[...si];case"long":return[...rl];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const ai=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],oi=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],il=["M","T","W","T","F","S","S"];function ui(o){switch(o){case"narrow":return[...il];case"short":return[...oi];case"long":return[...ai];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const ci=["AM","PM"],al=["Before Christ","Anno Domini"],ol=["BC","AD"],ul=["B","A"];function li(o){switch(o){case"narrow":return[...ul];case"short":return[...ol];case"long":return[...al];default:return null}}function cl(o){return ci[o.hour<12?0:1]}function ll(o,n){return ui(n)[o.weekday-1]}function hl(o,n){return ii(n)[o.month-1]}function dl(o,n){return li(n)[o.year<0?0:1]}function fl(o,n,i="always",u=!1){const h={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},f=["hours","minutes","seconds"].indexOf(o)===-1;if(i==="auto"&&f){const V=o==="days";switch(n){case 1:return V?"tomorrow":`next ${h[o][0]}`;case-1:return V?"yesterday":`last ${h[o][0]}`;case 0:return V?"today":`this ${h[o][0]}`}}const m=Object.is(n,-0)||n<0,y=Math.abs(n),b=y===1,S=h[o],M=u?b?S[1]:S[2]||S[1]:b?h[o][0]:o;return m?`${y} ${M} ago`:`in ${y} ${M}`}function hi(o,n){let i="";for(const u of o)u.literal?i+=u.val:i+=n(u.val);return i}const ml={D:C,DD:_,DDD:E,DDDD:k,t:L,tt:x,ttt:J,tttt:ee,T:F,TT:T,TTT:$,TTTT:R,f:j,ff:P,fff:se,ffff:Ae,F:Y,FF:q,FFF:Ee,FFFF:Os};class ne{static create(n,i={}){return new ne(n,i)}static parseFormat(n){let i=null,u="",h=!1;const f=[];for(let m=0;m<n.length;m++){const y=n.charAt(m);y==="'"?(u.length>0&&f.push({literal:h||/^\s+$/.test(u),val:u}),i=null,u="",h=!h):h||y===i?u+=y:(u.length>0&&f.push({literal:/^\s+$/.test(u),val:u}),u=y,i=y)}return u.length>0&&f.push({literal:h||/^\s+$/.test(u),val:u}),f}static macroTokenToFormatOpts(n){return ml[n]}constructor(n,i){this.opts=i,this.loc=n,this.systemLoc=null}formatWithSystemDefault(n,i){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(n,{...this.opts,...i}).format()}dtFormatter(n,i={}){return this.loc.dtFormatter(n,{...this.opts,...i})}formatDateTime(n,i){return this.dtFormatter(n,i).format()}formatDateTimeParts(n,i){return this.dtFormatter(n,i).formatToParts()}formatInterval(n,i){return this.dtFormatter(n.start,i).dtf.formatRange(n.start.toJSDate(),n.end.toJSDate())}resolvedOptions(n,i){return this.dtFormatter(n,i).resolvedOptions()}num(n,i=0){if(this.opts.forceSimple)return Q(n,i);const u={...this.opts};return i>0&&(u.padTo=i),this.loc.numberFormatter(u).format(n)}formatDateTimeFromString(n,i){const u=this.loc.listingMode()==="en",h=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",f=(A,X)=>this.loc.extract(n,A,X),m=A=>n.isOffsetFixed&&n.offset===0&&A.allowZ?"Z":n.isValid?n.zone.formatOffset(n.ts,A.format):"",y=()=>u?cl(n):f({hour:"numeric",hourCycle:"h12"},"dayperiod"),b=(A,X)=>u?hl(n,A):f(X?{month:A}:{month:A,day:"numeric"},"month"),S=(A,X)=>u?ll(n,A):f(X?{weekday:A}:{weekday:A,month:"long",day:"numeric"},"weekday"),M=A=>{const X=ne.macroTokenToFormatOpts(A);return X?this.formatWithSystemDefault(n,X):A},V=A=>u?dl(n,A):f({era:A},"era"),K=A=>{switch(A){case"S":return this.num(n.millisecond);case"u":case"SSS":return this.num(n.millisecond,3);case"s":return this.num(n.second);case"ss":return this.num(n.second,2);case"uu":return this.num(Math.floor(n.millisecond/10),2);case"uuu":return this.num(Math.floor(n.millisecond/100));case"m":return this.num(n.minute);case"mm":return this.num(n.minute,2);case"h":return this.num(n.hour%12===0?12:n.hour%12);case"hh":return this.num(n.hour%12===0?12:n.hour%12,2);case"H":return this.num(n.hour);case"HH":return this.num(n.hour,2);case"Z":return m({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return m({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return m({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return n.zone.offsetName(n.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return n.zone.offsetName(n.ts,{format:"long",locale:this.loc.locale});case"z":return n.zoneName;case"a":return y();case"d":return h?f({day:"numeric"},"day"):this.num(n.day);case"dd":return h?f({day:"2-digit"},"day"):this.num(n.day,2);case"c":return this.num(n.weekday);case"ccc":return S("short",!0);case"cccc":return S("long",!0);case"ccccc":return S("narrow",!0);case"E":return this.num(n.weekday);case"EEE":return S("short",!1);case"EEEE":return S("long",!1);case"EEEEE":return S("narrow",!1);case"L":return h?f({month:"numeric",day:"numeric"},"month"):this.num(n.month);case"LL":return h?f({month:"2-digit",day:"numeric"},"month"):this.num(n.month,2);case"LLL":return b("short",!0);case"LLLL":return b("long",!0);case"LLLLL":return b("narrow",!0);case"M":return h?f({month:"numeric"},"month"):this.num(n.month);case"MM":return h?f({month:"2-digit"},"month"):this.num(n.month,2);case"MMM":return b("short",!1);case"MMMM":return b("long",!1);case"MMMMM":return b("narrow",!1);case"y":return h?f({year:"numeric"},"year"):this.num(n.year);case"yy":return h?f({year:"2-digit"},"year"):this.num(n.year.toString().slice(-2),2);case"yyyy":return h?f({year:"numeric"},"year"):this.num(n.year,4);case"yyyyyy":return h?f({year:"numeric"},"year"):this.num(n.year,6);case"G":return V("short");case"GG":return V("long");case"GGGGG":return V("narrow");case"kk":return this.num(n.weekYear.toString().slice(-2),2);case"kkkk":return this.num(n.weekYear,4);case"W":return this.num(n.weekNumber);case"WW":return this.num(n.weekNumber,2);case"n":return this.num(n.localWeekNumber);case"nn":return this.num(n.localWeekNumber,2);case"ii":return this.num(n.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(n.localWeekYear,4);case"o":return this.num(n.ordinal);case"ooo":return this.num(n.ordinal,3);case"q":return this.num(n.quarter);case"qq":return this.num(n.quarter,2);case"X":return this.num(Math.floor(n.ts/1e3));case"x":return this.num(n.ts);default:return M(A)}};return hi(ne.parseFormat(i),K)}formatDurationFromString(n,i){const u=b=>{switch(b[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},h=b=>S=>{const M=u(S);return M?this.num(b.get(M),S.length):S},f=ne.parseFormat(i),m=f.reduce((b,{literal:S,val:M})=>S?b:b.concat(M),[]),y=n.shiftTo(...m.map(u).filter(b=>b));return hi(f,h(y))}}const di=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function it(...o){const n=o.reduce((i,u)=>i+u.source,"");return RegExp(`^${n}$`)}function at(...o){return n=>o.reduce(([i,u,h],f)=>{const[m,y,b]=f(n,h);return[{...i,...m},y||u,b]},[{},null,1]).slice(0,2)}function ot(o,...n){if(o==null)return[null,null];for(const[i,u]of n){const h=i.exec(o);if(h)return u(h)}return[null,null]}function fi(...o){return(n,i)=>{const u={};let h;for(h=0;h<o.length;h++)u[o[h]]=Re(n[i+h]);return[u,null,i+h]}}const mi=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,pl=`(?:${mi.source}?(?:\\[(${di.source})\\])?)?`,Jn=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,pi=RegExp(`${Jn.source}${pl}`),Xn=RegExp(`(?:T${pi.source})?`),gl=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,yl=/(\d{4})-?W(\d\d)(?:-?(\d))?/,wl=/(\d{4})-?(\d{3})/,bl=fi("weekYear","weekNumber","weekDay"),vl=fi("year","ordinal"),Cl=/(\d{4})-(\d\d)-(\d\d)/,gi=RegExp(`${Jn.source} ?(?:${mi.source}|(${di.source}))?`),Sl=RegExp(`(?: ${gi.source})?`);function ut(o,n,i){const u=o[n];return O(u)?i:Re(u)}function Tl(o,n){return[{year:ut(o,n),month:ut(o,n+1,1),day:ut(o,n+2,1)},null,n+3]}function ct(o,n){return[{hours:ut(o,n,0),minutes:ut(o,n+1,0),seconds:ut(o,n+2,0),milliseconds:Zn(o[n+3])},null,n+4]}function It(o,n){const i=!o[n]&&!o[n+1],u=Zt(o[n+1],o[n+2]),h=i?null:te.instance(u);return[{},h,n+3]}function kt(o,n){const i=o[n]?be.create(o[n]):null;return[{},i,n+1]}const _l=RegExp(`^T?${Jn.source}$`),El=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function Il(o){const[n,i,u,h,f,m,y,b,S]=o,M=n[0]==="-",V=b&&b[0]==="-",K=(A,X=!1)=>A!==void 0&&(X||A&&M)?-A:A;return[{years:K(He(i)),months:K(He(u)),weeks:K(He(h)),days:K(He(f)),hours:K(He(m)),minutes:K(He(y)),seconds:K(He(b),b==="-0"),milliseconds:K(Zn(S),V)}]}const kl={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function er(o,n,i,u,h,f,m){const y={year:n.length===2?Qn(Re(n)):Re(n),month:si.indexOf(i)+1,day:Re(u),hour:Re(h),minute:Re(f)};return m&&(y.second=Re(m)),o&&(y.weekday=o.length>3?ai.indexOf(o)+1:oi.indexOf(o)+1),y}const Ml=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function Ol(o){const[,n,i,u,h,f,m,y,b,S,M,V]=o,K=er(n,h,u,i,f,m,y);let A;return b?A=kl[b]:S?A=0:A=Zt(M,V),[K,new te(A)]}function Dl(o){return o.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const Al=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,Nl=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,Fl=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function yi(o){const[,n,i,u,h,f,m,y]=o;return[er(n,h,u,i,f,m,y),te.utcInstance]}function Rl(o){const[,n,i,u,h,f,m,y]=o;return[er(n,y,i,u,h,f,m),te.utcInstance]}const $l=it(gl,Xn),xl=it(yl,Xn),Ll=it(wl,Xn),Pl=it(pi),wi=at(Tl,ct,It,kt),Vl=at(bl,ct,It,kt),Bl=at(vl,ct,It,kt),Ul=at(ct,It,kt);function Wl(o){return ot(o,[$l,wi],[xl,Vl],[Ll,Bl],[Pl,Ul])}function jl(o){return ot(Dl(o),[Ml,Ol])}function ql(o){return ot(o,[Al,yi],[Nl,yi],[Fl,Rl])}function Gl(o){return ot(o,[El,Il])}const Hl=at(ct);function zl(o){return ot(o,[_l,Hl])}const Yl=it(Cl,Sl),Zl=it(gi),Kl=at(ct,It,kt);function Ql(o){return ot(o,[Yl,wi],[Zl,Kl])}const bi="Invalid Duration",vi={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},Jl={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3},...vi},le=146097/400,lt=146097/4800,Xl={years:{quarters:4,months:12,weeks:le/7,days:le,hours:le*24,minutes:le*24*60,seconds:le*24*60*60,milliseconds:le*24*60*60*1e3},quarters:{months:3,weeks:le/28,days:le/4,hours:le*24/4,minutes:le*24*60/4,seconds:le*24*60*60/4,milliseconds:le*24*60*60*1e3/4},months:{weeks:lt/7,days:lt,hours:lt*24,minutes:lt*24*60,seconds:lt*24*60*60,milliseconds:lt*24*60*60*1e3},...vi},ze=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],eh=ze.slice(0).reverse();function $e(o,n,i=!1){const u={values:i?n.values:{...o.values,...n.values||{}},loc:o.loc.clone(n.loc),conversionAccuracy:n.conversionAccuracy||o.conversionAccuracy,matrix:n.matrix||o.matrix};return new B(u)}function Ci(o,n){var i;let u=(i=n.milliseconds)!=null?i:0;for(const h of eh.slice(1))n[h]&&(u+=n[h]*o[h].milliseconds);return u}function Si(o,n){const i=Ci(o,n)<0?-1:1;ze.reduceRight((u,h)=>{if(O(n[h]))return u;if(u){const f=n[u]*i,m=o[h][u],y=Math.floor(f/m);n[h]+=y*i,n[u]-=y*m*i}return h},null),ze.reduce((u,h)=>{if(O(n[h]))return u;if(u){const f=n[u]%1;n[u]-=f,n[h]+=f*o[u][h]}return h},null)}function th(o){const n={};for(const[i,u]of Object.entries(o))u!==0&&(n[i]=u);return n}class B{constructor(n){const i=n.conversionAccuracy==="longterm"||!1;let u=i?Xl:Jl;n.matrix&&(u=n.matrix),this.values=n.values,this.loc=n.loc||W.create(),this.conversionAccuracy=i?"longterm":"casual",this.invalid=n.invalid||null,this.matrix=u,this.isLuxonDuration=!0}static fromMillis(n,i){return B.fromObject({milliseconds:n},i)}static fromObject(n,i={}){if(n==null||typeof n!="object")throw new l(`Duration.fromObject: argument expected to be an object, got ${n===null?"null":typeof n}`);return new B({values:Kt(n,B.normalizeUnit),loc:W.fromObject(i),conversionAccuracy:i.conversionAccuracy,matrix:i.matrix})}static fromDurationLike(n){if(Fe(n))return B.fromMillis(n);if(B.isDuration(n))return n;if(typeof n=="object")return B.fromObject(n);throw new l(`Unknown duration argument ${n} of type ${typeof n}`)}static fromISO(n,i){const[u]=Gl(n);return u?B.fromObject(u,i):B.invalid("unparsable",`the input "${n}" can't be parsed as ISO 8601`)}static fromISOTime(n,i){const[u]=zl(n);return u?B.fromObject(u,i):B.invalid("unparsable",`the input "${n}" can't be parsed as ISO 8601`)}static invalid(n,i=null){if(!n)throw new l("need to specify a reason the Duration is invalid");const u=n instanceof fe?n:new fe(n,i);if(H.throwOnInvalid)throw new r(u);return new B({invalid:u})}static normalizeUnit(n){const i={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[n&&n.toLowerCase()];if(!i)throw new c(n);return i}static isDuration(n){return n&&n.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(n,i={}){const u={...i,floor:i.round!==!1&&i.floor!==!1};return this.isValid?ne.create(this.loc,u).formatDurationFromString(this,n):bi}toHuman(n={}){if(!this.isValid)return bi;const i=ze.map(u=>{const h=this.values[u];return O(h)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...n,unit:u.slice(0,-1)}).format(h)}).filter(u=>u);return this.loc.listFormatter({type:"conjunction",style:n.listStyle||"narrow",...n}).format(i)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let n="P";return this.years!==0&&(n+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(n+=this.months+this.quarters*3+"M"),this.weeks!==0&&(n+=this.weeks+"W"),this.days!==0&&(n+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(n+="T"),this.hours!==0&&(n+=this.hours+"H"),this.minutes!==0&&(n+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(n+=Kn(this.seconds+this.milliseconds/1e3,3)+"S"),n==="P"&&(n+="T0S"),n}toISOTime(n={}){if(!this.isValid)return null;const i=this.toMillis();return i<0||i>=864e5?null:(n={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...n,includeOffset:!1},D.fromMillis(i,{zone:"UTC"}).toISOTime(n))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?Ci(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(n){if(!this.isValid)return this;const i=B.fromDurationLike(n),u={};for(const h of ze)(rt(i.values,h)||rt(this.values,h))&&(u[h]=i.get(h)+this.get(h));return $e(this,{values:u},!0)}minus(n){if(!this.isValid)return this;const i=B.fromDurationLike(n);return this.plus(i.negate())}mapUnits(n){if(!this.isValid)return this;const i={};for(const u of Object.keys(this.values))i[u]=ri(n(this.values[u],u));return $e(this,{values:i},!0)}get(n){return this[B.normalizeUnit(n)]}set(n){if(!this.isValid)return this;const i={...this.values,...Kt(n,B.normalizeUnit)};return $e(this,{values:i})}reconfigure({locale:n,numberingSystem:i,conversionAccuracy:u,matrix:h}={}){const m={loc:this.loc.clone({locale:n,numberingSystem:i}),matrix:h,conversionAccuracy:u};return $e(this,m)}as(n){return this.isValid?this.shiftTo(n).get(n):NaN}normalize(){if(!this.isValid)return this;const n=this.toObject();return Si(this.matrix,n),$e(this,{values:n},!0)}rescale(){if(!this.isValid)return this;const n=th(this.normalize().shiftToAll().toObject());return $e(this,{values:n},!0)}shiftTo(...n){if(!this.isValid)return this;if(n.length===0)return this;n=n.map(m=>B.normalizeUnit(m));const i={},u={},h=this.toObject();let f;for(const m of ze)if(n.indexOf(m)>=0){f=m;let y=0;for(const S in u)y+=this.matrix[S][m]*u[S],u[S]=0;Fe(h[m])&&(y+=h[m]);const b=Math.trunc(y);i[m]=b,u[m]=(y*1e3-b*1e3)/1e3}else Fe(h[m])&&(u[m]=h[m]);for(const m in u)u[m]!==0&&(i[f]+=m===f?u[m]:u[m]/this.matrix[f][m]);return Si(this.matrix,i),$e(this,{values:i},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const n={};for(const i of Object.keys(this.values))n[i]=this.values[i]===0?0:-this.values[i];return $e(this,{values:n},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(n){if(!this.isValid||!n.isValid||!this.loc.equals(n.loc))return!1;function i(u,h){return u===void 0||u===0?h===void 0||h===0:u===h}for(const u of ze)if(!i(this.values[u],n.values[u]))return!1;return!0}}const ht="Invalid Interval";function nh(o,n){return!o||!o.isValid?z.invalid("missing or invalid start"):!n||!n.isValid?z.invalid("missing or invalid end"):n<o?z.invalid("end before start",`The end of an interval must be after its start, but you had start=${o.toISO()} and end=${n.toISO()}`):null}class z{constructor(n){this.s=n.start,this.e=n.end,this.invalid=n.invalid||null,this.isLuxonInterval=!0}static invalid(n,i=null){if(!n)throw new l("need to specify a reason the Interval is invalid");const u=n instanceof fe?n:new fe(n,i);if(H.throwOnInvalid)throw new t(u);return new z({invalid:u})}static fromDateTimes(n,i){const u=At(n),h=At(i),f=nh(u,h);return f??new z({start:u,end:h})}static after(n,i){const u=B.fromDurationLike(i),h=At(n);return z.fromDateTimes(h,h.plus(u))}static before(n,i){const u=B.fromDurationLike(i),h=At(n);return z.fromDateTimes(h.minus(u),h)}static fromISO(n,i){const[u,h]=(n||"").split("/",2);if(u&&h){let f,m;try{f=D.fromISO(u,i),m=f.isValid}catch{m=!1}let y,b;try{y=D.fromISO(h,i),b=y.isValid}catch{b=!1}if(m&&b)return z.fromDateTimes(f,y);if(m){const S=B.fromISO(h,i);if(S.isValid)return z.after(f,S)}else if(b){const S=B.fromISO(u,i);if(S.isValid)return z.before(y,S)}}return z.invalid("unparsable",`the input "${n}" can't be parsed as ISO 8601`)}static isInterval(n){return n&&n.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get lastDateTime(){return this.isValid&&this.e?this.e.minus(1):null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(n="milliseconds"){return this.isValid?this.toDuration(n).get(n):NaN}count(n="milliseconds",i){if(!this.isValid)return NaN;const u=this.start.startOf(n,i);let h;return i!=null&&i.useLocaleWeeks?h=this.end.reconfigure({locale:u.locale}):h=this.end,h=h.startOf(n,i),Math.floor(h.diff(u,n).get(n))+(h.valueOf()!==this.end.valueOf())}hasSame(n){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,n):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(n){return this.isValid?this.s>n:!1}isBefore(n){return this.isValid?this.e<=n:!1}contains(n){return this.isValid?this.s<=n&&this.e>n:!1}set({start:n,end:i}={}){return this.isValid?z.fromDateTimes(n||this.s,i||this.e):this}splitAt(...n){if(!this.isValid)return[];const i=n.map(At).filter(m=>this.contains(m)).sort((m,y)=>m.toMillis()-y.toMillis()),u=[];let{s:h}=this,f=0;for(;h<this.e;){const m=i[f]||this.e,y=+m>+this.e?this.e:m;u.push(z.fromDateTimes(h,y)),h=y,f+=1}return u}splitBy(n){const i=B.fromDurationLike(n);if(!this.isValid||!i.isValid||i.as("milliseconds")===0)return[];let{s:u}=this,h=1,f;const m=[];for(;u<this.e;){const y=this.start.plus(i.mapUnits(b=>b*h));f=+y>+this.e?this.e:y,m.push(z.fromDateTimes(u,f)),u=f,h+=1}return m}divideEqually(n){return this.isValid?this.splitBy(this.length()/n).slice(0,n):[]}overlaps(n){return this.e>n.s&&this.s<n.e}abutsStart(n){return this.isValid?+this.e==+n.s:!1}abutsEnd(n){return this.isValid?+n.e==+this.s:!1}engulfs(n){return this.isValid?this.s<=n.s&&this.e>=n.e:!1}equals(n){return!this.isValid||!n.isValid?!1:this.s.equals(n.s)&&this.e.equals(n.e)}intersection(n){if(!this.isValid)return this;const i=this.s>n.s?this.s:n.s,u=this.e<n.e?this.e:n.e;return i>=u?null:z.fromDateTimes(i,u)}union(n){if(!this.isValid)return this;const i=this.s<n.s?this.s:n.s,u=this.e>n.e?this.e:n.e;return z.fromDateTimes(i,u)}static merge(n){const[i,u]=n.sort((h,f)=>h.s-f.s).reduce(([h,f],m)=>f?f.overlaps(m)||f.abutsStart(m)?[h,f.union(m)]:[h.concat([f]),m]:[h,m],[[],null]);return u&&i.push(u),i}static xor(n){let i=null,u=0;const h=[],f=n.map(b=>[{time:b.s,type:"s"},{time:b.e,type:"e"}]),m=Array.prototype.concat(...f),y=m.sort((b,S)=>b.time-S.time);for(const b of y)u+=b.type==="s"?1:-1,u===1?i=b.time:(i&&+i!=+b.time&&h.push(z.fromDateTimes(i,b.time)),i=null);return z.merge(h)}difference(...n){return z.xor([this].concat(n)).map(i=>this.intersection(i)).filter(i=>i&&!i.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} – ${this.e.toISO()})`:ht}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(n=C,i={}){return this.isValid?ne.create(this.s.loc.clone(i),n).formatInterval(this):ht}toISO(n){return this.isValid?`${this.s.toISO(n)}/${this.e.toISO(n)}`:ht}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:ht}toISOTime(n){return this.isValid?`${this.s.toISOTime(n)}/${this.e.toISOTime(n)}`:ht}toFormat(n,{separator:i=" – "}={}){return this.isValid?`${this.s.toFormat(n)}${i}${this.e.toFormat(n)}`:ht}toDuration(n,i){return this.isValid?this.e.diff(this.s,n,i):B.invalid(this.invalidReason)}mapEndpoints(n){return z.fromDateTimes(n(this.s),n(this.e))}}class Mt{static hasDST(n=H.defaultZone){const i=D.now().setZone(n).set({month:12});return!n.isUniversal&&i.offset!==i.set({month:6}).offset}static isValidIANAZone(n){return be.isValidZone(n)}static normalizeZone(n){return Ne(n,H.defaultZone)}static getStartOfWeek({locale:n=null,locObj:i=null}={}){return(i||W.create(n)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:n=null,locObj:i=null}={}){return(i||W.create(n)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:n=null,locObj:i=null}={}){return(i||W.create(n)).getWeekendDays().slice()}static months(n="long",{locale:i=null,numberingSystem:u=null,locObj:h=null,outputCalendar:f="gregory"}={}){return(h||W.create(i,u,f)).months(n)}static monthsFormat(n="long",{locale:i=null,numberingSystem:u=null,locObj:h=null,outputCalendar:f="gregory"}={}){return(h||W.create(i,u,f)).months(n,!0)}static weekdays(n="long",{locale:i=null,numberingSystem:u=null,locObj:h=null}={}){return(h||W.create(i,u,null)).weekdays(n)}static weekdaysFormat(n="long",{locale:i=null,numberingSystem:u=null,locObj:h=null}={}){return(h||W.create(i,u,null)).weekdays(n,!0)}static meridiems({locale:n=null}={}){return W.create(n).meridiems()}static eras(n="short",{locale:i=null}={}){return W.create(i,null,"gregory").eras(n)}static features(){return{relative:Js(),localeWeek:Xs()}}}function Ti(o,n){const i=h=>h.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),u=i(n)-i(o);return Math.floor(B.fromMillis(u).as("days"))}function rh(o,n,i){const u=[["years",(b,S)=>S.year-b.year],["quarters",(b,S)=>S.quarter-b.quarter+(S.year-b.year)*4],["months",(b,S)=>S.month-b.month+(S.year-b.year)*12],["weeks",(b,S)=>{const M=Ti(b,S);return(M-M%7)/7}],["days",Ti]],h={},f=o;let m,y;for(const[b,S]of u)i.indexOf(b)>=0&&(m=b,h[b]=S(o,n),y=f.plus(h),y>n?(h[b]--,o=f.plus(h),o>n&&(y=o,h[b]--,o=f.plus(h))):o=y);return[o,h,y,m]}function sh(o,n,i,u){let[h,f,m,y]=rh(o,n,i);const b=n-h,S=i.filter(V=>["hours","minutes","seconds","milliseconds"].indexOf(V)>=0);S.length===0&&(m<n&&(m=h.plus({[y]:1})),m!==h&&(f[y]=(f[y]||0)+b/(m-h)));const M=B.fromObject(f,u);return S.length>0?B.fromMillis(b,u).shiftTo(...S).plus(M):M}const ih="missing Intl.DateTimeFormat.formatToParts support";function U(o,n=i=>i){return{regex:o,deser:([i])=>n(Yc(i))}}const _i="[  ]",Ei=new RegExp(_i,"g");function ah(o){return o.replace(/\./g,"\\.?").replace(Ei,_i)}function Ii(o){return o.replace(/\./g,"").replace(Ei," ").toLowerCase()}function me(o,n){return o===null?null:{regex:RegExp(o.map(ah).join("|")),deser:([i])=>o.findIndex(u=>Ii(i)===Ii(u))+n}}function ki(o,n){return{regex:o,deser:([,i,u])=>Zt(i,u),groups:n}}function Jt(o){return{regex:o,deser:([n])=>n}}function oh(o){return o.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function uh(o,n){const i=de(n),u=de(n,"{2}"),h=de(n,"{3}"),f=de(n,"{4}"),m=de(n,"{6}"),y=de(n,"{1,2}"),b=de(n,"{1,3}"),S=de(n,"{1,6}"),M=de(n,"{1,9}"),V=de(n,"{2,4}"),K=de(n,"{4,6}"),A=ve=>({regex:RegExp(oh(ve.val)),deser:([mt])=>mt,literal:!0}),ft=(ve=>{if(o.literal)return A(ve);switch(ve.val){case"G":return me(n.eras("short"),0);case"GG":return me(n.eras("long"),0);case"y":return U(S);case"yy":return U(V,Qn);case"yyyy":return U(f);case"yyyyy":return U(K);case"yyyyyy":return U(m);case"M":return U(y);case"MM":return U(u);case"MMM":return me(n.months("short",!0),1);case"MMMM":return me(n.months("long",!0),1);case"L":return U(y);case"LL":return U(u);case"LLL":return me(n.months("short",!1),1);case"LLLL":return me(n.months("long",!1),1);case"d":return U(y);case"dd":return U(u);case"o":return U(b);case"ooo":return U(h);case"HH":return U(u);case"H":return U(y);case"hh":return U(u);case"h":return U(y);case"mm":return U(u);case"m":return U(y);case"q":return U(y);case"qq":return U(u);case"s":return U(y);case"ss":return U(u);case"S":return U(b);case"SSS":return U(h);case"u":return Jt(M);case"uu":return Jt(y);case"uuu":return U(i);case"a":return me(n.meridiems(),0);case"kkkk":return U(f);case"kk":return U(V,Qn);case"W":return U(y);case"WW":return U(u);case"E":case"c":return U(i);case"EEE":return me(n.weekdays("short",!1),1);case"EEEE":return me(n.weekdays("long",!1),1);case"ccc":return me(n.weekdays("short",!0),1);case"cccc":return me(n.weekdays("long",!0),1);case"Z":case"ZZ":return ki(new RegExp(`([+-]${y.source})(?::(${u.source}))?`),2);case"ZZZ":return ki(new RegExp(`([+-]${y.source})(${u.source})?`),2);case"z":return Jt(/[a-z_+-/]{1,256}?/i);case" ":return Jt(/[^\S\n\r]/);default:return A(ve)}})(o)||{invalidReason:ih};return ft.token=o,ft}const ch={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function lh(o,n,i){const{type:u,value:h}=o;if(u==="literal"){const b=/^\s+$/.test(h);return{literal:!b,val:b?" ":h}}const f=n[u];let m=u;u==="hour"&&(n.hour12!=null?m=n.hour12?"hour12":"hour24":n.hourCycle!=null?n.hourCycle==="h11"||n.hourCycle==="h12"?m="hour12":m="hour24":m=i.hour12?"hour12":"hour24");let y=ch[m];if(typeof y=="object"&&(y=y[f]),y)return{literal:!1,val:y}}function hh(o){return[`^${o.map(i=>i.regex).reduce((i,u)=>`${i}(${u.source})`,"")}$`,o]}function dh(o,n,i){const u=o.match(n);if(u){const h={};let f=1;for(const m in i)if(rt(i,m)){const y=i[m],b=y.groups?y.groups+1:1;!y.literal&&y.token&&(h[y.token.val[0]]=y.deser(u.slice(f,f+b))),f+=b}return[u,h]}else return[u,{}]}function fh(o){const n=f=>{switch(f){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let i=null,u;return O(o.z)||(i=be.create(o.z)),O(o.Z)||(i||(i=new te(o.Z)),u=o.Z),O(o.q)||(o.M=(o.q-1)*3+1),O(o.h)||(o.h<12&&o.a===1?o.h+=12:o.h===12&&o.a===0&&(o.h=0)),o.G===0&&o.y&&(o.y=-o.y),O(o.u)||(o.S=Zn(o.u)),[Object.keys(o).reduce((f,m)=>{const y=n(m);return y&&(f[y]=o[m]),f},{}),i,u]}let tr=null;function mh(){return tr||(tr=D.fromMillis(1555555555555)),tr}function ph(o,n){if(o.literal)return o;const i=ne.macroTokenToFormatOpts(o.val),u=Ai(i,n);return u==null||u.includes(void 0)?o:u}function Mi(o,n){return Array.prototype.concat(...o.map(i=>ph(i,n)))}class Oi{constructor(n,i){if(this.locale=n,this.format=i,this.tokens=Mi(ne.parseFormat(i),n),this.units=this.tokens.map(u=>uh(u,n)),this.disqualifyingUnit=this.units.find(u=>u.invalidReason),!this.disqualifyingUnit){const[u,h]=hh(this.units);this.regex=RegExp(u,"i"),this.handlers=h}}explainFromTokens(n){if(this.isValid){const[i,u]=dh(n,this.regex,this.handlers),[h,f,m]=u?fh(u):[null,null,void 0];if(rt(u,"a")&&rt(u,"H"))throw new a("Can't include meridiem when specifying 24-hour format");return{input:n,tokens:this.tokens,regex:this.regex,rawMatches:i,matches:u,result:h,zone:f,specificOffset:m}}else return{input:n,tokens:this.tokens,invalidReason:this.invalidReason}}get isValid(){return!this.disqualifyingUnit}get invalidReason(){return this.disqualifyingUnit?this.disqualifyingUnit.invalidReason:null}}function Di(o,n,i){return new Oi(o,i).explainFromTokens(n)}function gh(o,n,i){const{result:u,zone:h,specificOffset:f,invalidReason:m}=Di(o,n,i);return[u,h,f,m]}function Ai(o,n){if(!o)return null;const u=ne.create(n,o).dtFormatter(mh()),h=u.formatToParts(),f=u.resolvedOptions();return h.map(m=>lh(m,o,f))}const nr="Invalid DateTime",yh=864e13;function Ot(o){return new fe("unsupported zone",`the zone "${o.name}" is not supported`)}function rr(o){return o.weekData===null&&(o.weekData=Gt(o.c)),o.weekData}function sr(o){return o.localWeekData===null&&(o.localWeekData=Gt(o.c,o.loc.getMinDaysInFirstWeek(),o.loc.getStartOfWeek())),o.localWeekData}function Ye(o,n){const i={ts:o.ts,zone:o.zone,c:o.c,o:o.o,loc:o.loc,invalid:o.invalid};return new D({...i,...n,old:i})}function Ni(o,n,i){let u=o-n*60*1e3;const h=i.offset(u);if(n===h)return[u,n];u-=(h-n)*60*1e3;const f=i.offset(u);return h===f?[u,h]:[o-Math.min(h,f)*60*1e3,Math.max(h,f)]}function Xt(o,n){o+=n*60*1e3;const i=new Date(o);return{year:i.getUTCFullYear(),month:i.getUTCMonth()+1,day:i.getUTCDate(),hour:i.getUTCHours(),minute:i.getUTCMinutes(),second:i.getUTCSeconds(),millisecond:i.getUTCMilliseconds()}}function en(o,n,i){return Ni(Yt(o),n,i)}function Fi(o,n){const i=o.o,u=o.c.year+Math.trunc(n.years),h=o.c.month+Math.trunc(n.months)+Math.trunc(n.quarters)*3,f={...o.c,year:u,month:h,day:Math.min(o.c.day,zt(u,h))+Math.trunc(n.days)+Math.trunc(n.weeks)*7},m=B.fromObject({years:n.years-Math.trunc(n.years),quarters:n.quarters-Math.trunc(n.quarters),months:n.months-Math.trunc(n.months),weeks:n.weeks-Math.trunc(n.weeks),days:n.days-Math.trunc(n.days),hours:n.hours,minutes:n.minutes,seconds:n.seconds,milliseconds:n.milliseconds}).as("milliseconds"),y=Yt(f);let[b,S]=Ni(y,i,o.zone);return m!==0&&(b+=m,S=o.zone.offset(b)),{ts:b,o:S}}function dt(o,n,i,u,h,f){const{setZone:m,zone:y}=i;if(o&&Object.keys(o).length!==0||n){const b=n||y,S=D.fromObject(o,{...i,zone:b,specificOffset:f});return m?S:S.setZone(y)}else return D.invalid(new fe("unparsable",`the input "${h}" can't be parsed as ${u}`))}function tn(o,n,i=!0){return o.isValid?ne.create(W.create("en-US"),{allowZ:i,forceSimple:!0}).formatDateTimeFromString(o,n):null}function ir(o,n){const i=o.c.year>9999||o.c.year<0;let u="";return i&&o.c.year>=0&&(u+="+"),u+=Q(o.c.year,i?6:4),n?(u+="-",u+=Q(o.c.month),u+="-",u+=Q(o.c.day)):(u+=Q(o.c.month),u+=Q(o.c.day)),u}function Ri(o,n,i,u,h,f){let m=Q(o.c.hour);return n?(m+=":",m+=Q(o.c.minute),(o.c.millisecond!==0||o.c.second!==0||!i)&&(m+=":")):m+=Q(o.c.minute),(o.c.millisecond!==0||o.c.second!==0||!i)&&(m+=Q(o.c.second),(o.c.millisecond!==0||!u)&&(m+=".",m+=Q(o.c.millisecond,3))),h&&(o.isOffsetFixed&&o.offset===0&&!f?m+="Z":o.o<0?(m+="-",m+=Q(Math.trunc(-o.o/60)),m+=":",m+=Q(Math.trunc(-o.o%60))):(m+="+",m+=Q(Math.trunc(o.o/60)),m+=":",m+=Q(Math.trunc(o.o%60)))),f&&(m+="["+o.zone.ianaName+"]"),m}const $i={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},wh={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},bh={ordinal:1,hour:0,minute:0,second:0,millisecond:0},xi=["year","month","day","hour","minute","second","millisecond"],vh=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],Ch=["year","ordinal","hour","minute","second","millisecond"];function Sh(o){const n={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[o.toLowerCase()];if(!n)throw new c(o);return n}function Li(o){switch(o.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return Sh(o)}}function Th(o){if(Dt===void 0&&(Dt=H.now()),o.type!=="iana")return o.offset(Dt);const n=o.name;let i=ar.get(n);return i===void 0&&(i=o.offset(Dt),ar.set(n,i)),i}function Pi(o,n){const i=Ne(n.zone,H.defaultZone);if(!i.isValid)return D.invalid(Ot(i));const u=W.fromObject(n);let h,f;if(O(o.year))h=H.now();else{for(const b of xi)O(o[b])&&(o[b]=$i[b]);const m=Ks(o)||Qs(o);if(m)return D.invalid(m);const y=Th(i);[h,f]=en(o,y,i)}return new D({ts:h,zone:i,loc:u,o:f})}function Vi(o,n,i){const u=O(i.round)?!0:i.round,h=(m,y)=>(m=Kn(m,u||i.calendary?0:2,!0),n.loc.clone(i).relFormatter(i).format(m,y)),f=m=>i.calendary?n.hasSame(o,m)?0:n.startOf(m).diff(o.startOf(m),m).get(m):n.diff(o,m).get(m);if(i.unit)return h(f(i.unit),i.unit);for(const m of i.units){const y=f(m);if(Math.abs(y)>=1)return h(y,m)}return h(o>n?-0:0,i.units[i.units.length-1])}function Bi(o){let n={},i;return o.length>0&&typeof o[o.length-1]=="object"?(n=o[o.length-1],i=Array.from(o).slice(0,o.length-1)):i=Array.from(o),[n,i]}let Dt;const ar=new Map;class D{constructor(n){const i=n.zone||H.defaultZone;let u=n.invalid||(Number.isNaN(n.ts)?new fe("invalid input"):null)||(i.isValid?null:Ot(i));this.ts=O(n.ts)?H.now():n.ts;let h=null,f=null;if(!u)if(n.old&&n.old.ts===this.ts&&n.old.zone.equals(i))[h,f]=[n.old.c,n.old.o];else{const y=Fe(n.o)&&!n.old?n.o:i.offset(this.ts);h=Xt(this.ts,y),u=Number.isNaN(h.year)?new fe("invalid input"):null,h=u?null:h,f=u?null:y}this._zone=i,this.loc=n.loc||W.create(),this.invalid=u,this.weekData=null,this.localWeekData=null,this.c=h,this.o=f,this.isLuxonDateTime=!0}static now(){return new D({})}static local(){const[n,i]=Bi(arguments),[u,h,f,m,y,b,S]=i;return Pi({year:u,month:h,day:f,hour:m,minute:y,second:b,millisecond:S},n)}static utc(){const[n,i]=Bi(arguments),[u,h,f,m,y,b,S]=i;return n.zone=te.utcInstance,Pi({year:u,month:h,day:f,hour:m,minute:y,second:b,millisecond:S},n)}static fromJSDate(n,i={}){const u=Xc(n)?n.valueOf():NaN;if(Number.isNaN(u))return D.invalid("invalid input");const h=Ne(i.zone,H.defaultZone);return h.isValid?new D({ts:u,zone:h,loc:W.fromObject(i)}):D.invalid(Ot(h))}static fromMillis(n,i={}){if(Fe(n))return n<-864e13||n>yh?D.invalid("Timestamp out of range"):new D({ts:n,zone:Ne(i.zone,H.defaultZone),loc:W.fromObject(i)});throw new l(`fromMillis requires a numerical input, but received a ${typeof n} with value ${n}`)}static fromSeconds(n,i={}){if(Fe(n))return new D({ts:n*1e3,zone:Ne(i.zone,H.defaultZone),loc:W.fromObject(i)});throw new l("fromSeconds requires a numerical input")}static fromObject(n,i={}){n=n||{};const u=Ne(i.zone,H.defaultZone);if(!u.isValid)return D.invalid(Ot(u));const h=W.fromObject(i),f=Kt(n,Li),{minDaysInFirstWeek:m,startOfWeek:y}=Zs(f,h),b=H.now(),S=O(i.specificOffset)?u.offset(b):i.specificOffset,M=!O(f.ordinal),V=!O(f.year),K=!O(f.month)||!O(f.day),A=V||K,X=f.weekYear||f.weekNumber;if((A||M)&&X)throw new a("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(K&&M)throw new a("Can't mix ordinal dates with month/day");const ft=X||f.weekday&&!A;let ve,mt,Nt=Xt(b,S);ft?(ve=vh,mt=wh,Nt=Gt(Nt,m,y)):M?(ve=Ch,mt=bh,Nt=zn(Nt)):(ve=xi,mt=$i);let Ui=!1;for(const Rt of ve){const Oh=f[Rt];O(Oh)?Ui?f[Rt]=mt[Rt]:f[Rt]=Nt[Rt]:Ui=!0}const Eh=ft?Kc(f,m,y):M?Qc(f):Ks(f),Wi=Eh||Qs(f);if(Wi)return D.invalid(Wi);const Ih=ft?zs(f,m,y):M?Ys(f):f,[kh,Mh]=en(Ih,S,u),Ft=new D({ts:kh,zone:u,o:Mh,loc:h});return f.weekday&&A&&n.weekday!==Ft.weekday?D.invalid("mismatched weekday",`you can't specify both a weekday of ${f.weekday} and a date of ${Ft.toISO()}`):Ft.isValid?Ft:D.invalid(Ft.invalid)}static fromISO(n,i={}){const[u,h]=Wl(n);return dt(u,h,i,"ISO 8601",n)}static fromRFC2822(n,i={}){const[u,h]=jl(n);return dt(u,h,i,"RFC 2822",n)}static fromHTTP(n,i={}){const[u,h]=ql(n);return dt(u,h,i,"HTTP",i)}static fromFormat(n,i,u={}){if(O(n)||O(i))throw new l("fromFormat requires an input string and a format");const{locale:h=null,numberingSystem:f=null}=u,m=W.fromOpts({locale:h,numberingSystem:f,defaultToEN:!0}),[y,b,S,M]=gh(m,n,i);return M?D.invalid(M):dt(y,b,u,`format ${i}`,n,S)}static fromString(n,i,u={}){return D.fromFormat(n,i,u)}static fromSQL(n,i={}){const[u,h]=Ql(n);return dt(u,h,i,"SQL",n)}static invalid(n,i=null){if(!n)throw new l("need to specify a reason the DateTime is invalid");const u=n instanceof fe?n:new fe(n,i);if(H.throwOnInvalid)throw new e(u);return new D({invalid:u})}static isDateTime(n){return n&&n.isLuxonDateTime||!1}static parseFormatForOpts(n,i={}){const u=Ai(n,W.fromObject(i));return u?u.map(h=>h?h.val:null).join(""):null}static expandFormat(n,i={}){return Mi(ne.parseFormat(n),W.fromObject(i)).map(h=>h.val).join("")}static resetCache(){Dt=void 0,ar.clear()}get(n){return this[n]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?rr(this).weekYear:NaN}get weekNumber(){return this.isValid?rr(this).weekNumber:NaN}get weekday(){return this.isValid?rr(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?sr(this).weekday:NaN}get localWeekNumber(){return this.isValid?sr(this).weekNumber:NaN}get localWeekYear(){return this.isValid?sr(this).weekYear:NaN}get ordinal(){return this.isValid?zn(this.c).ordinal:NaN}get monthShort(){return this.isValid?Mt.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?Mt.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?Mt.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Mt.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const n=864e5,i=6e4,u=Yt(this.c),h=this.zone.offset(u-n),f=this.zone.offset(u+n),m=this.zone.offset(u-h*i),y=this.zone.offset(u-f*i);if(m===y)return[this];const b=u-m*i,S=u-y*i,M=Xt(b,m),V=Xt(S,y);return M.hour===V.hour&&M.minute===V.minute&&M.second===V.second&&M.millisecond===V.millisecond?[Ye(this,{ts:b}),Ye(this,{ts:S})]:[this]}get isInLeapYear(){return Tt(this.year)}get daysInMonth(){return zt(this.year,this.month)}get daysInYear(){return this.isValid?st(this.year):NaN}get weeksInWeekYear(){return this.isValid?_t(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?_t(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(n={}){const{locale:i,numberingSystem:u,calendar:h}=ne.create(this.loc.clone(n),n).resolvedOptions(this);return{locale:i,numberingSystem:u,outputCalendar:h}}toUTC(n=0,i={}){return this.setZone(te.instance(n),i)}toLocal(){return this.setZone(H.defaultZone)}setZone(n,{keepLocalTime:i=!1,keepCalendarTime:u=!1}={}){if(n=Ne(n,H.defaultZone),n.equals(this.zone))return this;if(n.isValid){let h=this.ts;if(i||u){const f=n.offset(this.ts),m=this.toObject();[h]=en(m,f,n)}return Ye(this,{ts:h,zone:n})}else return D.invalid(Ot(n))}reconfigure({locale:n,numberingSystem:i,outputCalendar:u}={}){const h=this.loc.clone({locale:n,numberingSystem:i,outputCalendar:u});return Ye(this,{loc:h})}setLocale(n){return this.reconfigure({locale:n})}set(n){if(!this.isValid)return this;const i=Kt(n,Li),{minDaysInFirstWeek:u,startOfWeek:h}=Zs(i,this.loc),f=!O(i.weekYear)||!O(i.weekNumber)||!O(i.weekday),m=!O(i.ordinal),y=!O(i.year),b=!O(i.month)||!O(i.day),S=y||b,M=i.weekYear||i.weekNumber;if((S||m)&&M)throw new a("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(b&&m)throw new a("Can't mix ordinal dates with month/day");let V;f?V=zs({...Gt(this.c,u,h),...i},u,h):O(i.ordinal)?(V={...this.toObject(),...i},O(i.day)&&(V.day=Math.min(zt(V.year,V.month),V.day))):V=Ys({...zn(this.c),...i});const[K,A]=en(V,this.o,this.zone);return Ye(this,{ts:K,o:A})}plus(n){if(!this.isValid)return this;const i=B.fromDurationLike(n);return Ye(this,Fi(this,i))}minus(n){if(!this.isValid)return this;const i=B.fromDurationLike(n).negate();return Ye(this,Fi(this,i))}startOf(n,{useLocaleWeeks:i=!1}={}){if(!this.isValid)return this;const u={},h=B.normalizeUnit(n);switch(h){case"years":u.month=1;case"quarters":case"months":u.day=1;case"weeks":case"days":u.hour=0;case"hours":u.minute=0;case"minutes":u.second=0;case"seconds":u.millisecond=0;break}if(h==="weeks")if(i){const f=this.loc.getStartOfWeek(),{weekday:m}=this;m<f&&(u.weekNumber=this.weekNumber-1),u.weekday=f}else u.weekday=1;if(h==="quarters"){const f=Math.ceil(this.month/3);u.month=(f-1)*3+1}return this.set(u)}endOf(n,i){return this.isValid?this.plus({[n]:1}).startOf(n,i).minus(1):this}toFormat(n,i={}){return this.isValid?ne.create(this.loc.redefaultToEN(i)).formatDateTimeFromString(this,n):nr}toLocaleString(n=C,i={}){return this.isValid?ne.create(this.loc.clone(i),n).formatDateTime(this):nr}toLocaleParts(n={}){return this.isValid?ne.create(this.loc.clone(n),n).formatDateTimeParts(this):[]}toISO({format:n="extended",suppressSeconds:i=!1,suppressMilliseconds:u=!1,includeOffset:h=!0,extendedZone:f=!1}={}){if(!this.isValid)return null;const m=n==="extended";let y=ir(this,m);return y+="T",y+=Ri(this,m,i,u,h,f),y}toISODate({format:n="extended"}={}){return this.isValid?ir(this,n==="extended"):null}toISOWeekDate(){return tn(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:n=!1,suppressSeconds:i=!1,includeOffset:u=!0,includePrefix:h=!1,extendedZone:f=!1,format:m="extended"}={}){return this.isValid?(h?"T":"")+Ri(this,m==="extended",i,n,u,f):null}toRFC2822(){return tn(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return tn(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?ir(this,!0):null}toSQLTime({includeOffset:n=!0,includeZone:i=!1,includeOffsetSpace:u=!0}={}){let h="HH:mm:ss.SSS";return(i||n)&&(u&&(h+=" "),i?h+="z":n&&(h+="ZZ")),tn(this,h,!0)}toSQL(n={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(n)}`:null}toString(){return this.isValid?this.toISO():nr}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(n={}){if(!this.isValid)return{};const i={...this.c};return n.includeConfig&&(i.outputCalendar=this.outputCalendar,i.numberingSystem=this.loc.numberingSystem,i.locale=this.loc.locale),i}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(n,i="milliseconds",u={}){if(!this.isValid||!n.isValid)return B.invalid("created by diffing an invalid DateTime");const h={locale:this.locale,numberingSystem:this.numberingSystem,...u},f=el(i).map(B.normalizeUnit),m=n.valueOf()>this.valueOf(),y=m?this:n,b=m?n:this,S=sh(y,b,f,h);return m?S.negate():S}diffNow(n="milliseconds",i={}){return this.diff(D.now(),n,i)}until(n){return this.isValid?z.fromDateTimes(this,n):this}hasSame(n,i,u){if(!this.isValid)return!1;const h=n.valueOf(),f=this.setZone(n.zone,{keepLocalTime:!0});return f.startOf(i,u)<=h&&h<=f.endOf(i,u)}equals(n){return this.isValid&&n.isValid&&this.valueOf()===n.valueOf()&&this.zone.equals(n.zone)&&this.loc.equals(n.loc)}toRelative(n={}){if(!this.isValid)return null;const i=n.base||D.fromObject({},{zone:this.zone}),u=n.padding?this<i?-n.padding:n.padding:0;let h=["years","months","days","hours","minutes","seconds"],f=n.unit;return Array.isArray(n.unit)&&(h=n.unit,f=void 0),Vi(i,this.plus(u),{...n,numeric:"always",units:h,unit:f})}toRelativeCalendar(n={}){return this.isValid?Vi(n.base||D.fromObject({},{zone:this.zone}),this,{...n,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...n){if(!n.every(D.isDateTime))throw new l("min requires all arguments be DateTimes");return ei(n,i=>i.valueOf(),Math.min)}static max(...n){if(!n.every(D.isDateTime))throw new l("max requires all arguments be DateTimes");return ei(n,i=>i.valueOf(),Math.max)}static fromFormatExplain(n,i,u={}){const{locale:h=null,numberingSystem:f=null}=u,m=W.fromOpts({locale:h,numberingSystem:f,defaultToEN:!0});return Di(m,n,i)}static fromStringExplain(n,i,u={}){return D.fromFormatExplain(n,i,u)}static buildFormatParser(n,i={}){const{locale:u=null,numberingSystem:h=null}=i,f=W.fromOpts({locale:u,numberingSystem:h,defaultToEN:!0});return new Oi(f,n)}static fromFormatParser(n,i,u={}){if(O(n)||O(i))throw new l("fromFormatParser requires an input string and a format parser");const{locale:h=null,numberingSystem:f=null}=u,m=W.fromOpts({locale:h,numberingSystem:f,defaultToEN:!0});if(!m.equals(i.locale))throw new l(`fromFormatParser called with a locale of ${m}, but the format parser was created for ${i.locale}`);const{result:y,zone:b,specificOffset:S,invalidReason:M}=i.explainFromTokens(n);return M?D.invalid(M):dt(y,b,u,`format ${i.format}`,n,S)}static get DATE_SHORT(){return C}static get DATE_MED(){return _}static get DATE_MED_WITH_WEEKDAY(){return N}static get DATE_FULL(){return E}static get DATE_HUGE(){return k}static get TIME_SIMPLE(){return L}static get TIME_WITH_SECONDS(){return x}static get TIME_WITH_SHORT_OFFSET(){return J}static get TIME_WITH_LONG_OFFSET(){return ee}static get TIME_24_SIMPLE(){return F}static get TIME_24_WITH_SECONDS(){return T}static get TIME_24_WITH_SHORT_OFFSET(){return $}static get TIME_24_WITH_LONG_OFFSET(){return R}static get DATETIME_SHORT(){return j}static get DATETIME_SHORT_WITH_SECONDS(){return Y}static get DATETIME_MED(){return P}static get DATETIME_MED_WITH_SECONDS(){return q}static get DATETIME_MED_WITH_WEEKDAY(){return Z}static get DATETIME_FULL(){return se}static get DATETIME_FULL_WITH_SECONDS(){return Ee}static get DATETIME_HUGE(){return Ae}static get DATETIME_HUGE_WITH_SECONDS(){return Os}}function At(o){if(D.isDateTime(o))return o;if(o&&o.valueOf&&Fe(o.valueOf()))return D.fromJSDate(o);if(o&&typeof o=="object")return D.fromObject(o);throw new l(`Unknown datetime argument: ${o}, of type ${typeof o}`)}const _h="3.6.1";return ae.DateTime=D,ae.Duration=B,ae.FixedOffsetZone=te,ae.IANAZone=be,ae.Info=Mt,ae.Interval=z,ae.InvalidZone=Fs,ae.Settings=H,ae.SystemZone=Ct,ae.VERSION=_h,ae.Zone=nt,ae}var bn={},rs;function zo(){return rs||(rs=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.RE_RANGE=s.RE_WILDCARDS=s.PRESETS=s.TIME_UNITS_LEN=s.TIME_UNITS=s.TIME_UNITS_MAP=s.ALIASES=s.PARSE_DEFAULTS=s.CONSTRAINTS=void 0,s.CONSTRAINTS=Object.freeze({second:[0,59],minute:[0,59],hour:[0,23],dayOfMonth:[1,31],month:[1,12],dayOfWeek:[0,7]}),s.PARSE_DEFAULTS=Object.freeze({second:"0",minute:"*",hour:"*",dayOfMonth:"*",month:"*",dayOfWeek:"*"}),s.ALIASES=Object.freeze({jan:1,feb:2,mar:3,apr:4,may:5,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12,sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6}),s.TIME_UNITS_MAP=Object.freeze({SECOND:"second",MINUTE:"minute",HOUR:"hour",DAY_OF_MONTH:"dayOfMonth",MONTH:"month",DAY_OF_WEEK:"dayOfWeek"}),s.TIME_UNITS=Object.freeze(Object.values(s.TIME_UNITS_MAP)),s.TIME_UNITS_LEN=s.TIME_UNITS.length,s.PRESETS=Object.freeze({"@yearly":"0 0 0 1 1 *","@monthly":"0 0 0 1 * *","@weekly":"0 0 0 * * 0","@daily":"0 0 0 * * *","@hourly":"0 0 * * * *","@minutely":"0 * * * * *","@secondly":"* * * * * *","@weekdays":"0 0 0 * * 1-5","@weekends":"0 0 0 * * 0,6"}),s.RE_WILDCARDS=/\*/g,s.RE_RANGE=/^(\d+)(?:-(\d+))?(?:\/(\d+))?$/g}(bn)),bn}var We={},ss;function is(){if(ss)return We;ss=1,Object.defineProperty(We,"__esModule",{value:!0}),We.ExclusiveParametersError=We.CronError=void 0;class s extends Error{}We.CronError=s;class e extends s{constructor(r,a){super(`You can't specify both ${r} and ${a}`)}}return We.ExclusiveParametersError=e,We}var as;function vn(){if(as)return wt;as=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.CronTime=void 0;const s=Ho(),e=zo(),t=is();class r{constructor(c,l,p){if(this.realDate=!1,this.second={},this.minute={},this.hour={},this.dayOfMonth={},this.month={},this.dayOfWeek={},l!=null&&p!=null)throw new t.ExclusiveParametersError("timeZone","utcOffset");if(l){if(!s.DateTime.fromObject({},{zone:l}).isValid)throw new t.CronError("Invalid timezone.");this.timeZone=l}if(p!=null&&(this.utcOffset=p),l==null&&p==null){const d=Intl.DateTimeFormat().resolvedOptions().timeZone;this.timeZone=d}c instanceof Date||c instanceof s.DateTime?(this.source=c instanceof Date?s.DateTime.fromJSDate(c):c,this.realDate=!0):(this.source=c,this._parse(this.source))}static validateCronExpression(c){try{return new r(c),{valid:!0}}catch(l){return{valid:!1,error:l}}}_getWeekDay(c){return c.weekday===7?0:c.weekday}sendAt(c){let l=this.realDate&&this.source instanceof s.DateTime?this.source:s.DateTime.utc();if(this.timeZone&&(l=l.setZone(this.timeZone)),this.utcOffset!==void 0){const p=this.utcOffset<0?"-":"+",d=Math.trunc(this.utcOffset/60),g=String(Math.abs(d)).padStart(2,"0"),v=Math.abs(this.utcOffset-d*60),C=String(v).padStart(2,"0"),_=`UTC${p}${g}:${C}`;if(l=l.setZone(_),!l.isValid)throw new t.CronError("ERROR: You specified an invalid UTC offset.")}if(this.realDate){if(s.DateTime.local()>l)throw new t.CronError("WARNING: Date in past. Will never be fired.");return l}if(c===void 0||isNaN(c)||c<0)return this.getNextDateFrom(l);{const p=[];for(;c>0;c--)l=this.getNextDateFrom(l),p.push(l);return p}}getTimeout(){return this.sendAt().toMillis()-s.DateTime.local().toMillis()}toString(){return this.toJSON().join(" ")}toJSON(){return e.TIME_UNITS.map(c=>this._wcOrAll(c))}getNextDateFrom(c,l){var p,d;c instanceof Date&&(c=s.DateTime.fromJSDate(c)),l?c=c.setZone(l):l=(p=c.zone.zoneName)!==null&&p!==void 0?p:c.zone.fixed;let g=s.DateTime.fromFormat(`${c.year}-${c.month}-${c.day} ${c.hour}:${c.minute}:${c.second}`,"yyyy-M-d H:m:s",{zone:"UTC"});const v=g.toMillis();if(this.realDate||g.millisecond>0&&(g=g.set({millisecond:0,second:g.second+1})),!g.isValid)throw new t.CronError("ERROR: You specified an invalid date.");const C=s.DateTime.now().plus({years:8});for(;;){if(g>C)throw new t.CronError(`Something went wrong. No execution date was found in the next 8 years.
							Please provide the following string if you would like to help debug:
							Time Zone: ${(d=l==null?void 0:l.toString())!==null&&d!==void 0?d:'""'} - Cron String: ${this.source.toString()} - UTC offset: ${g.offset} - current Date: ${s.DateTime.local().toString()}`);if(!(g.month in this.month)&&Object.keys(this.month).length!==12){g=g.plus({month:1}),g=g.set({day:1,hour:0,minute:0,second:0});continue}if(!(g.day in this.dayOfMonth)&&Object.keys(this.dayOfMonth).length!==31&&!(this._getWeekDay(g)in this.dayOfWeek&&Object.keys(this.dayOfWeek).length!==7)||!(this._getWeekDay(g)in this.dayOfWeek)&&Object.keys(this.dayOfWeek).length!==7&&!(g.day in this.dayOfMonth&&Object.keys(this.dayOfMonth).length!==31)){g=g.plus({days:1}),g=g.set({hour:0,minute:0,second:0});continue}if(!(g.hour in this.hour)&&Object.keys(this.hour).length!==24){g=g.plus({hour:1}),g=g.set({minute:0,second:0});continue}if(!(g.minute in this.minute)&&Object.keys(this.minute).length!==60){g=g.plus({minute:1}),g=g.set({second:0});continue}if(g.toMillis()===v||!(g.second in this.second)&&Object.keys(this.second).length!==60){g=g.plus({second:1});continue}break}const _=g.hour,N=g.minute;g=s.DateTime.fromFormat(`${g.year}-${g.month}-${g.day} ${g.hour}:${g.minute}:${g.second}`,"yyyy-M-d H:m:s",{zone:l});const E=s.DateTime.fromFormat(`${g.year}-1-1 0:0:0`,"yyyy-M-d H:m:s",{zone:l});if((_!==g.hour||N!==g.minute)&&E.offset!==g.offset){for(;g.minus({minute:1}).offset!==E.offset;)g=g.minus({minute:1});return g}const k=g.minus({hour:1}),L=g.minus({hour:2});(k.hour===g.hour||L.hour===k.hour)&&k>c&&(g=k);const x=g.minus({minute:30});return(x.minute===g.minute||k.minute===x.minute)&&x>c&&(g=x),g}_wcOrAll(c){if(this._hasAll(c))return"*";const l=[];for(const p in this[c])l.push(p);return l.join(",")}_hasAll(c){const l=e.CONSTRAINTS[c],p=l[0],d=c===e.TIME_UNITS_MAP.DAY_OF_WEEK?l[1]-1:l[1];for(let g=p,v=d;g<v;g++)if(!(g in this[c]))return!1;return!0}_parse(c){var l;c=c.toLowerCase(),Object.keys(e.PRESETS).includes(c)&&(c=e.PRESETS[c]),c=c.replace(/[a-z]{1,3}/gi,g=>{if(Object.keys(e.ALIASES).includes(g))return e.ALIASES[g].toString();throw new t.CronError(`Unknown alias: ${g}`)});const p=c.trim().split(/\s+/);if(p.length<e.TIME_UNITS_LEN-1)throw new t.CronError("Too few fields");if(p.length>e.TIME_UNITS_LEN)throw new t.CronError("Too many fields");const d=p.length;for(const g of e.TIME_UNITS){const v=e.TIME_UNITS.indexOf(g),C=(l=p[v-(e.TIME_UNITS_LEN-d)])!==null&&l!==void 0?l:e.PARSE_DEFAULTS[g];this._parseField(C,g)}}_parseField(c,l){const p=this[l];let d;const g=e.CONSTRAINTS[l],v=g[0],C=g[1];c.split(",").forEach(E=>{const k=E.indexOf("*");if(k!==-1&&k!==0)throw new t.CronError(`Field (${E}) has an invalid wildcard expression`)}),c=c.replace(e.RE_WILDCARDS,`${v}-${C}`);const N=c.split(",");for(const E of N){const k=[...E.matchAll(e.RE_RANGE)][0];if((k==null?void 0:k[1])!==void 0){const[,L,x,J]=k;let ee=parseInt(L,10),F=x!==void 0?parseInt(x,10):void 0;const T=J!==void 0,$=parseInt(J??"1",10);if($===0)throw new t.CronError(`Field (${l}) has a step of zero`);if(F!==void 0&&ee>F)throw new t.CronError(`Field (${l}) has an invalid range`);if(ee<v||F!==void 0&&F>C||F===void 0&&ee>C)throw new t.CronError(`Field value (${c}) is out of range`);ee=Math.min(Math.max(v,~~Math.abs(ee)),C),F!==void 0?F=Math.min(C,~~Math.abs(F)):F=T?C:ee,d=ee;do p[d]=!0,d+=$;while(d<=F);l==="dayOfWeek"&&(!p[0]&&p[7]&&(p[0]=p[7]),delete p[7])}else throw new t.CronError(`Field (${l}) cannot be parsed`)}}}return wt.CronTime=r,wt}var je={},os;function Yo(){if(os)return je;os=1;var s=je&&je.__awaiter||function(c,l,p,d){function g(v){return v instanceof p?v:new p(function(C){C(v)})}return new(p||(p=Promise))(function(v,C){function _(k){try{E(d.next(k))}catch(L){C(L)}}function N(k){try{E(d.throw(k))}catch(L){C(L)}}function E(k){k.done?v(k.value):g(k.value).then(_,N)}E((d=d.apply(c,l||[])).next())})};Object.defineProperty(je,"__esModule",{value:!0}),je.CronJob=void 0;const e=yt,t=is(),r=vn();class a{get isActive(){return this._isActive}get isCallbackRunning(){return this._isCallbackRunning}constructor(l,p,d,g,v,C,_,N,E,k,L,x,J){if(this.unrefTimeout=!1,this.lastExecution=null,this.runOnce=!1,this.waitForCompletion=!1,this.threshold=250,this._isActive=!1,this._isCallbackRunning=!1,this._callbacks=[],this.context=C??this,this.waitForCompletion=!!k,this.errorHandler=L,v!=null&&N!=null)throw new t.ExclusiveParametersError("timeZone","utcOffset");v!=null?this.cronTime=new r.CronTime(l,v,null):N!=null?this.cronTime=new r.CronTime(l,null,N):this.cronTime=new r.CronTime(l,v,N),E!=null&&(this.unrefTimeout=E),d!=null&&(this.onComplete=this._fnWrap(d)),J!=null&&(this.threshold=Math.abs(J)),x!=null&&(this.name=x),this.cronTime.realDate&&(this.runOnce=!0),this.addCallback(this._fnWrap(p)),_&&(this.lastExecution=new Date,this.fireOnTick()),g&&this.start()}static from(l){if(l.timeZone!=null&&l.utcOffset!=null)throw new t.ExclusiveParametersError("timeZone","utcOffset");return l.timeZone!=null?new a(l.cronTime,l.onTick,l.onComplete,l.start,l.timeZone,l.context,l.runOnInit,l.utcOffset,l.unrefTimeout,l.waitForCompletion,l.errorHandler,l.name,l.threshold):l.utcOffset!=null?new a(l.cronTime,l.onTick,l.onComplete,l.start,null,l.context,l.runOnInit,l.utcOffset,l.unrefTimeout,l.waitForCompletion,l.errorHandler,l.name,l.threshold):new a(l.cronTime,l.onTick,l.onComplete,l.start,l.timeZone,l.context,l.runOnInit,l.utcOffset,l.unrefTimeout,l.waitForCompletion,l.errorHandler,l.name,l.threshold)}_fnWrap(l){var p,d;switch(typeof l){case"function":return l;case"string":{const[g,...v]=l.split(" ");return e.spawn.bind(void 0,g??l,v,{})}case"object":return e.spawn.bind(void 0,l.command,(p=l.args)!==null&&p!==void 0?p:[],(d=l.options)!==null&&d!==void 0?d:{})}}addCallback(l){typeof l=="function"&&this._callbacks.push(l)}setTime(l){if(!(l instanceof r.CronTime))throw new t.CronError("time must be an instance of CronTime.");const p=this._isActive;this.stop(),this.cronTime=l,l.realDate&&(this.runOnce=!0),p&&this.start()}nextDate(){return this.cronTime.sendAt()}fireOnTick(){return s(this,void 0,void 0,function*(){if(!(this.waitForCompletion&&this._isCallbackRunning)){this._isCallbackRunning=!0;try{for(const l of this._callbacks){const p=l.call(this.context,this.onComplete);this.waitForCompletion&&(yield p)}}catch(l){this.errorHandler!=null?this.errorHandler(l):console.error("[Cron] error in callback",l)}finally{this._isCallbackRunning=!1}}})}nextDates(l){return this.cronTime.sendAt(l??0)}start(){if(this._isActive)return;this._isActive=!0;const l=2147483647;let p=this.cronTime.getTimeout(),d=0,g;const v=_=>{g=Date.now(),this._timeout=setTimeout(C,_),this.unrefTimeout&&typeof this._timeout.unref=="function"&&this._timeout.unref()},C=()=>{const _=g+p-Date.now();if(_>0){let N=this.cronTime.getTimeout();N>_&&(N=_),d+=N}d?(d>l?(d-=l,p=l):(p=d,d=0),v(p)):(this.lastExecution=new Date,this._isActive=!1,this.runOnce||this.start(),this.fireOnTick())};if(p>=0)p>l&&(d=p-l,p=l),v(p);else{const _=Math.abs(p),N=`[Cron] Missed execution deadline by ${_}ms for job${this.name?` "${this.name}"`:""} with cron expression '${String(this.cronTime.source)}'`;_<=this.threshold?(console.warn(`${N}. Executing immediately.`),this.lastExecution=new Date,this.fireOnTick()):console.warn(`${N}. Skipping execution as it exceeds threshold (${this.threshold}ms).`),p=this.cronTime.getTimeout(),v(p)}}lastDate(){return this.lastExecution}_executeOnComplete(){return s(this,void 0,void 0,function*(){if(typeof this.onComplete=="function")try{yield this.onComplete.call(this.context)}catch(l){console.error("[Cron] error in onComplete callback:",l)}})}_waitForJobCompletion(){return s(this,void 0,void 0,function*(){for(;this._isCallbackRunning;)yield new Promise(l=>setTimeout(l,100))})}stop(){if(this._timeout&&clearTimeout(this._timeout),this._isActive=!1,!this.waitForCompletion){this._executeOnComplete();return}return Promise.resolve().then(()=>s(this,void 0,void 0,function*(){yield this._waitForJobCompletion(),yield this._executeOnComplete()}))}}return je.CronJob=a,je}var us;function Zo(){return us||(us=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.validateCronExpression=s.timeout=s.sendAt=s.CronTime=s.CronJob=void 0;const e=vn();var t=Yo();Object.defineProperty(s,"CronJob",{enumerable:!0,get:function(){return t.CronJob}});var r=vn();Object.defineProperty(s,"CronTime",{enumerable:!0,get:function(){return r.CronTime}});const a=l=>new e.CronTime(l).sendAt();s.sendAt=a;const c=l=>new e.CronTime(l).getTimeout();s.timeout=c,s.validateCronExpression=e.CronTime.validateCronExpression}(wn)),wn}var Ko=Zo();const cs={},Te=new Ie;Te.use(yo({initial:()=>({isActive:!1})})),Te.command("start",async s=>{await s.reply(`Welcome to Daily Pin Bot!

Commands:
/setup [link] [optional message] - Setup daily pin with a link and optional message
/activate - Activate daily pins
/deactivate - Deactivate daily pins
/status - Check current setup status
/help - Show available commands`)}),Te.command("help",async s=>{await s.reply(`Available commands:
/setup [link] [optional message] - Setup daily pin with a link and optional message
/activate - Activate daily pins
/deactivate - Deactivate daily pins
/status - Check current setup status`)}),Te.command("setup",async s=>{var a;const e=(a=s.message)==null?void 0:a.text.split(" ");if(!e||e.length<2){await s.reply("Please provide a link to pin");return}const t=e[1],r=e.slice(2).join(" ")||"Daily reminder";s.session.chatId=s.chat.id.toString(),s.session.linkToPin=t,s.session.messageText=r,await s.reply(`Daily pin has been set up with link: ${t}
Message: ${r}`)}),Te.command("activate",async s=>{if(!s.session.chatId||!s.session.linkToPin){await s.reply("Please set up the bot first using /setup [link] [optional message]");return}s.session.isActive=!0,await s.reply("Daily pins activated! The bot will pin a message every weekday at 8:30 AM.")}),Te.command("deactivate",async s=>{s.session.isActive=!1,await s.reply("Daily pins deactivated.")}),Te.command("status",async s=>{const e=s.session.isActive?"Active":"Inactive",t=s.session.linkToPin||"Not set",r=s.session.messageText||"Not set",a=s.session.chatId||"Not set";await s.reply(`Status: ${e}
Link: ${t}
Message: ${r}
Chat ID: ${a}`)}),Te.on("message",s=>{s.session.isActive&&s.session.chatId&&s.session.linkToPin&&(cs[s.session.chatId]={isActive:s.session.isActive,linkToPin:s.session.linkToPin,messageText:s.session.messageText,chatId:s.session.chatId})});async function Qo(s,e,t,r){try{const a=`${r}
${t}`,c=await s.api.sendMessage(e,a);await s.api.pinChatMessage(e,c.message_id),console.log(`Sent and pinned daily message in chat ${e}`)}catch(a){console.error(`Error sending/pinning message in chat ${e}:`,a)}}function Jo(s){const e=new Ko.CronJob("0 30 8 * * 1-5",()=>{console.log("Running daily pin job at 8:30 AM"),Object.values(cs).forEach(t=>{t.isActive&&t.chatId&&t.linkToPin&&Qo(s,t.chatId,t.linkToPin,t.messageText||"Daily reminder")})},null,!0,"UTC");return e.start(),console.log("Daily pin job scheduled for 8:30 AM Monday-Friday"),e}const Xo=()=>{};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ls=function(s){const e=[];let t=0;for(let r=0;r<s.length;r++){let a=s.charCodeAt(r);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&r+1<s.length&&(s.charCodeAt(r+1)&64512)===56320?(a=65536+((a&1023)<<10)+(s.charCodeAt(++r)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},eu=function(s){const e=[];let t=0,r=0;for(;t<s.length;){const a=s[t++];if(a<128)e[r++]=String.fromCharCode(a);else if(a>191&&a<224){const c=s[t++];e[r++]=String.fromCharCode((a&31)<<6|c&63)}else if(a>239&&a<365){const c=s[t++],l=s[t++],p=s[t++],d=((a&7)<<18|(c&63)<<12|(l&63)<<6|p&63)-65536;e[r++]=String.fromCharCode(55296+(d>>10)),e[r++]=String.fromCharCode(56320+(d&1023))}else{const c=s[t++],l=s[t++];e[r++]=String.fromCharCode((a&15)<<12|(c&63)<<6|l&63)}}return e.join("")},hs={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<s.length;a+=3){const c=s[a],l=a+1<s.length,p=l?s[a+1]:0,d=a+2<s.length,g=d?s[a+2]:0,v=c>>2,C=(c&3)<<4|p>>4;let _=(p&15)<<2|g>>6,N=g&63;d||(N=64,l||(_=64)),r.push(t[v],t[C],t[_],t[N])}return r.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(ls(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):eu(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<s.length;){const c=t[s.charAt(a++)],p=a<s.length?t[s.charAt(a)]:0;++a;const g=a<s.length?t[s.charAt(a)]:64;++a;const C=a<s.length?t[s.charAt(a)]:64;if(++a,c==null||p==null||g==null||C==null)throw new tu;const _=c<<2|p>>4;if(r.push(_),g!==64){const N=p<<4&240|g>>2;if(r.push(N),C!==64){const E=g<<6&192|C;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class tu extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const nu=function(s){const e=ls(s);return hs.encodeByteArray(e,!0)},ds=function(s){return nu(s).replace(/\./g,"")},ru=function(s){try{return hs.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function su(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iu=()=>su().__FIREBASE_DEFAULTS__,au=()=>{if(typeof process>"u"||typeof process.env>"u")return;const s=process.env.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},ou=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&ru(s[1]);return e&&JSON.parse(e)},uu=()=>{try{return Xo()||iu()||au()||ou()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},cu=()=>{var s;return(s=uu())===null||s===void 0?void 0:s.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function hu(){try{return typeof indexedDB=="object"}catch{return!1}}function du(){return new Promise((s,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(r),s(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var c;e(((c=a.error)===null||c===void 0?void 0:c.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fu="FirebaseError";class bt extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=fu,Object.setPrototypeOf(this,bt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,fs.prototype.create)}}class fs{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},a=`${this.service}/${e}`,c=this.errors[e],l=c?mu(c,r):"Error",p=`${this.serviceName}: ${l} (${a}).`;return new bt(a,p,r)}}function mu(s,e){return s.replace(pu,(t,r)=>{const a=e[r];return a!=null?String(a):`<${r}?>`})}const pu=/\{\$([^}]+)}/g;function Cn(s,e){if(s===e)return!0;const t=Object.keys(s),r=Object.keys(e);for(const a of t){if(!r.includes(a))return!1;const c=s[a],l=e[a];if(ms(c)&&ms(l)){if(!Cn(c,l))return!1}else if(c!==l)return!1}for(const a of r)if(!t.includes(a))return!1;return!0}function ms(s){return s!==null&&typeof s=="object"}class Wt{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qe="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new lu;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&r.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(c){if(a)return null;throw c}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(wu(e))try{this.getOrInitializeService({instanceIdentifier:qe})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const c=this.getOrInitializeService({instanceIdentifier:a});r.resolve(c)}catch{}}}}clearInstance(e=qe){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=qe){return this.instances.has(e)}getOptions(e=qe){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[c,l]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(c);r===p&&l.resolve(a)}return a}onInit(e,t){var r;const a=this.normalizeInstanceIdentifier(t),c=(r=this.onInitCallbacks.get(a))!==null&&r!==void 0?r:new Set;c.add(e),this.onInitCallbacks.set(a,c);const l=this.instances.get(a);return l&&e(l,a),()=>{c.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const a of r)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:yu(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=qe){return this.component?this.component.multipleInstances?e:qe:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function yu(s){return s===qe?void 0:s}function wu(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new gu(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var G;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(G||(G={}));const vu={debug:G.DEBUG,verbose:G.VERBOSE,info:G.INFO,warn:G.WARN,error:G.ERROR,silent:G.SILENT},Cu=G.INFO,Su={[G.DEBUG]:"log",[G.VERBOSE]:"log",[G.INFO]:"info",[G.WARN]:"warn",[G.ERROR]:"error"},Tu=(s,e,...t)=>{if(e<s.logLevel)return;const r=new Date().toISOString(),a=Su[e];if(a)console[a](`[${r}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class _u{constructor(e){this.name=e,this._logLevel=Cu,this._logHandler=Tu,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in G))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?vu[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,G.DEBUG,...e),this._logHandler(this,G.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,G.VERBOSE,...e),this._logHandler(this,G.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,G.INFO,...e),this._logHandler(this,G.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,G.WARN,...e),this._logHandler(this,G.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,G.ERROR,...e),this._logHandler(this,G.ERROR,...e)}}const Eu=(s,e)=>e.some(t=>s instanceof t);let ps,gs;function Iu(){return ps||(ps=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ku(){return gs||(gs=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ys=new WeakMap,Sn=new WeakMap,ws=new WeakMap,Tn=new WeakMap,_n=new WeakMap;function Mu(s){const e=new Promise((t,r)=>{const a=()=>{s.removeEventListener("success",c),s.removeEventListener("error",l)},c=()=>{t(Oe(s.result)),a()},l=()=>{r(s.error),a()};s.addEventListener("success",c),s.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&ys.set(t,s)}).catch(()=>{}),_n.set(e,s),e}function Ou(s){if(Sn.has(s))return;const e=new Promise((t,r)=>{const a=()=>{s.removeEventListener("complete",c),s.removeEventListener("error",l),s.removeEventListener("abort",l)},c=()=>{t(),a()},l=()=>{r(s.error||new DOMException("AbortError","AbortError")),a()};s.addEventListener("complete",c),s.addEventListener("error",l),s.addEventListener("abort",l)});Sn.set(s,e)}let En={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return Sn.get(s);if(e==="objectStoreNames")return s.objectStoreNames||ws.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Oe(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function Du(s){En=s(En)}function Au(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=s.call(In(this),e,...t);return ws.set(r,e.sort?e.sort():[e]),Oe(r)}:ku().includes(s)?function(...e){return s.apply(In(this),e),Oe(ys.get(this))}:function(...e){return Oe(s.apply(In(this),e))}}function Nu(s){return typeof s=="function"?Au(s):(s instanceof IDBTransaction&&Ou(s),Eu(s,Iu())?new Proxy(s,En):s)}function Oe(s){if(s instanceof IDBRequest)return Mu(s);if(Tn.has(s))return Tn.get(s);const e=Nu(s);return e!==s&&(Tn.set(s,e),_n.set(e,s)),e}const In=s=>_n.get(s);function Fu(s,e,{blocked:t,upgrade:r,blocking:a,terminated:c}={}){const l=indexedDB.open(s,e),p=Oe(l);return r&&l.addEventListener("upgradeneeded",d=>{r(Oe(l.result),d.oldVersion,d.newVersion,Oe(l.transaction),d)}),t&&l.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),p.then(d=>{c&&d.addEventListener("close",()=>c()),a&&d.addEventListener("versionchange",g=>a(g.oldVersion,g.newVersion,g))}).catch(()=>{}),p}const Ru=["get","getKey","getAll","getAllKeys","count"],$u=["put","add","delete","clear"],kn=new Map;function bs(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(kn.get(e))return kn.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,a=$u.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(a||Ru.includes(t)))return;const c=async function(l,...p){const d=this.transaction(l,a?"readwrite":"readonly");let g=d.store;return r&&(g=g.index(p.shift())),(await Promise.all([g[t](...p),a&&d.done]))[0]};return kn.set(e,c),c}Du(s=>({...s,get:(e,t,r)=>bs(e,t)||s.get(e,t,r),has:(e,t)=>!!bs(e,t)||s.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Lu(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function Lu(s){const e=s.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Mn="@firebase/app",vs="0.11.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _e=new _u("@firebase/app"),Pu="@firebase/app-compat",Vu="@firebase/analytics-compat",Bu="@firebase/analytics",Uu="@firebase/app-check-compat",Wu="@firebase/app-check",ju="@firebase/auth",qu="@firebase/auth-compat",Gu="@firebase/database",Hu="@firebase/data-connect",zu="@firebase/database-compat",Yu="@firebase/functions",Zu="@firebase/functions-compat",Ku="@firebase/installations",Qu="@firebase/installations-compat",Ju="@firebase/messaging",Xu="@firebase/messaging-compat",ec="@firebase/performance",tc="@firebase/performance-compat",nc="@firebase/remote-config",rc="@firebase/remote-config-compat",sc="@firebase/storage",ic="@firebase/storage-compat",ac="@firebase/firestore",oc="@firebase/vertexai",uc="@firebase/firestore-compat",cc="firebase";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lc="[DEFAULT]",hc={[Mn]:"fire-core",[Pu]:"fire-core-compat",[Bu]:"fire-analytics",[Vu]:"fire-analytics-compat",[Wu]:"fire-app-check",[Uu]:"fire-app-check-compat",[ju]:"fire-auth",[qu]:"fire-auth-compat",[Gu]:"fire-rtdb",[Hu]:"fire-data-connect",[zu]:"fire-rtdb-compat",[Yu]:"fire-fn",[Zu]:"fire-fn-compat",[Ku]:"fire-iid",[Qu]:"fire-iid-compat",[Ju]:"fire-fcm",[Xu]:"fire-fcm-compat",[ec]:"fire-perf",[tc]:"fire-perf-compat",[nc]:"fire-rc",[rc]:"fire-rc-compat",[sc]:"fire-gcs",[ic]:"fire-gcs-compat",[ac]:"fire-fst",[uc]:"fire-fst-compat",[oc]:"fire-vertex","fire-js":"fire-js",[cc]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const On=new Map,dc=new Map,Dn=new Map;function Cs(s,e){try{s.container.addComponent(e)}catch(t){_e.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function An(s){const e=s.name;if(Dn.has(e))return _e.debug(`There were multiple attempts to register component ${e}.`),!1;Dn.set(e,s);for(const t of On.values())Cs(t,s);for(const t of dc.values())Cs(t,s);return!0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fc={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ge=new fs("app","Firebase",fc);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mc{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Wt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ge.create("app-deleted",{appName:this._name})}}function pc(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const r=Object.assign({name:lc,automaticDataCollectionEnabled:!1},e),a=r.name;if(typeof a!="string"||!a)throw Ge.create("bad-app-name",{appName:String(a)});if(t||(t=cu()),!t)throw Ge.create("no-options");const c=On.get(a);if(c){if(Cn(t,c.options)&&Cn(r,c.config))return c;throw Ge.create("duplicate-app",{appName:a})}const l=new bu(a);for(const d of Dn.values())l.addComponent(d);const p=new mc(t,r,l);return On.set(a,p),p}function jt(s,e,t){var r;let a=(r=hc[s])!==null&&r!==void 0?r:s;t&&(a+=`-${t}`);const c=a.match(/\s|\//),l=e.match(/\s|\//);if(c||l){const p=[`Unable to register library "${a}" with version "${e}":`];c&&p.push(`library name "${a}" contains illegal characters (whitespace or "/")`),c&&l&&p.push("and"),l&&p.push(`version name "${e}" contains illegal characters (whitespace or "/")`),_e.warn(p.join(" "));return}An(new Wt(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gc="firebase-heartbeat-database",yc=1,vt="firebase-heartbeat-store";let Nn=null;function Ss(){return Nn||(Nn=Fu(gc,yc,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(vt)}catch(t){console.warn(t)}}}}).catch(s=>{throw Ge.create("idb-open",{originalErrorMessage:s.message})})),Nn}async function wc(s){try{const t=(await Ss()).transaction(vt),r=await t.objectStore(vt).get(_s(s));return await t.done,r}catch(e){if(e instanceof bt)_e.warn(e.message);else{const t=Ge.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});_e.warn(t.message)}}}async function Ts(s,e){try{const r=(await Ss()).transaction(vt,"readwrite");await r.objectStore(vt).put(e,_s(s)),await r.done}catch(t){if(t instanceof bt)_e.warn(t.message);else{const r=Ge.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});_e.warn(r.message)}}}function _s(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bc=1024,vc=30;class Cc{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Tc(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),c=Es();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===c||this._heartbeatsCache.heartbeats.some(l=>l.date===c))return;if(this._heartbeatsCache.heartbeats.push({date:c,agent:a}),this._heartbeatsCache.heartbeats.length>vc){const l=_c(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){_e.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Es(),{heartbeatsToSend:r,unsentEntries:a}=Sc(this._heartbeatsCache.heartbeats),c=ds(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),c}catch(t){return _e.warn(t),""}}}function Es(){return new Date().toISOString().substring(0,10)}function Sc(s,e=bc){const t=[];let r=s.slice();for(const a of s){const c=t.find(l=>l.agent===a.agent);if(c){if(c.dates.push(a.date),Is(t)>e){c.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),Is(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class Tc{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return hu()?du().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await wc(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return Ts(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return Ts(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function Is(s){return ds(JSON.stringify({version:2,heartbeats:s})).length}function _c(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let r=1;r<s.length;r++)s[r].date<t&&(t=s[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ec(s){An(new Wt("platform-logger",e=>new xu(e),"PRIVATE")),An(new Wt("heartbeat",e=>new Cc(e),"PRIVATE")),jt(Mn,vs,s),jt(Mn,vs,"esm2017"),jt("fire-js","")}Ec("");var Ic="firebase",kc="11.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jt(Ic,kc,"app");const ks=process.env.BOT_TOKEN;if(!ks)throw new Error("BOT_TOKEN is required in .env file");const Mc=ks,De=new fo(Mc);De.use(Te);async function Ms(s){const e=s,t=await Go(e),r=await jo({chunks:t,query:e});return console.log("Completion:",r),r}async function Oc(){console.log("init ...");try{console.log("starting ..."),await De.start(),console.log("Bot started"),De.on("message:text",async s=>{s.reply(await Ms(s.message.text))}),De.hears(/chat *(.+)?/,async s=>{var e;console.log(s,"ctx"),console.log(s.message,"ctx.message"),(e=s.message)!=null&&e.text&&s.reply(await Ms(s.message.text))}),De.command("chat",async s=>{await s.reply("Hi! I can only read messages that explicitly reply to me!",{reply_markup:{force_reply:!0}})}),Jo(De)}catch(s){console.error("Failed to start the bot:",s)}}pc({apiKey:"AIzaSyAP4eL6JBVcnPHOeeB7aVX6gL1XqA_Oah4",authDomain:"telegram-bot-app-12291.firebaseapp.com",projectId:"telegram-bot-app-12291",storageBucket:"telegram-bot-app-12291.firebasestorage.app",messagingSenderId:"541703448699",appId:"1:541703448699:web:d1f5980cb5d9f4e5df5ade"}),(async()=>{await Oc()})(),process.once("SIGINT",()=>De.stop()),process.once("SIGTERM",()=>De.stop())});
